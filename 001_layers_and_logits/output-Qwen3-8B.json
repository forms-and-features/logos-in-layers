{
  "diagnostics": {
    "type": "diagnostics",
    "model": "Qwen/Qwen3-8B",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "The capital of Germany is ",
    "target_prediction": "first unseen token (likely 'Berlin')"
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "The capital of Germany is ",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 3.6696870360565157,
    "topk": [
      [
        "．",
        0.3053707480430603
      ],
      [
        "�",
        0.14689289033412933
      ],
      [
        " A",
        0.1270042508840561
      ],
      [
        " __",
        0.09946665912866592
      ],
      [
        "1",
        0.06557375937700272
      ],
      [
        " _",
        0.04717959091067314
      ],
      [
        " ______",
        0.03649645671248436
      ],
      [
        "？",
        0.01699371077120304
      ],
      [
        " ____",
        0.014368503354489803
      ],
      [
        "？\n",
        0.012984922155737877
      ],
      [
        "2",
        0.011049521155655384
      ],
      [
        " ",
        0.01030060276389122
      ],
      [
        " Berlin",
        0.008707893081009388
      ],
      [
        " in",
        0.006487061269581318
      ],
      [
        " a",
        0.006144415587186813
      ],
      [
        "。\n",
        0.00521503621712327
      ],
      [
        "3",
        0.005007929168641567
      ],
      [
        " .\n",
        0.004603253677487373
      ],
      [
        "4",
        0.004357574973255396
      ],
      [
        " and",
        0.004084461368620396
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of ",
      "entropy": 3.829158293034357,
      "topk": [
        [
          " Germany",
          0.2584611177444458
        ],
        [
          " and",
          0.23165477812290192
        ],
        [
          " ______",
          0.11275017261505127
        ],
        [
          " __",
          0.10741288214921951
        ],
        [
          " A",
          0.0224179495126009
        ],
        [
          "1",
          0.021171556785702705
        ],
        [
          "．",
          0.019949663430452347
        ],
        [
          " which",
          0.019407853484153748
        ],
        [
          " with",
          0.019196202978491783
        ],
        [
          " ____",
          0.01846964657306671
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called ",
      "entropy": 4.566213332947441,
      "topk": [
        [
          " Berlin",
          0.14910520613193512
        ],
        [
          "1",
          0.1459423452615738
        ],
        [
          " _",
          0.11009122431278229
        ],
        [
          " ______",
          0.0921221375465393
        ],
        [
          " __",
          0.08989720046520233
        ],
        [
          " and",
          0.07588232308626175
        ],
        [
          " A",
          0.03613904491066933
        ],
        [
          "？",
          0.022702321410179138
        ],
        [
          " ____",
          0.02142474800348282
        ],
        [
          "�",
          0.019960008561611176
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named ",
      "entropy": 5.656085277660749,
      "topk": [
        [
          " Berlin",
          0.17877674102783203
        ],
        [
          " in",
          0.07910475134849548
        ],
        [
          " __",
          0.07718994468450546
        ],
        [
          "1",
          0.07337486743927002
        ],
        [
          " A",
          0.05752968415617943
        ],
        [
          " ______",
          0.03638462722301483
        ],
        [
          " what",
          0.03608812391757965
        ],
        [
          " and",
          0.027373872697353363
        ],
        [
          " _",
          0.024458905681967735
        ],
        [
          " by",
          0.024154825136065483
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at ",
      "entropy": 2.81546812731254,
      "topk": [
        [
          " Berlin",
          0.39892205595970154
        ],
        [
          "5",
          0.33998310565948486
        ],
        [
          "1",
          0.04985947906970978
        ],
        [
          " and",
          0.04294124245643616
        ],
        [
          "2",
          0.02334706112742424
        ],
        [
          "3",
          0.019349228590726852
        ],
        [
          "4",
          0.01714481972157955
        ],
        [
          " __",
          0.009760592132806778
        ],
        [
          "6",
          0.00831441581249237
        ],
        [
          " (",
          0.006748223211616278
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany, the capital city is ",
      "entropy": 3.72114871674359,
      "topk": [
        [
          " Berlin",
          0.29525959491729736
        ],
        [
          "1",
          0.20151399075984955
        ],
        [
          "2",
          0.10116828233003616
        ],
        [
          "3",
          0.05511734262108803
        ],
        [
          "4",
          0.04879997670650482
        ],
        [
          "5",
          0.04099990800023079
        ],
        [
          " and",
          0.03716573119163513
        ],
        [
          " in",
          0.026057202368974686
        ],
        [
          "6",
          0.025559643283486366
        ],
        [
          "7",
          0.0227214265614748
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 1.84963040128656e-08,
      "topk": [
        [
          " Berlin",
          1.0
        ],
        [
          " The",
          6.03667948961828e-10
        ],
        [
          " Germany",
          7.127381773967476e-14
        ],
        [
          " ",
          6.737883498754774e-14
        ],
        [
          " __",
          5.905652621660332e-14
        ],
        [
          " \n\n",
          5.032222532842645e-19
        ],
        [
          " ______",
          1.230886885991357e-19
        ],
        [
          " A",
          2.75563104168537e-20
        ],
        [
          " (",
          6.841814296808992e-24
        ],
        [
          " What",
          8.086294143792043e-25
        ],
        [
          " Ber",
          4.551183109100636e-25
        ],
        [
          " This",
          3.959087039911802e-25
        ],
        [
          " Bon",
          2.318671741622503e-25
        ],
        [
          " ?\n\n",
          1.655386768934746e-25
        ],
        [
          " __________________",
          7.236927360621547e-26
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 13.141294790295312,
      "topk": [
        [
          " Berlin",
          0.06631645560264587
        ],
        [
          " The",
          0.022943589836359024
        ],
        [
          " Germany",
          0.014597149565815926
        ],
        [
          " ",
          0.014556181617081165
        ],
        [
          " __",
          0.014460546895861626
        ],
        [
          " \n\n",
          0.008066948503255844
        ],
        [
          " ______",
          0.007518520578742027
        ],
        [
          " A",
          0.006976416800171137
        ],
        [
          " (",
          0.004606594331562519
        ],
        [
          " What",
          0.004140083212405443
        ],
        [
          " Ber",
          0.004022792913019657
        ],
        [
          " This",
          0.003994855564087629
        ],
        [
          " Bon",
          0.0038894079625606537
        ],
        [
          " ?\n\n",
          0.003824427491053939
        ],
        [
          " __________________",
          0.003669433994218707
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 36,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 151936,
    "n_ctx": 2048
  }
}