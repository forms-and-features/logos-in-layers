{
  "diagnostics": {
    "type": "diagnostics",
    "model": "google/gemma-2-9b",
    "device": "mps",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "prompt": "Question: What is the capital of Germany? Answer:"
  },
  "prompt": "Question: What is the capital of Germany? Answer:",
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.0026567934861994,
    "topk": [
      [
        " Berlin",
        0.7907322645187378
      ],
      [
        " The",
        0.020494094118475914
      ],
      [
        " It",
        0.01606738567352295
      ],
      [
        " Bonn",
        0.013444098643958569
      ],
      [
        " Germany",
        0.011032836511731148
      ],
      [
        " BERLIN",
        0.009926888160407543
      ],
      [
        "\n\n",
        0.009078445844352245
      ],
      [
        " I",
        0.0079884622246027
      ],
      [
        " ",
        0.007667262107133865
      ],
      [
        "Berlin",
        0.0062528145499527454
      ],
      [
        " What",
        0.006137290969491005
      ],
      [
        " This",
        0.004951244220137596
      ],
      [
        " “",
        0.004634049255400896
      ],
      [
        " Hamburg",
        0.0034916847944259644
      ],
      [
        " A",
        0.00330741866491735
      ],
      [
        "  ",
        0.003273209324106574
      ],
      [
        " Munich",
        0.0031118476763367653
      ],
      [
        " \"",
        0.0028519832994788885
      ],
      [
        " There",
        0.002709737978875637
      ],
      [
        " You",
        0.0026288237422704697
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Germany's capital is",
      "entropy": 5.326215330034545,
      "topk": [
        [
          " a",
          0.21215368807315826
        ],
        [
          " one",
          0.08889288455247879
        ],
        [
          " the",
          0.07558976858854294
        ],
        [
          " home",
          0.05834231898188591
        ],
        [
          " known",
          0.0448962077498436
        ],
        [
          " not",
          0.040992069989442825
        ],
        [
          " an",
          0.03146137669682503
        ],
        [
          " full",
          0.024787845090031624
        ],
        [
          " famous",
          0.022445226088166237
        ],
        [
          " set",
          0.01874789223074913
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.962052116826282,
      "topk": [
        [
          " Germany",
          0.8765730857849121
        ],
        [
          " the",
          0.06993433088064194
        ],
        [
          " modern",
          0.007701478432863951
        ],
        [
          " a",
          0.005294607952237129
        ],
        [
          " ",
          0.0033933348022401333
        ],
        [
          " Europe",
          0.0030800343956798315
        ],
        [
          " German",
          0.0028387275524437428
        ],
        [
          " both",
          0.0024276154581457376
        ],
        [
          " Berlin",
          0.0018703530076891184
        ],
        [
          " germany",
          0.0015240705106407404
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Respond in one word: which city is the capital of Germany?",
      "entropy": 5.318227423832571,
      "topk": [
        [
          "\n\n",
          0.15868327021598816
        ],
        [
          " If",
          0.11143848299980164
        ],
        [
          " Berlin",
          0.10463804751634598
        ],
        [
          " Of",
          0.0455685630440712
        ],
        [
          " The",
          0.04538233205676079
        ],
        [
          " You",
          0.03356722369790077
        ],
        [
          "\n",
          0.030117826536297798
        ],
        [
          " That",
          0.026873018592596054
        ],
        [
          " Yes",
          0.022589631378650665
        ],
        [
          " And",
          0.020589251071214676
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 8.028096427072684e-15,
      "topk": [
        [
          " Berlin",
          1.0
        ],
        [
          " The",
          1.3677029087914367e-16
        ],
        [
          " It",
          1.1999277180318782e-17
        ],
        [
          " Bonn",
          2.0184809608730697e-18
        ],
        [
          " Germany",
          2.7962416677291167e-19
        ],
        [
          " BERLIN",
          9.723753023570338e-20
        ],
        [
          "\n\n",
          3.979431510143076e-20
        ],
        [
          " I",
          1.1074790833903606e-20
        ],
        [
          " ",
          7.346956808384904e-21
        ],
        [
          "Berlin",
          9.560071267128427e-22
        ],
        [
          " What",
          7.933684438116702e-22
        ],
        [
          " This",
          9.265121475811574e-23
        ],
        [
          " “",
          4.778745814429741e-23
        ],
        [
          " Hamburg",
          2.818735501215147e-24
        ],
        [
          " A",
          1.6390688606355066e-24
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 11.010292159984422,
      "topk": [
        [
          " Berlin",
          0.08554711192846298
        ],
        [
          " The",
          0.013772252015769482
        ],
        [
          " It",
          0.012194478884339333
        ],
        [
          " Bonn",
          0.011154662817716599
        ],
        [
          " Germany",
          0.010104950517416
        ],
        [
          " BERLIN",
          0.009585111401975155
        ],
        [
          "\n\n",
          0.009166348725557327
        ],
        [
          " I",
          0.008598489686846733
        ],
        [
          " ",
          0.008423852734267712
        ],
        [
          "Berlin",
          0.007607261650264263
        ],
        [
          " What",
          0.0075366604141891
        ],
        [
          " This",
          0.006769362837076187
        ],
        [
          " “",
          0.00654893834143877
        ],
        [
          " Hamburg",
          0.005684707313776016
        ],
        [
          " A",
          0.005532674957066774
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 42,
    "d_model": 3584,
    "n_heads": 16,
    "d_vocab": 256000,
    "n_ctx": 8192
  }
}