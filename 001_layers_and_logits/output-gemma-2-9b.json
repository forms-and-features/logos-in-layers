{
  "diagnostics": {
    "type": "diagnostics",
    "model": "google/gemma-2-9b",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "The capital of Germany is ",
    "target_prediction": "first unseen token (likely 'Berlin')"
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "The capital of Germany is ",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.0110151503181317,
    "topk": [
      [
        "<strong>",
        0.6357174515724182
      ],
      [
        "<b>",
        0.14702193439006805
      ],
      [
        "1",
        0.058408722281455994
      ],
      [
        "<em>",
        0.03966343775391579
      ],
      [
        "2",
        0.02722751908004284
      ],
      [
        "3",
        0.02284558303654194
      ],
      [
        "4",
        0.01003066822886467
      ],
      [
        "<u>",
        0.009839378297328949
      ],
      [
        "5",
        0.009525272995233536
      ],
      [
        "<i>",
        0.008616584353148937
      ],
      [
        "8",
        0.008298144675791264
      ],
      [
        "7",
        0.006426622625440359
      ],
      [
        "9",
        0.005812340881675482
      ],
      [
        "6",
        0.005689894314855337
      ],
      [
        "0",
        0.0015133909182623029
      ],
      [
        "\n\n",
        0.0009553306153975427
      ],
      [
        "________________",
        0.0008264465141110122
      ],
      [
        "\n",
        0.00037083346978761256
      ],
      [
        "<code>",
        0.00029696710407733917
      ],
      [
        "<s>",
        0.00017204291361849755
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of ",
      "entropy": 1.579746467517678,
      "topk": [
        [
          "<strong>",
          0.7228115200996399
        ],
        [
          "<b>",
          0.10562816262245178
        ],
        [
          "<em>",
          0.07112549245357513
        ],
        [
          "1",
          0.04298127815127373
        ],
        [
          "2",
          0.014803530648350716
        ],
        [
          "<i>",
          0.011317165568470955
        ],
        [
          "<u>",
          0.009891399182379246
        ],
        [
          "ðŸ‡©",
          0.005490679759532213
        ],
        [
          "3",
          0.003993964288383722
        ],
        [
          "4",
          0.0018987699877470732
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called ",
      "entropy": 2.2502698469618334,
      "topk": [
        [
          "<strong>",
          0.47262394428253174
        ],
        [
          "<b>",
          0.22764283418655396
        ],
        [
          "<em>",
          0.138730987906456
        ],
        [
          "________________",
          0.05618114769458771
        ],
        [
          "<i>",
          0.04788346588611603
        ],
        [
          "<u>",
          0.022534489631652832
        ],
        [
          "\n\n",
          0.011043939739465714
        ],
        [
          "1",
          0.005559706594794989
        ],
        [
          "................",
          0.004020624328404665
        ],
        [
          "\n",
          0.0032946954015642405
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named ",
      "entropy": 1.684144752105627,
      "topk": [
        [
          "<strong>",
          0.5986613631248474
        ],
        [
          "<em>",
          0.19680963456630707
        ],
        [
          "<b>",
          0.13472160696983337
        ],
        [
          "<i>",
          0.05014495179057121
        ],
        [
          "<u>",
          0.007553821429610252
        ],
        [
          "1",
          0.003955834545195103
        ],
        [
          "2",
          0.0022047539241611958
        ],
        [
          "3",
          0.0011045105056837201
        ],
        [
          "\n\n",
          0.0006495386478491127
        ],
        [
          "4",
          0.0005577011615969241
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at ",
      "entropy": 2.287286704802941,
      "topk": [
        [
          "<strong>",
          0.5855780243873596
        ],
        [
          "<b>",
          0.16125787794589996
        ],
        [
          "<em>",
          0.07564134150743484
        ],
        [
          "1",
          0.03060193546116352
        ],
        [
          "5",
          0.029373906552791595
        ],
        [
          "<i>",
          0.02336105890572071
        ],
        [
          "<u>",
          0.018257886171340942
        ],
        [
          "\n\n",
          0.012677226215600967
        ],
        [
          "2",
          0.010009859688580036
        ],
        [
          "________________",
          0.009721115231513977
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany, the capital city is ",
      "entropy": 2.0290134786962266,
      "topk": [
        [
          "<strong>",
          0.58796226978302
        ],
        [
          "<b>",
          0.20683002471923828
        ],
        [
          "<em>",
          0.07988560944795609
        ],
        [
          "<i>",
          0.029008960351347923
        ],
        [
          "1",
          0.023237532004714012
        ],
        [
          "<u>",
          0.01574959233403206
        ],
        [
          "2",
          0.01239689625799656
        ],
        [
          "3",
          0.007408810313791037
        ],
        [
          "4",
          0.00491073913872242
        ],
        [
          "5",
          0.004829637240618467
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 8.029003769670295e-15,
      "topk": [
        [
          " Berlin",
          1.0
        ],
        [
          " The",
          1.3678700654496214e-16
        ],
        [
          " It",
          1.2000010062341504e-17
        ],
        [
          " Bonn",
          2.01860421078434e-18
        ],
        [
          " Germany",
          2.7967540027210167e-19
        ],
        [
          " BERLIN",
          9.725534693061595e-20
        ],
        [
          "\n\n",
          3.9798573789115704e-20
        ],
        [
          " I",
          1.1076143888128242e-20
        ],
        [
          " ",
          7.347294466095887e-21
        ],
        [
          "Berlin",
          9.561676756842733e-22
        ],
        [
          " What",
          7.934774959432079e-22
        ],
        [
          " This",
          9.266536376731178e-23
        ],
        [
          " â€œ",
          4.778746129974103e-23
        ],
        [
          " Hamburg",
          2.8186067196723696e-24
        ],
        [
          " A",
          1.6392191386379512e-24
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 11.011084656039598,
      "topk": [
        [
          " Berlin",
          0.08555381745100021
        ],
        [
          " The",
          0.013773412443697453
        ],
        [
          " It",
          0.012195458635687828
        ],
        [
          " Bonn",
          0.011155569925904274
        ],
        [
          " Germany",
          0.010105830617249012
        ],
        [
          " BERLIN",
          0.00958594586700201
        ],
        [
          "\n\n",
          0.009167111478745937
        ],
        [
          " I",
          0.008599214255809784
        ],
        [
          " ",
          0.008424529805779457
        ],
        [
          "Berlin",
          0.007607916835695505
        ],
        [
          " What",
          0.007537303026765585
        ],
        [
          " This",
          0.006769945845007896
        ],
        [
          " â€œ",
          0.006549452431499958
        ],
        [
          " Hamburg",
          0.005685137119144201
        ],
        [
          " A",
          0.005533130373805761
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 42,
    "d_model": 3584,
    "n_heads": 16,
    "d_vocab": 256000,
    "n_ctx": 8192
  }
}