{
  "diagnostics": {
    "type": "diagnostics",
    "model": "meta-llama/Meta-Llama-3-8B",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "The capital of Germany is ",
    "target_prediction": "first unseen token (likely 'Berlin')"
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "The capital of Germany is ",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 8.699963907549487,
    "topk": [
      [
        "1",
        0.07187354564666748
      ],
      [
        " ",
        0.027822578325867653
      ],
      [
        "100",
        0.024508653208613396
      ],
      [
        "2",
        0.023047080263495445
      ],
      [
        "3",
        0.01616370677947998
      ],
      [
        "10",
        0.013109820894896984
      ],
      [
        "8",
        0.011631295084953308
      ],
      [
        "4",
        0.011580260470509529
      ],
      [
        "7",
        0.01149793528020382
      ],
      [
        "700",
        0.011392975226044655
      ],
      [
        "800",
        0.011164466850459576
      ],
      [
        "5",
        0.01038051676005125
      ],
      [
        "600",
        0.010005520656704903
      ],
      [
        "6",
        0.009987235069274902
      ],
      [
        "12",
        0.008514239452779293
      ],
      [
        "500",
        0.00807989202439785
      ],
      [
        "9",
        0.007670269813388586
      ],
      [
        "20",
        0.006740529555827379
      ],
      [
        "15",
        0.00662112096324563
      ],
      [
        "400",
        0.006411391776055098
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of ",
      "entropy": 2.4441305828235507,
      "topk": [
        [
          " ",
          0.7382892370223999
        ],
        [
          "16",
          0.025987060740590096
        ],
        [
          "1",
          0.01705673150718212
        ],
        [
          "2",
          0.015502939000725746
        ],
        [
          "18",
          0.012422177940607071
        ],
        [
          " Germany",
          0.011515379883348942
        ],
        [
          "3",
          0.009261298924684525
        ],
        [
          "201",
          0.008875859901309013
        ],
        [
          "12",
          0.008798946626484394
        ],
        [
          "15",
          0.008739777840673923
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called ",
      "entropy": 4.442908995550143,
      "topk": [
        [
          " ",
          0.4778555631637573
        ],
        [
          " Berlin",
          0.0923270434141159
        ],
        [
          "1",
          0.08954030275344849
        ],
        [
          " B",
          0.016755416989326477
        ],
        [
          "2",
          0.01334876473993063
        ],
        [
          "3",
          0.011543186381459236
        ],
        [
          "5",
          0.011539751663804054
        ],
        [
          "4",
          0.00954734068363905
        ],
        [
          "........................",
          0.008209837600588799
        ],
        [
          "8",
          0.00768353370949626
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named ",
      "entropy": 4.561213453321557,
      "topk": [
        [
          " ",
          0.4490654766559601
        ],
        [
          "3",
          0.037859901785850525
        ],
        [
          " B",
          0.032931797206401825
        ],
        [
          "2",
          0.0322054922580719
        ],
        [
          "1",
          0.03197971358895302
        ],
        [
          "4",
          0.031057849526405334
        ],
        [
          "201",
          0.023120176047086716
        ],
        [
          "5",
          0.01986745186150074
        ],
        [
          "10",
          0.017844347283244133
        ],
        [
          "7",
          0.017127566039562225
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at ",
      "entropy": 5.842417129015645,
      "topk": [
        [
          "52",
          0.18550051748752594
        ],
        [
          "51",
          0.11616676300764084
        ],
        [
          " ",
          0.10304611921310425
        ],
        [
          "49",
          0.03585236519575119
        ],
        [
          "13",
          0.025088107213377953
        ],
        [
          "50",
          0.024760661646723747
        ],
        [
          "53",
          0.017512116581201553
        ],
        [
          " Berlin",
          0.017458055168390274
        ],
        [
          "2",
          0.01597156561911106
        ],
        [
          "12",
          0.014807051979005337
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany, the capital city is ",
      "entropy": 7.123397571228913,
      "topk": [
        [
          " ",
          0.1692017763853073
        ],
        [
          "1",
          0.05664534494280815
        ],
        [
          " B",
          0.038957029581069946
        ],
        [
          "2",
          0.033541321754455566
        ],
        [
          "3",
          0.025183703750371933
        ],
        [
          "10",
          0.020657865330576897
        ],
        [
          "4",
          0.019629480317234993
        ],
        [
          "100",
          0.018118100240826607
        ],
        [
          "5",
          0.017694074660539627
        ],
        [
          "8",
          0.013325043022632599
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 9.81757827225595e-16,
      "topk": [
        [
          " Berlin",
          1.0
        ],
        [
          " Germany",
          1.5629963140354908e-17
        ],
        [
          " The",
          1.852290656438969e-18
        ],
        [
          " ",
          7.200042786519202e-22
        ],
        [
          " Ber",
          5.7939163194319144e-24
        ],
        [
          " This",
          7.051377168433217e-25
        ],
        [
          " ",
          1.5058674288138362e-25
        ],
        [
          "Berlin",
          1.3013914774331225e-25
        ],
        [
          " (",
          1.2879973588195684e-25
        ],
        [
          " None",
          1.1553993316346822e-25
        ],
        [
          " A",
          3.363430188182269e-26
        ],
        [
          " Bon",
          2.269603206648196e-26
        ],
        [
          " What",
          1.9705720760517587e-26
        ],
        [
          " It",
          4.695325915336717e-27
        ],
        [
          " the",
          4.678499354302097e-28
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 14.520185643575381,
      "topk": [
        [
          " Berlin",
          0.03490900993347168
        ],
        [
          " Germany",
          0.005042379256337881
        ],
        [
          " The",
          0.004532345570623875
        ],
        [
          " ",
          0.003060583956539631
        ],
        [
          " Ber",
          0.002404841361567378
        ],
        [
          " This",
          0.002164469799026847
        ],
        [
          " ",
          0.0020036743953824043
        ],
        [
          "Berlin",
          0.001989106647670269
        ],
        [
          " (",
          0.0019880777690559626
        ],
        [
          " None",
          0.0019773084204643965
        ],
        [
          " A",
          0.0018589891260489821
        ],
        [
          " Bon",
          0.0018227844266220927
        ],
        [
          " What",
          0.0018099530134350061
        ],
        [
          " It",
          0.00168469431810081
        ],
        [
          " the",
          0.0015012151561677456
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 128256,
    "n_ctx": 8192
  }
}