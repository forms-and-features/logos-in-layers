{
  "diagnostics": {
    "type": "diagnostics",
    "model": "meta-llama/Meta-Llama-3-8B",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 25,
    "delta_layers": null
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.9611979704864426,
    "topk": [
      [
        " Berlin",
        0.520228922367096
      ],
      [
        " \"",
        0.18650762736797333
      ],
      [
        " “",
        0.05880846455693245
      ],
      [
        " '",
        0.041831616312265396
      ],
      [
        ":",
        0.030194329097867012
      ],
      [
        " Germany",
        0.018765203654766083
      ],
      [
        ",",
        0.015478894114494324
      ],
      [
        " ‘",
        0.014754028990864754
      ],
      [
        " Deutschland",
        0.008174380287528038
      ],
      [
        " as",
        0.008158095180988312
      ],
      [
        " Bon",
        0.0071195270866155624
      ],
      [
        " BER",
        0.00545007036998868
      ],
      [
        " „",
        0.005353925749659538
      ],
      [
        " berlin",
        0.003539292374625802
      ],
      [
        " the",
        0.003145547118037939
      ],
      [
        " by",
        0.002776083769276738
      ],
      [
        " Stadt",
        0.0026797098107635975
      ],
      [
        " ''",
        0.002273173537105322
      ],
      [
        " that",
        0.0022617103531956673
      ],
      [
        " `",
        0.002243690425530076
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9277053756311451,
      "topk": [
        [
          " Germany",
          0.8956014513969421
        ],
        [
          " the",
          0.05247712507843971
        ],
        [
          " and",
          0.007549549452960491
        ],
        [
          " germany",
          0.0033605718053877354
        ],
        [
          " modern",
          0.002971619600430131
        ],
        [
          " Berlin",
          0.00289486744441092
        ],
        [
          " united",
          0.0026283240877091885
        ],
        [
          " German",
          0.002495510270819068
        ],
        [
          " Europe",
          0.0022101067006587982
        ],
        [
          " a",
          0.002209371654316783
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 3.3920599143176062,
      "topk": [
        [
          " Berlin",
          0.368852823972702
        ],
        [
          " \"",
          0.24859248101711273
        ],
        [
          ",",
          0.08011049032211304
        ],
        [
          " '",
          0.07340031117200851
        ],
        [
          " by",
          0.03884730115532875
        ],
        [
          ":",
          0.03127266839146614
        ],
        [
          " “",
          0.016475247219204903
        ],
        [
          " ",
          0.014560988172888756
        ],
        [
          " Stadt",
          0.011578901670873165
        ],
        [
          " as",
          0.008946679532527924
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.3234426202416643,
      "topk": [
        [
          " Berlin",
          0.31998157501220703
        ],
        [
          " as",
          0.2749672532081604
        ],
        [
          " “",
          0.09449566900730133
        ],
        [
          " after",
          0.056023042649030685
        ],
        [
          ",",
          0.05314028263092041
        ],
        [
          " \"",
          0.037853263318538666
        ],
        [
          " ‘",
          0.025342080742120743
        ],
        [
          ":",
          0.019972583279013634
        ],
        [
          " by",
          0.011121178977191448
        ],
        [
          " '",
          0.010516123846173286
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 3.339312491332681,
      "topk": [
        [
          " Berlin",
          0.4262532591819763
        ],
        [
          " “",
          0.1589614450931549
        ],
        [
          ",",
          0.116493821144104
        ],
        [
          " ‘",
          0.050376757979393005
        ],
        [
          " \"",
          0.040278542786836624
        ],
        [
          " as",
          0.03721463680267334
        ],
        [
          " the",
          0.021798256784677505
        ],
        [
          ":",
          0.015213514678180218
        ],
        [
          " Germany",
          0.015035569667816162
        ],
        [
          " '",
          0.011130711063742638
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.5387249963990652,
      "topk": [
        [
          " called",
          0.5538974404335022
        ],
        [
          " known",
          0.17157240211963654
        ],
        [
          " referred",
          0.08904284983873367
        ],
        [
          " Berlin",
          0.07770130038261414
        ],
        [
          " named",
          0.014265386387705803
        ],
        [
          " “",
          0.013462397269904613
        ],
        [
          " \"",
          0.010317234322428703
        ],
        [
          " the",
          0.005376745481044054
        ],
        [
          " just",
          0.0050463625229895115
        ],
        [
          " ‘",
          0.0042366404086351395
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 2.283333683572859,
      "topk": [
        [
          " Berlin",
          0.7524991631507874
        ],
        [
          " what",
          0.036330487579107285
        ],
        [
          "?\n",
          0.02611571177840233
        ],
        [
          "...\n",
          0.015026182867586613
        ],
        [
          "\n",
          0.012724772095680237
        ],
        [
          " \"",
          0.011971786618232727
        ],
        [
          "...",
          0.00858641229569912
        ],
        [
          " by",
          0.0074728927575051785
        ],
        [
          "?",
          0.0053668636828660965
        ],
        [
          " __",
          0.004927673377096653
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.6053435081066794,
      "topk": [
        [
          " Berlin",
          0.5760178565979004
        ],
        [
          " after",
          0.16987966001033783
        ],
        [
          " as",
          0.08521045744419098
        ],
        [
          " for",
          0.02873457968235016
        ],
        [
          " what",
          0.01923820562660694
        ],
        [
          " “",
          0.013166218064725399
        ],
        [
          " in",
          0.00988700333982706
        ],
        [
          " the",
          0.008589879609644413
        ],
        [
          " \"",
          0.005474345292896032
        ],
        [
          " by",
          0.004681969061493874
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 0.9255131987719223,
      "topk": [
        [
          " Berlin",
          0.9139253497123718
        ],
        [
          " the",
          0.02547946758568287
        ],
        [
          " Bon",
          0.006495395675301552
        ],
        [
          " ",
          0.00631173700094223
        ],
        [
          " a",
          0.0037994845770299435
        ],
        [
          " Ber",
          0.003563466016203165
        ],
        [
          " berlin",
          0.0034471137914806604
        ],
        [
          " Germany",
          0.0025796128902584314
        ],
        [
          " Frankfurt",
          0.0024282357189804316
        ],
        [
          " its",
          0.0013671271735802293
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.3088777507575595,
      "topk": [
        [
          " Berlin",
          0.706605851650238
        ],
        [
          " the",
          0.09775615483522415
        ],
        [
          " “",
          0.03761352598667145
        ],
        [
          " \"",
          0.02484748698771
        ],
        [
          " ‘",
          0.015918884426355362
        ],
        [
          " a",
          0.01042487658560276
        ],
        [
          " '",
          0.009433264844119549
        ],
        [
          " Germany",
          0.006079251877963543
        ],
        [
          " ",
          0.005979056935757399
        ],
        [
          " Bon",
          0.005073904991149902
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 2.1051407391873944,
      "topk": [
        [
          " Germany",
          0.7223668098449707
        ],
        [
          " which",
          0.08233131468296051
        ],
        [
          " the",
          0.05979063734412193
        ],
        [
          " what",
          0.036541685461997986
        ],
        [
          " germany",
          0.008220762014389038
        ],
        [
          " united",
          0.004635083954781294
        ],
        [
          " both",
          0.004107808228582144
        ],
        [
          " and",
          0.0036664295475929976
        ],
        [
          ".",
          0.0033866078592836857
        ],
        [
          " a",
          0.0032534850761294365
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 1.6061439126159596,
      "topk": [
        [
          " Berlin",
          0.8267664313316345
        ],
        [
          " \"",
          0.06106757000088692
        ],
        [
          " '",
          0.014362531714141369
        ],
        [
          ":",
          0.006859496235847473
        ],
        [
          " Bon",
          0.0056615001522004604
        ],
        [
          " BER",
          0.004188877064734697
        ],
        [
          " what",
          0.0036292977165430784
        ],
        [
          ".",
          0.003186015645042062
        ],
        [
          ",",
          0.0031059642788022757
        ],
        [
          " berlin",
          0.0028608108405023813
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.3622377786926934,
      "topk": [
        [
          " Berlin",
          0.425076961517334
        ],
        [
          " \"",
          0.13349999487400055
        ],
        [
          " as",
          0.1269444227218628
        ],
        [
          " “",
          0.07215877622365952
        ],
        [
          " '",
          0.038091063499450684
        ],
        [
          ",",
          0.024774793535470963
        ],
        [
          ":",
          0.024618593975901604
        ],
        [
          " ‘",
          0.02054423652589321
        ],
        [
          " after",
          0.01639202982187271
        ],
        [
          " Germany",
          0.011520260944962502
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 0.8553711925047565,
      "topk": [
        [
          " Berlin",
          0.9249039888381958
        ],
        [
          " the",
          0.014780218712985516
        ],
        [
          " Bon",
          0.009145531803369522
        ],
        [
          " berlin",
          0.004399341065436602
        ],
        [
          " Ber",
          0.0027577884029597044
        ],
        [
          " Germany",
          0.0025456140283495188
        ],
        [
          " Frankfurt",
          0.0020716667640954256
        ],
        [
          " ",
          0.002044771797955036
        ],
        [
          " ",
          0.0017367627006024122
        ],
        [
          " both",
          0.0016791241941973567
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.187845997604434,
      "topk": [
        [
          " the",
          0.38451677560806274
        ],
        [
          " \"",
          0.14996843039989471
        ],
        [
          " Haupt",
          0.06667246669530869
        ],
        [
          " a",
          0.04538704454898834
        ],
        [
          " Berlin",
          0.042986344546079636
        ],
        [
          " Stadt",
          0.03765241429209709
        ],
        [
          " '",
          0.03399653360247612
        ],
        [
          " “",
          0.028083395212888718
        ],
        [
          " H",
          0.009895744733512402
        ],
        [
          " ‘",
          0.00955051276832819
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.0005696561694167336,
      "topk": [
        [
          " Berlin",
          0.9999649524688721
        ],
        [
          " \"",
          3.5075230698566884e-05
        ],
        [
          " “",
          3.407506221630996e-10
        ],
        [
          " '",
          1.1300074591324982e-11
        ],
        [
          ":",
          4.3380075464942436e-13
        ],
        [
          " Germany",
          3.728794887875725e-15
        ],
        [
          ",",
          5.437980108734578e-16
        ],
        [
          " ‘",
          3.3662301639791653e-16
        ],
        [
          " Deutschland",
          9.17450005620327e-19
        ],
        [
          " as",
          8.993480884927931e-19
        ],
        [
          " Bon",
          2.30436621279876e-19
        ],
        [
          " BER",
          1.5924223608907394e-20
        ],
        [
          " „",
          1.332794438858639e-20
        ],
        [
          " berlin",
          2.1242310140626984e-22
        ],
        [
          " the",
          6.531243860500187e-23
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 13.873247448922598,
      "topk": [
        [
          " Berlin",
          0.03655584901571274
        ],
        [
          " \"",
          0.021888094022870064
        ],
        [
          " “",
          0.01229078322649002
        ],
        [
          " '",
          0.010366017930209637
        ],
        [
          ":",
          0.008806885220110416
        ],
        [
          " Germany",
          0.0069428253918886185
        ],
        [
          ",",
          0.006305646616965532
        ],
        [
          " ‘",
          0.006156231742352247
        ],
        [
          " Deutschland",
          0.004582337103784084
        ],
        [
          " as",
          0.004577770829200745
        ],
        [
          " Bon",
          0.004276467952877283
        ],
        [
          " BER",
          0.0037416284903883934
        ],
        [
          " „",
          0.0037084787618368864
        ],
        [
          " berlin",
          0.003015211783349514
        ],
        [
          " the",
          0.002842547371983528
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 128256,
    "n_ctx": 8192
  }
}