{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9490770577145883,
      "topk": [
        [
          "Germany",
          0.89697265625
        ],
        [
          "the",
          0.053863525390625
        ],
        [
          "both",
          0.004352569580078125
        ],
        [
          "a",
          0.003810882568359375
        ],
        [
          "Europe",
          0.0031108856201171875
        ],
        [
          "Berlin",
          0.0028324127197265625
        ],
        [
          "German",
          0.00244140625
        ],
        [
          "modern",
          0.001613616943359375
        ],
        [
          "and",
          0.0014696121215820312
        ],
        [
          "one",
          0.0011091232299804688
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.3964692027725913,
      "topk": [
        [
          "Berlin",
          0.53955078125
        ],
        [
          "\"",
          0.2449951171875
        ],
        [
          "'",
          0.057281494140625
        ],
        [
          ",",
          0.04638671875
        ],
        [
          "by",
          0.0181732177734375
        ],
        [
          "“",
          0.01529693603515625
        ],
        [
          "the",
          0.01093292236328125
        ],
        [
          ":",
          0.00684356689453125
        ],
        [
          "and",
          0.006427764892578125
        ],
        [
          "‘",
          0.003360748291015625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.7582281762696117,
      "topk": [
        [
          "Berlin",
          0.34619140625
        ],
        [
          "“",
          0.11590576171875
        ],
        [
          ",",
          0.09759521484375
        ],
        [
          "after",
          0.08154296875
        ],
        [
          "as",
          0.054351806640625
        ],
        [
          "‘",
          0.04833984375
        ],
        [
          "because",
          0.032958984375
        ],
        [
          "\"",
          0.0277557373046875
        ],
        [
          "and",
          0.02392578125
        ],
        [
          "for",
          0.02374267578125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.247246735924967,
      "topk": [
        [
          "Berlin",
          0.634765625
        ],
        [
          "“",
          0.125
        ],
        [
          "‘",
          0.058135986328125
        ],
        [
          ",",
          0.04388427734375
        ],
        [
          "\"",
          0.04388427734375
        ],
        [
          "'",
          0.015289306640625
        ],
        [
          "as",
          0.015167236328125
        ],
        [
          "the",
          0.006572723388671875
        ],
        [
          ":",
          0.005001068115234375
        ],
        [
          "–",
          0.004924774169921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 3.0518768550497635,
      "topk": [
        [
          "called",
          0.41943359375
        ],
        [
          "known",
          0.1981201171875
        ],
        [
          "Berlin",
          0.154296875
        ],
        [
          "referred",
          0.0758056640625
        ],
        [
          "“",
          0.0225830078125
        ],
        [
          "named",
          0.0157623291015625
        ],
        [
          "‘",
          0.01180267333984375
        ],
        [
          "not",
          0.00971221923828125
        ],
        [
          "the",
          0.00823974609375
        ],
        [
          "\"",
          0.007503509521484375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 1.780870890638586,
      "topk": [
        [
          "Berlin",
          0.810546875
        ],
        [
          "\"",
          0.040374755859375
        ],
        [
          "the",
          0.02545166015625
        ],
        [
          "by",
          0.0098114013671875
        ],
        [
          "home",
          0.00914764404296875
        ],
        [
          "'",
          0.0088653564453125
        ],
        [
          "a",
          0.00846099853515625
        ],
        [
          "many",
          0.0058135986328125
        ],
        [
          ",",
          0.003444671630859375
        ],
        [
          "to",
          0.00336456298828125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.325598935970347,
      "topk": [
        [
          "Berlin",
          0.5263671875
        ],
        [
          "after",
          0.279541015625
        ],
        [
          "as",
          0.047821044921875
        ],
        [
          "for",
          0.03753662109375
        ],
        [
          "in",
          0.0182952880859375
        ],
        [
          "“",
          0.0127716064453125
        ],
        [
          "Bon",
          0.0121917724609375
        ],
        [
          "the",
          0.01010894775390625
        ],
        [
          "‘",
          0.006175994873046875
        ],
        [
          ",",
          0.0050811767578125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.1892399087461707,
      "topk": [
        [
          "Berlin",
          0.8779296875
        ],
        [
          "the",
          0.05108642578125
        ],
        [
          "Bon",
          0.0137481689453125
        ],
        [
          "a",
          0.004001617431640625
        ],
        [
          "its",
          0.0029735565185546875
        ],
        [
          "Ber",
          0.0022983551025390625
        ],
        [
          "Frankfurt",
          0.0019664764404296875
        ],
        [
          "",
          0.0015430450439453125
        ],
        [
          "least",
          0.0014495849609375
        ],
        [
          "last",
          0.0013933181762695312
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.6907335821906675,
      "topk": [
        [
          "Berlin",
          0.5751953125
        ],
        [
          "the",
          0.1739501953125
        ],
        [
          "“",
          0.07086181640625
        ],
        [
          "‘",
          0.037933349609375
        ],
        [
          "\"",
          0.0184783935546875
        ],
        [
          "a",
          0.0172271728515625
        ],
        [
          "'",
          0.008331298828125
        ],
        [
          "Die",
          0.006290435791015625
        ],
        [
          "The",
          0.005771636962890625
        ],
        [
          "Deutschland",
          0.004528045654296875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 1.1142823022635209,
      "topk": [
        [
          "Germany",
          0.88232421875
        ],
        [
          "the",
          0.055084228515625
        ],
        [
          "germ",
          0.00383758544921875
        ],
        [
          "Europe",
          0.003414154052734375
        ],
        [
          "and",
          0.003307342529296875
        ],
        [
          "both",
          0.0029888153076171875
        ],
        [
          "Berlin",
          0.0027866363525390625
        ],
        [
          "German",
          0.00261688232421875
        ],
        [
          "a",
          0.0024013519287109375
        ],
        [
          ".",
          0.0019445419311523438
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 1.7441087391034062,
      "topk": [
        [
          "Berlin",
          0.80322265625
        ],
        [
          "\"",
          0.06292724609375
        ],
        [
          "'",
          0.030426025390625
        ],
        [
          "the",
          0.007694244384765625
        ],
        [
          "by",
          0.00751495361328125
        ],
        [
          "simply",
          0.004852294921875
        ],
        [
          ",",
          0.004489898681640625
        ],
        [
          "Ber",
          0.00424957275390625
        ],
        [
          ":",
          0.00389862060546875
        ],
        [
          "both",
          0.00386810302734375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.6325470386373904,
      "topk": [
        [
          "Berlin",
          0.365234375
        ],
        [
          "\"",
          0.1571044921875
        ],
        [
          "“",
          0.09307861328125
        ],
        [
          "as",
          0.07537841796875
        ],
        [
          "'",
          0.056915283203125
        ],
        [
          "‘",
          0.0416259765625
        ],
        [
          ",",
          0.032440185546875
        ],
        [
          "B",
          0.021270751953125
        ],
        [
          "Germany",
          0.0189208984375
        ],
        [
          ":",
          0.01861572265625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 0.9982284954526229,
      "topk": [
        [
          "Berlin",
          0.91064453125
        ],
        [
          "Bon",
          0.0187530517578125
        ],
        [
          "the",
          0.01210784912109375
        ],
        [
          "Ber",
          0.00452423095703125
        ],
        [
          "ber",
          0.0034427642822265625
        ],
        [
          "Germany",
          0.0025577545166015625
        ],
        [
          "B",
          0.0025196075439453125
        ],
        [
          ".",
          0.002498626708984375
        ],
        [
          ",",
          0.0022754669189453125
        ],
        [
          ".",
          0.00156402587890625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.1996395359047,
      "topk": [
        [
          "Berlin",
          0.3916015625
        ],
        [
          "the",
          0.1322021484375
        ],
        [
          "\"",
          0.120361328125
        ],
        [
          "“",
          0.04290771484375
        ],
        [
          "'",
          0.03875732421875
        ],
        [
          "a",
          0.027069091796875
        ],
        [
          "‘",
          0.01483154296875
        ],
        [
          ":",
          0.01483154296875
        ],
        [
          "Haupt",
          0.0135040283203125
        ],
        [
          "Stadt",
          0.007228851318359375
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.005483804207339175,
      "topk": [
        [
          "Berlin",
          0.9995670914649963
        ],
        [
          "\"",
          0.0004305560723878443
        ],
        [
          "“",
          2.4050664251262788e-06
        ],
        [
          "'",
          6.346051684147369e-09
        ],
        [
          "Germany",
          2.060261294900556e-09
        ],
        [
          "‘",
          1.691165540940176e-10
        ],
        [
          ",",
          3.899148798974794e-14
        ],
        [
          ":",
          1.526928506323435e-14
        ],
        [
          "B",
          2.4926424161910874e-15
        ],
        [
          "Deutschland",
          1.3342153818123991e-15
        ],
        [
          "Bon",
          1.1774409123412976e-15
        ],
        [
          "as",
          8.012586250401879e-17
        ],
        [
          "the",
          3.3071892709467437e-18
        ],
        [
          "by",
          1.8843798875320448e-18
        ],
        [
          "Frankfurt",
          7.855263818442714e-19
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.220077288185315,
      "topk": [
        [
          "Berlin",
          0.035983532667160034
        ],
        [
          "\"",
          0.02434767782688141
        ],
        [
          "“",
          0.01881442777812481
        ],
        [
          "'",
          0.013981695286929607
        ],
        [
          "Germany",
          0.013185994699597359
        ],
        [
          "‘",
          0.011636598967015743
        ],
        [
          ",",
          0.007661336101591587
        ],
        [
          ":",
          0.007310498505830765
        ],
        [
          "B",
          0.006682336330413818
        ],
        [
          "Deutschland",
          0.006476742681115866
        ],
        [
          "Bon",
          0.006426340434700251
        ],
        [
          "as",
          0.005627091508358717
        ],
        [
          "the",
          0.00479434197768569
        ],
        [
          "by",
          0.00466502271592617
        ],
        [
          "Frankfurt",
          0.004468817729502916
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "mistralai/Mistral-7B-v0.1",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float16",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 25,
    "delta_layers": null
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 3.610462746440097,
    "topk": [
      [
        "Berlin",
        0.382080078125
      ],
      [
        "\"",
        0.1749267578125
      ],
      [
        "“",
        0.10443115234375
      ],
      [
        "'",
        0.05767822265625
      ],
      [
        "Germany",
        0.051300048828125
      ],
      [
        "‘",
        0.039947509765625
      ],
      [
        ",",
        0.0173187255859375
      ],
      [
        ":",
        0.015777587890625
      ],
      [
        "B",
        0.01317596435546875
      ],
      [
        "Deutschland",
        0.01238250732421875
      ],
      [
        "Bon",
        0.01218414306640625
      ],
      [
        "as",
        0.00934600830078125
      ],
      [
        "the",
        0.00678253173828125
      ],
      [
        "by",
        0.0064239501953125
      ],
      [
        "Frankfurt",
        0.005893707275390625
      ],
      [
        "„",
        0.00421142578125
      ],
      [
        "German",
        0.004177093505859375
      ],
      [
        "«",
        0.0035190582275390625
      ],
      [
        ".",
        0.003154754638671875
      ],
      [
        "and",
        0.002574920654296875
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 32000,
    "n_ctx": 2048
  }
}