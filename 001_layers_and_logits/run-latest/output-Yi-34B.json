{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 1.3555077481034592,
      "topk": [
        [
          " Germany",
          0.85009765625
        ],
        [
          " the",
          0.049468994140625
        ],
        [
          " which",
          0.0266876220703125
        ],
        [
          " what",
          0.0112152099609375
        ],
        [
          " Europe",
          0.00634002685546875
        ],
        [
          ":",
          0.004123687744140625
        ],
        [
          " both",
          0.00366973876953125
        ],
        [
          " germ",
          0.003238677978515625
        ],
        [
          " ",
          0.0027904510498046875
        ],
        [
          " a",
          0.002140045166015625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 3.5884888671046578,
      "topk": [
        [
          " Berlin",
          0.452392578125
        ],
        [
          " \"",
          0.1358642578125
        ],
        [
          ":",
          0.059814453125
        ],
        [
          " '",
          0.056182861328125
        ],
        [
          " ",
          0.04693603515625
        ],
        [
          ",",
          0.03253173828125
        ],
        [
          ".",
          0.0237884521484375
        ],
        [
          " “",
          0.01535797119140625
        ],
        [
          "?",
          0.0128326416015625
        ],
        [
          "\n",
          0.0128326416015625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.8391209040335372,
      "topk": [
        [
          " Berlin",
          0.406005859375
        ],
        [
          " as",
          0.096435546875
        ],
        [
          " ",
          0.07806396484375
        ],
        [
          " \"",
          0.07000732421875
        ],
        [
          " “",
          0.042449951171875
        ],
        [
          ":",
          0.0374755859375
        ],
        [
          " after",
          0.036590576171875
        ],
        [
          ",",
          0.0247650146484375
        ],
        [
          "\n",
          0.019744873046875
        ],
        [
          " enough",
          0.01611328125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 3.0369487609548718,
      "topk": [
        [
          " Berlin",
          0.55078125
        ],
        [
          ",",
          0.07568359375
        ],
        [
          " “",
          0.07110595703125
        ],
        [
          " \"",
          0.07000732421875
        ],
        [
          " as",
          0.050445556640625
        ],
        [
          ":",
          0.0199127197265625
        ],
        [
          " '",
          0.0162506103515625
        ],
        [
          " enough",
          0.0116119384765625
        ],
        [
          " ‘",
          0.010406494140625
        ],
        [
          " ",
          0.010406494140625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 3.380615500798591,
      "topk": [
        [
          " called",
          0.38818359375
        ],
        [
          " known",
          0.1519775390625
        ],
        [
          " referred",
          0.132080078125
        ],
        [
          " Berlin",
          0.09661865234375
        ],
        [
          " \"",
          0.047454833984375
        ],
        [
          " named",
          0.036376953125
        ],
        [
          " “",
          0.0250091552734375
        ],
        [
          " the",
          0.0224151611328125
        ],
        [
          " '",
          0.01349639892578125
        ],
        [
          " ‘",
          0.00566864013671875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 3.469585221777638,
      "topk": [
        [
          " Berlin",
          0.51513671875
        ],
        [
          ":",
          0.0789794921875
        ],
        [
          " ",
          0.0777587890625
        ],
        [
          ".",
          0.05059814453125
        ],
        [
          "?",
          0.04754638671875
        ],
        [
          "\n",
          0.029296875
        ],
        [
          " (",
          0.01373291015625
        ],
        [
          " \"",
          0.01202392578125
        ],
        [
          " what",
          0.01061248779296875
        ],
        [
          " '",
          0.01061248779296875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 3.8374956679828838,
      "topk": [
        [
          " after",
          0.351806640625
        ],
        [
          " Berlin",
          0.1973876953125
        ],
        [
          " ",
          0.0882568359375
        ],
        [
          ":",
          0.048004150390625
        ],
        [
          " for",
          0.048004150390625
        ],
        [
          "\n",
          0.0282135009765625
        ],
        [
          "?",
          0.02569580078125
        ],
        [
          " as",
          0.0245208740234375
        ],
        [
          ".",
          0.02130126953125
        ],
        [
          " what",
          0.016326904296875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 2.8448702813040456,
      "topk": [
        [
          " Berlin",
          0.6865234375
        ],
        [
          " Bon",
          0.043548583984375
        ],
        [
          "Ber",
          0.03472900390625
        ],
        [
          " the",
          0.02313232421875
        ],
        [
          ":",
          0.020416259765625
        ],
        [
          " ",
          0.01493072509765625
        ],
        [
          "\n",
          0.01190948486328125
        ],
        [
          "?",
          0.01050567626953125
        ],
        [
          ".",
          0.0083770751953125
        ],
        [
          " Frankfurt",
          0.007747650146484375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 4.708302991333181,
      "topk": [
        [
          " Berlin",
          0.306884765625
        ],
        [
          " the",
          0.1531982421875
        ],
        [
          ":",
          0.0706787109375
        ],
        [
          " ",
          0.059967041015625
        ],
        [
          "\n",
          0.035247802734375
        ],
        [
          "?",
          0.034698486328125
        ],
        [
          " \"",
          0.0303955078125
        ],
        [
          " A",
          0.027679443359375
        ],
        [
          ".",
          0.0236663818359375
        ],
        [
          " (",
          0.0175933837890625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 1.036899912386356,
      "topk": [
        [
          " Germany",
          0.8955078125
        ],
        [
          " the",
          0.025604248046875
        ],
        [
          " ",
          0.0092010498046875
        ],
        [
          " which",
          0.007335662841796875
        ],
        [
          ":",
          0.006473541259765625
        ],
        [
          " this",
          0.00562286376953125
        ],
        [
          ".",
          0.005580902099609375
        ],
        [
          " germ",
          0.0034122467041015625
        ],
        [
          "\n",
          0.0032558441162109375
        ],
        [
          "G",
          0.0023822784423828125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 3.585765693810896,
      "topk": [
        [
          " Berlin",
          0.416748046875
        ],
        [
          ":",
          0.14404296875
        ],
        [
          " ",
          0.1331787109375
        ],
        [
          ".",
          0.0712890625
        ],
        [
          "\n",
          0.03289794921875
        ],
        [
          " \"",
          0.0276947021484375
        ],
        [
          "?",
          0.01517486572265625
        ],
        [
          " (",
          0.0093536376953125
        ],
        [
          " :",
          0.0087127685546875
        ],
        [
          " '",
          0.0082550048828125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.4821726319942865,
      "topk": [
        [
          " Berlin",
          0.453125
        ],
        [
          " \"",
          0.10430908203125
        ],
        [
          ":",
          0.087158203125
        ],
        [
          " as",
          0.076904296875
        ],
        [
          " ",
          0.042144775390625
        ],
        [
          " '",
          0.0249786376953125
        ],
        [
          ".",
          0.0247802734375
        ],
        [
          " after",
          0.023468017578125
        ],
        [
          ",",
          0.023101806640625
        ],
        [
          " “",
          0.01468658447265625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 1.2769931964356647,
      "topk": [
        [
          " Berlin",
          0.8603515625
        ],
        [
          " Bon",
          0.04150390625
        ],
        [
          " the",
          0.029205322265625
        ],
        [
          ":",
          0.005077362060546875
        ],
        [
          " Frankfurt",
          0.004657745361328125
        ],
        [
          " Ber",
          0.00368499755859375
        ],
        [
          " ber",
          0.00351715087890625
        ],
        [
          ".",
          0.0034351348876953125
        ],
        [
          " Munich",
          0.00273895263671875
        ],
        [
          "Ber",
          0.0026340484619140625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.098906545571939,
      "topk": [
        [
          " Berlin",
          0.466064453125
        ],
        [
          " \"",
          0.0687255859375
        ],
        [
          ":",
          0.061614990234375
        ],
        [
          " ",
          0.0606689453125
        ],
        [
          " the",
          0.05438232421875
        ],
        [
          ".",
          0.02734375
        ],
        [
          " “",
          0.018798828125
        ],
        [
          " '",
          0.0135345458984375
        ],
        [
          "\n",
          0.0114898681640625
        ],
        [
          " what",
          0.01079559326171875
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 1.1243521942852134e-05,
      "topk": [
        [
          " Berlin",
          0.9999995231628418
        ],
        [
          " \"",
          5.043474402555148e-07
        ],
        [
          ":",
          1.4930939817858757e-10
        ],
        [
          " ",
          5.7893538053799265e-12
        ],
        [
          " '",
          3.266130042204468e-13
        ],
        [
          ".",
          1.266416069505439e-14
        ],
        [
          " “",
          2.978325073036954e-16
        ],
        [
          "\n",
          1.806445329041075e-16
        ],
        [
          ",",
          1.482820675110931e-17
        ],
        [
          " (",
          1.3656306011201533e-19
        ],
        [
          " _",
          1.1815018931323399e-21
        ],
        [
          " as",
          1.1099183574296293e-21
        ],
        [
          " -",
          1.2452939317157167e-22
        ],
        [
          " ‘",
          9.11076537803134e-23
        ],
        [
          " and",
          9.11076537803134e-23
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.516646923055557,
      "topk": [
        [
          " Berlin",
          0.048157427459955215
        ],
        [
          " \"",
          0.023378554731607437
        ],
        [
          ":",
          0.015573476441204548
        ],
        [
          " ",
          0.013268766924738884
        ],
        [
          " '",
          0.01148316077888012
        ],
        [
          ".",
          0.00974563229829073
        ],
        [
          " “",
          0.008079412393271923
        ],
        [
          "\n",
          0.007861483842134476
        ],
        [
          ",",
          0.006937735714018345
        ],
        [
          " (",
          0.005509680602699518
        ],
        [
          " _",
          0.004341523628681898
        ],
        [
          " as",
          0.004324598237872124
        ],
        [
          " -",
          0.0038765445351600647
        ],
        [
          " ‘",
          0.0038164444267749786
        ],
        [
          " and",
          0.0038164444267749786
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "01-ai/Yi-34B",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float16",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 44,
    "delta_layers": null
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.955316851757538,
    "topk": [
      [
        " Berlin",
        0.56103515625
      ],
      [
        " \"",
        0.1322021484375
      ],
      [
        ":",
        0.058685302734375
      ],
      [
        " ",
        0.0426025390625
      ],
      [
        " '",
        0.031890869140625
      ],
      [
        ".",
        0.022979736328125
      ],
      [
        " “",
        0.0157928466796875
      ],
      [
        "\n",
        0.01495361328125
      ],
      [
        ",",
        0.0116424560546875
      ],
      [
        " (",
        0.007343292236328125
      ],
      [
        " _",
        0.004558563232421875
      ],
      [
        " as",
        0.00452423095703125
      ],
      [
        " -",
        0.003635406494140625
      ],
      [
        " and",
        0.0035228729248046875
      ],
      [
        " ‘",
        0.0035228729248046875
      ],
      [
        " __",
        0.0032596588134765625
      ],
      [
        "…",
        0.0028095245361328125
      ],
      [
        "Ber",
        0.0026397705078125
      ],
      [
        " :",
        0.0025787353515625
      ],
      [
        "?",
        0.0025177001953125
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 60,
    "d_model": 7168,
    "n_heads": 56,
    "d_vocab": 64000,
    "n_ctx": 4096
  }
}