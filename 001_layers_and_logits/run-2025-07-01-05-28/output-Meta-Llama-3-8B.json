{
  "diagnostics": {
    "type": "diagnostics",
    "model": "meta-llama/Meta-Llama-3-8B",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float16",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 25,
    "delta_layers": null
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.9732463870752874,
    "topk": [
      [
        " Berlin",
        0.517578125
      ],
      [
        " \"",
        0.1873779296875
      ],
      [
        " “",
        0.058990478515625
      ],
      [
        " '",
        0.04180908203125
      ],
      [
        ":",
        0.0305938720703125
      ],
      [
        " Germany",
        0.0188446044921875
      ],
      [
        ",",
        0.015625
      ],
      [
        " ‘",
        0.01479339599609375
      ],
      [
        " Deutschland",
        0.00823211669921875
      ],
      [
        " as",
        0.00823211669921875
      ],
      [
        " Bon",
        0.0071563720703125
      ],
      [
        " BER",
        0.00548553466796875
      ],
      [
        " „",
        0.005359649658203125
      ],
      [
        " berlin",
        0.0035419464111328125
      ],
      [
        " the",
        0.0031757354736328125
      ],
      [
        " by",
        0.0028018951416015625
      ],
      [
        " Stadt",
        0.002716064453125
      ],
      [
        " that",
        0.0022869110107421875
      ],
      [
        " ''",
        0.0022869110107421875
      ],
      [
        " `",
        0.00225067138671875
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9268237925628223,
      "topk": [
        [
          " Germany",
          0.89599609375
        ],
        [
          " the",
          0.052154541015625
        ],
        [
          " and",
          0.007511138916015625
        ],
        [
          " germany",
          0.0033588409423828125
        ],
        [
          " modern",
          0.002964019775390625
        ],
        [
          " Berlin",
          0.002918243408203125
        ],
        [
          " united",
          0.00261688232421875
        ],
        [
          " German",
          0.0024967193603515625
        ],
        [
          " Europe",
          0.00222015380859375
        ],
        [
          " a",
          0.0022029876708984375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 3.3862386455512015,
      "topk": [
        [
          " Berlin",
          0.37109375
        ],
        [
          " \"",
          0.247314453125
        ],
        [
          ",",
          0.08026123046875
        ],
        [
          " '",
          0.0731201171875
        ],
        [
          " by",
          0.03851318359375
        ],
        [
          ":",
          0.03094482421875
        ],
        [
          " “",
          0.0163116455078125
        ],
        [
          " ",
          0.01450347900390625
        ],
        [
          " Stadt",
          0.011566162109375
        ],
        [
          " as",
          0.00893402099609375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.328228897415176,
      "topk": [
        [
          " Berlin",
          0.31982421875
        ],
        [
          " as",
          0.273681640625
        ],
        [
          " “",
          0.09454345703125
        ],
        [
          " after",
          0.05645751953125
        ],
        [
          ",",
          0.05303955078125
        ],
        [
          " \"",
          0.0382080078125
        ],
        [
          " ‘",
          0.02545166015625
        ],
        [
          ":",
          0.0201263427734375
        ],
        [
          " by",
          0.011199951171875
        ],
        [
          " '",
          0.01052093505859375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 3.3375909449975443,
      "topk": [
        [
          " Berlin",
          0.42626953125
        ],
        [
          " “",
          0.1593017578125
        ],
        [
          ",",
          0.11651611328125
        ],
        [
          " ‘",
          0.05010986328125
        ],
        [
          " \"",
          0.040283203125
        ],
        [
          " as",
          0.037261962890625
        ],
        [
          " the",
          0.0215606689453125
        ],
        [
          ":",
          0.015167236328125
        ],
        [
          " Germany",
          0.01505279541015625
        ],
        [
          " '",
          0.0111846923828125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.5397988560710525,
      "topk": [
        [
          " called",
          0.5537109375
        ],
        [
          " known",
          0.171630859375
        ],
        [
          " referred",
          0.08905029296875
        ],
        [
          " Berlin",
          0.07733154296875
        ],
        [
          " named",
          0.01430511474609375
        ],
        [
          " “",
          0.0134429931640625
        ],
        [
          " \"",
          0.01030731201171875
        ],
        [
          " the",
          0.005390167236328125
        ],
        [
          " just",
          0.005062103271484375
        ],
        [
          " ‘",
          0.004230499267578125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 2.292225702570419,
      "topk": [
        [
          " Berlin",
          0.75146484375
        ],
        [
          " what",
          0.0362548828125
        ],
        [
          "?\n",
          0.026123046875
        ],
        [
          "...\n",
          0.01511383056640625
        ],
        [
          "\n",
          0.01282501220703125
        ],
        [
          " \"",
          0.012054443359375
        ],
        [
          "...",
          0.00861358642578125
        ],
        [
          " by",
          0.00748443603515625
        ],
        [
          "?",
          0.00534820556640625
        ],
        [
          " __",
          0.00494384765625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.609112335917687,
      "topk": [
        [
          " Berlin",
          0.5751953125
        ],
        [
          " after",
          0.169921875
        ],
        [
          " as",
          0.08544921875
        ],
        [
          " for",
          0.029083251953125
        ],
        [
          " what",
          0.0193634033203125
        ],
        [
          " “",
          0.0131072998046875
        ],
        [
          " in",
          0.00989532470703125
        ],
        [
          " the",
          0.00859832763671875
        ],
        [
          " \"",
          0.005504608154296875
        ],
        [
          " by",
          0.004673004150390625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 0.9248951791160468,
      "topk": [
        [
          " Berlin",
          0.9140625
        ],
        [
          " the",
          0.0255279541015625
        ],
        [
          " Bon",
          0.0064544677734375
        ],
        [
          " ",
          0.006351470947265625
        ],
        [
          " a",
          0.0037937164306640625
        ],
        [
          " Ber",
          0.00356292724609375
        ],
        [
          " berlin",
          0.0034275054931640625
        ],
        [
          " Germany",
          0.002567291259765625
        ],
        [
          " Frankfurt",
          0.002429962158203125
        ],
        [
          " its",
          0.0013628005981445312
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.3075686188191917,
      "topk": [
        [
          " Berlin",
          0.70703125
        ],
        [
          " the",
          0.09722900390625
        ],
        [
          " “",
          0.0374755859375
        ],
        [
          " \"",
          0.0247650146484375
        ],
        [
          " ‘",
          0.015869140625
        ],
        [
          " a",
          0.010406494140625
        ],
        [
          " '",
          0.0093994140625
        ],
        [
          " Germany",
          0.0061187744140625
        ],
        [
          " ",
          0.005977630615234375
        ],
        [
          " Bon",
          0.00507354736328125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 2.106401372018219,
      "topk": [
        [
          " Germany",
          0.72216796875
        ],
        [
          " which",
          0.082275390625
        ],
        [
          " the",
          0.0601806640625
        ],
        [
          " what",
          0.0364990234375
        ],
        [
          " germany",
          0.008209228515625
        ],
        [
          " united",
          0.004642486572265625
        ],
        [
          " both",
          0.00412750244140625
        ],
        [
          " and",
          0.0036716461181640625
        ],
        [
          ".",
          0.00339508056640625
        ],
        [
          " a",
          0.0032405853271484375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 1.6110932293424893,
      "topk": [
        [
          " Berlin",
          0.82568359375
        ],
        [
          " \"",
          0.06170654296875
        ],
        [
          " '",
          0.01442718505859375
        ],
        [
          ":",
          0.006870269775390625
        ],
        [
          " Bon",
          0.005649566650390625
        ],
        [
          " BER",
          0.004199981689453125
        ],
        [
          " what",
          0.0036487579345703125
        ],
        [
          ".",
          0.0031948089599609375
        ],
        [
          ",",
          0.00312042236328125
        ],
        [
          " berlin",
          0.0028858184814453125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.360561635777384,
      "topk": [
        [
          " Berlin",
          0.426025390625
        ],
        [
          " \"",
          0.134033203125
        ],
        [
          " as",
          0.1259765625
        ],
        [
          " “",
          0.07177734375
        ],
        [
          " '",
          0.037811279296875
        ],
        [
          ",",
          0.0247955322265625
        ],
        [
          ":",
          0.0244140625
        ],
        [
          " ‘",
          0.0205535888671875
        ],
        [
          " after",
          0.016387939453125
        ],
        [
          " Germany",
          0.011627197265625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 0.8517545693397625,
      "topk": [
        [
          " Berlin",
          0.92529296875
        ],
        [
          " the",
          0.0147247314453125
        ],
        [
          " Bon",
          0.00907135009765625
        ],
        [
          " berlin",
          0.004352569580078125
        ],
        [
          " Ber",
          0.0027446746826171875
        ],
        [
          " Germany",
          0.0025386810302734375
        ],
        [
          " Frankfurt",
          0.002071380615234375
        ],
        [
          " ",
          0.0020389556884765625
        ],
        [
          " ",
          0.0017309188842773438
        ],
        [
          " both",
          0.0016651153564453125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.1850117235182145,
      "topk": [
        [
          " the",
          0.384521484375
        ],
        [
          " \"",
          0.150634765625
        ],
        [
          " Haupt",
          0.06683349609375
        ],
        [
          " a",
          0.04522705078125
        ],
        [
          " Berlin",
          0.042816162109375
        ],
        [
          " Stadt",
          0.0374755859375
        ],
        [
          " '",
          0.03387451171875
        ],
        [
          " “",
          0.027862548828125
        ],
        [
          " H",
          0.0099334716796875
        ],
        [
          " ‘",
          0.0094757080078125
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.0006430199962145607,
      "topk": [
        [
          " Berlin",
          0.9999599456787109
        ],
        [
          " \"",
          4.006368908449076e-05
        ],
        [
          " “",
          4.0584893779005426e-10
        ],
        [
          " '",
          1.2255575894404291e-11
        ],
        [
          ":",
          5.384724242017691e-13
        ],
        [
          " Germany",
          4.658698997590544e-15
        ],
        [
          ",",
          6.304864331898967e-16
        ],
        [
          " ‘",
          3.8240935589196814e-16
        ],
        [
          " Deutschland",
          1.0741092248438621e-18
        ],
        [
          " as",
          1.0741092248438621e-18
        ],
        [
          " Bon",
          2.7157730207520753e-19
        ],
        [
          " BER",
          1.967299483588778e-20
        ],
        [
          " „",
          1.532134303608835e-20
        ],
        [
          " berlin",
          2.4764646026553358e-22
        ],
        [
          " the",
          8.03990373858937e-23
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 13.876149140207955,
      "topk": [
        [
          " Berlin",
          0.036334145814180374
        ],
        [
          " \"",
          0.021866274997591972
        ],
        [
          " “",
          0.012265867553651333
        ],
        [
          " '",
          0.010328896343708038
        ],
        [
          ":",
          0.008834772743284702
        ],
        [
          " Germany",
          0.006934492848813534
        ],
        [
          ",",
          0.0063139270059764385
        ],
        [
          " ‘",
          0.006143620237708092
        ],
        [
          " Deutschland",
          0.004583420231938362
        ],
        [
          " as",
          0.004583420231938362
        ],
        [
          " Bon",
          0.004272216930985451
        ],
        [
          " BER",
          0.003740878077223897
        ],
        [
          " „",
          0.0036972956731915474
        ],
        [
          " berlin",
          0.003005879931151867
        ],
        [
          " the",
          0.002845910144969821
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 128256,
    "n_ctx": 8192
  }
}