{
  "diagnostics": {
    "type": "diagnostics",
    "model": "mistralai/Mistral-7B-v0.1",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 25,
    "delta_layers": null
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 3.6110863555321258,
    "topk": [
      [
        "Berlin",
        0.3821752667427063
      ],
      [
        "\"",
        0.17429740726947784
      ],
      [
        "“",
        0.10482153296470642
      ],
      [
        "'",
        0.05756385996937752
      ],
      [
        "Germany",
        0.05137428641319275
      ],
      [
        "‘",
        0.04007013514637947
      ],
      [
        ",",
        0.017412271350622177
      ],
      [
        ":",
        0.015777762979269028
      ],
      [
        "B",
        0.013179570436477661
      ],
      [
        "Deutschland",
        0.012462848797440529
      ],
      [
        "Bon",
        0.012185949832201004
      ],
      [
        "as",
        0.00930801872164011
      ],
      [
        "the",
        0.006822093389928341
      ],
      [
        "by",
        0.006436503957957029
      ],
      [
        "Frankfurt",
        0.005885427352041006
      ],
      [
        "„",
        0.004204228520393372
      ],
      [
        "German",
        0.004186759702861309
      ],
      [
        "«",
        0.0035098812077194452
      ],
      [
        ".",
        0.0031514205038547516
      ],
      [
        "and",
        0.0025785171892493963
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9503728609975142,
      "topk": [
        [
          "Germany",
          0.8966183662414551
        ],
        [
          "the",
          0.05393940210342407
        ],
        [
          "both",
          0.004360676743090153
        ],
        [
          "a",
          0.003801890416070819
        ],
        [
          "Europe",
          0.003114319872111082
        ],
        [
          "Berlin",
          0.002840860513970256
        ],
        [
          "German",
          0.002442208817228675
        ],
        [
          "modern",
          0.0016167728463187814
        ],
        [
          "and",
          0.0014727202942594886
        ],
        [
          "one",
          0.0011094921501353383
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.3994304000551474,
      "topk": [
        [
          "Berlin",
          0.5391674041748047
        ],
        [
          "\"",
          0.24477697908878326
        ],
        [
          "'",
          0.05746661499142647
        ],
        [
          ",",
          0.046301789581775665
        ],
        [
          "by",
          0.018246354535222054
        ],
        [
          "“",
          0.015410920605063438
        ],
        [
          "the",
          0.010919270105659962
        ],
        [
          ":",
          0.006851740647107363
        ],
        [
          "and",
          0.006402172613888979
        ],
        [
          "‘",
          0.003403113689273596
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.76032877236725,
      "topk": [
        [
          "Berlin",
          0.3455064594745636
        ],
        [
          "“",
          0.11641714721918106
        ],
        [
          ",",
          0.09748692065477371
        ],
        [
          "after",
          0.08160366117954254
        ],
        [
          "as",
          0.05444967746734619
        ],
        [
          "‘",
          0.048443738371133804
        ],
        [
          "because",
          0.03298510983586311
        ],
        [
          "\"",
          0.027734609320759773
        ],
        [
          "and",
          0.023925378918647766
        ],
        [
          "for",
          0.023722736164927483
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.2534061225829674,
      "topk": [
        [
          "Berlin",
          0.6334107518196106
        ],
        [
          "“",
          0.12554343044757843
        ],
        [
          "‘",
          0.05854514241218567
        ],
        [
          ",",
          0.04402599111199379
        ],
        [
          "\"",
          0.04394771531224251
        ],
        [
          "'",
          0.015353316441178322
        ],
        [
          "as",
          0.015274904668331146
        ],
        [
          "the",
          0.006588722579181194
        ],
        [
          ":",
          0.005037037655711174
        ],
        [
          "–",
          0.004944113083183765
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 3.0538701339732635,
      "topk": [
        [
          "called",
          0.4187629818916321
        ],
        [
          "known",
          0.1987573802471161
        ],
        [
          "Berlin",
          0.15429335832595825
        ],
        [
          "referred",
          0.075499027967453
        ],
        [
          "“",
          0.022590018808841705
        ],
        [
          "named",
          0.015821080654859543
        ],
        [
          "‘",
          0.0118550481274724
        ],
        [
          "not",
          0.009754262864589691
        ],
        [
          "the",
          0.008250931277871132
        ],
        [
          "\"",
          0.007500796113163233
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 1.7829527406272803,
      "topk": [
        [
          "Berlin",
          0.810565710067749
        ],
        [
          "\"",
          0.04029231518507004
        ],
        [
          "the",
          0.025490323081612587
        ],
        [
          "by",
          0.009812232106924057
        ],
        [
          "home",
          0.009162252768874168
        ],
        [
          "'",
          0.008911742828786373
        ],
        [
          "a",
          0.008473384194076061
        ],
        [
          "many",
          0.005838780663907528
        ],
        [
          ",",
          0.003433601465076208
        ],
        [
          "to",
          0.003350455779582262
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.325767822933494,
      "topk": [
        [
          "Berlin",
          0.5251378417015076
        ],
        [
          "after",
          0.281002938747406
        ],
        [
          "as",
          0.047681402415037155
        ],
        [
          "for",
          0.03774629533290863
        ],
        [
          "in",
          0.01834285445511341
        ],
        [
          "“",
          0.01274599228054285
        ],
        [
          "Bon",
          0.012123355641961098
        ],
        [
          "the",
          0.010064445436000824
        ],
        [
          "‘",
          0.006161272991448641
        ],
        [
          ",",
          0.005074300803244114
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.1924165142989323,
      "topk": [
        [
          "Berlin",
          0.8773050308227539
        ],
        [
          "the",
          0.05131449177861214
        ],
        [
          "Bon",
          0.013793155550956726
        ],
        [
          "a",
          0.004020726308226585
        ],
        [
          "its",
          0.002991496818140149
        ],
        [
          "Ber",
          0.0023043507244437933
        ],
        [
          "Frankfurt",
          0.0019688347820192575
        ],
        [
          "",
          0.001550670713186264
        ],
        [
          "least",
          0.0014481877442449331
        ],
        [
          "last",
          0.0013905147789046168
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.690349888896592,
      "topk": [
        [
          "Berlin",
          0.5754387974739075
        ],
        [
          "the",
          0.17393003404140472
        ],
        [
          "“",
          0.07071146368980408
        ],
        [
          "‘",
          0.037779878824949265
        ],
        [
          "\"",
          0.018484683707356453
        ],
        [
          "a",
          0.017169110476970673
        ],
        [
          "'",
          0.008305701427161694
        ],
        [
          "Die",
          0.006314403843134642
        ],
        [
          "The",
          0.0057955170050263405
        ],
        [
          "Deutschland",
          0.0045509799383580685
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 1.1122140389042448,
      "topk": [
        [
          "Germany",
          0.8825745582580566
        ],
        [
          "the",
          0.05476103723049164
        ],
        [
          "germ",
          0.003834469011053443
        ],
        [
          "Europe",
          0.0034003572072833776
        ],
        [
          "and",
          0.0033088906202465296
        ],
        [
          "both",
          0.002983517711982131
        ],
        [
          "Berlin",
          0.0027902289293706417
        ],
        [
          "German",
          0.0026156192179769278
        ],
        [
          "a",
          0.0024044676683843136
        ],
        [
          ".",
          0.0019447235390543938
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 1.7502099956254153,
      "topk": [
        [
          "Berlin",
          0.8026497960090637
        ],
        [
          "\"",
          0.06315690279006958
        ],
        [
          "'",
          0.030647000297904015
        ],
        [
          "the",
          0.007734740152955055
        ],
        [
          "by",
          0.007534230127930641
        ],
        [
          "simply",
          0.004886350128799677
        ],
        [
          ",",
          0.004507522564381361
        ],
        [
          "Ber",
          0.004252158105373383
        ],
        [
          ":",
          0.0039021819829940796
        ],
        [
          "both",
          0.0038856379687786102
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.6340009799677846,
      "topk": [
        [
          "Berlin",
          0.3655027449131012
        ],
        [
          "\"",
          0.15660403668880463
        ],
        [
          "“",
          0.09326566010713577
        ],
        [
          "as",
          0.07544726133346558
        ],
        [
          "'",
          0.05701574310660362
        ],
        [
          "‘",
          0.04162776842713356
        ],
        [
          ",",
          0.03257547318935394
        ],
        [
          "B",
          0.021308355033397675
        ],
        [
          "Germany",
          0.018846191465854645
        ],
        [
          ":",
          0.018694518133997917
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 0.9947270146723817,
      "topk": [
        [
          "Berlin",
          0.9112709164619446
        ],
        [
          "Bon",
          0.01866959035396576
        ],
        [
          "the",
          0.012034328654408455
        ],
        [
          "Ber",
          0.004513136111199856
        ],
        [
          "ber",
          0.0034223110415041447
        ],
        [
          "Germany",
          0.002540549961850047
        ],
        [
          "B",
          0.002498513786122203
        ],
        [
          ".",
          0.002496117725968361
        ],
        [
          ",",
          0.0022795158438384533
        ],
        [
          ".",
          0.0015522874891757965
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.194881463885929,
      "topk": [
        [
          "Berlin",
          0.3925684988498688
        ],
        [
          "the",
          0.13170331716537476
        ],
        [
          "\"",
          0.12032333016395569
        ],
        [
          "“",
          0.04304727911949158
        ],
        [
          "'",
          0.0387214794754982
        ],
        [
          "a",
          0.0271069947630167
        ],
        [
          "‘",
          0.014885909855365753
        ],
        [
          ":",
          0.014773320406675339
        ],
        [
          "Haupt",
          0.013499877415597439
        ],
        [
          "Bundes",
          0.007229968905448914
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.005017983487115803,
      "topk": [
        [
          "Berlin",
          0.9996084570884705
        ],
        [
          "\"",
          0.0003891454543918371
        ],
        [
          "“",
          2.408287627986283e-06
        ],
        [
          "'",
          6.007561115239923e-09
        ],
        [
          "Germany",
          1.9260004702204014e-09
        ],
        [
          "‘",
          1.6047517481521112e-10
        ],
        [
          ",",
          3.852588414303762e-14
        ],
        [
          ":",
          1.4376534359684945e-14
        ],
        [
          "B",
          2.3780138709556366e-15
        ],
        [
          "Deutschland",
          1.3594869274310864e-15
        ],
        [
          "Bon",
          1.0859136025554317e-15
        ],
        [
          "as",
          7.341351682627759e-17
        ],
        [
          "the",
          3.283817282739058e-18
        ],
        [
          "by",
          1.8352790667563565e-18
        ],
        [
          "Frankfurt",
          7.498657467577096e-19
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.219990608929281,
      "topk": [
        [
          "Berlin",
          0.035982757806777954
        ],
        [
          "\"",
          0.02430013194680214
        ],
        [
          "“",
          0.018844664096832275
        ],
        [
          "'",
          0.013964909128844738
        ],
        [
          "Germany",
          0.013192771933972836
        ],
        [
          "‘",
          0.011651278473436832
        ],
        [
          ",",
          0.007680524606257677
        ],
        [
          ":",
          0.0073111532256007195
        ],
        [
          "B",
          0.006682112812995911
        ],
        [
          "Deutschland",
          0.006497881840914488
        ],
        [
          "Bon",
          0.006425291765481234
        ],
        [
          "as",
          0.005615543574094772
        ],
        [
          "the",
          0.004807529505342245
        ],
        [
          "by",
          0.004669691435992718
        ],
        [
          "Frankfurt",
          0.004465315956622362
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 32000,
    "n_ctx": 2048
  }
}