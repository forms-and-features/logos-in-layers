{
  "diagnostics": {
    "type": "diagnostics",
    "model": "mistralai/Mistral-7B-v0.1",
    "device": "mps",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "prompt": "Question: What is the capital of Germany? Answer:"
  },
  "prompt": "Question: What is the capital of Germany? Answer:",
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 1.8004636701728298,
    "topk": [
      [
        "Berlin",
        0.8315027356147766
      ],
      [
        "The",
        0.021822849288582802
      ],
      [
        "Germany",
        0.019521044567227364
      ],
      [
        "It",
        0.015327813103795052
      ],
      [
        "There",
        0.008855064399540424
      ],
      [
        "That",
        0.004082494415342808
      ],
      [
        "Bon",
        0.003259647637605667
      ],
      [
        "\n",
        0.0026362482458353043
      ],
      [
        "Frankfurt",
        0.0025925226509571075
      ],
      [
        "I",
        0.002567142015323043
      ],
      [
        "",
        0.0023179128766059875
      ],
      [
        "Well",
        0.0022209964226931334
      ],
      [
        "B",
        0.0022207845468074083
      ],
      [
        "This",
        0.002128519816324115
      ],
      [
        "What",
        0.0020626229234039783
      ],
      [
        "A",
        0.0017404776299372315
      ],
      [
        "If",
        0.001732829143293202
      ],
      [
        "No",
        0.001714361715130508
      ],
      [
        "You",
        0.0016836562426760793
      ],
      [
        "(",
        0.001621106406673789
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Germany's capital is",
      "entropy": 6.6766155373726805,
      "topk": [
        [
          "a",
          0.18782828748226166
        ],
        [
          "one",
          0.08972153812646866
        ],
        [
          "the",
          0.0512482151389122
        ],
        [
          "known",
          0.04272359609603882
        ],
        [
          "home",
          0.03910921514034271
        ],
        [
          "an",
          0.028183309361338615
        ],
        [
          "not",
          0.021237006410956383
        ],
        [
          "famous",
          0.021130982786417007
        ],
        [
          "full",
          0.018002381548285484
        ],
        [
          "set",
          0.01050855964422226
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9503652937608762,
      "topk": [
        [
          "Germany",
          0.8965997695922852
        ],
        [
          "the",
          0.0539364255964756
        ],
        [
          "both",
          0.004360486287623644
        ],
        [
          "a",
          0.0038016841281205416
        ],
        [
          "Europe",
          0.0031141715589910746
        ],
        [
          "Berlin",
          0.0028407552745193243
        ],
        [
          "German",
          0.0024421114940196276
        ],
        [
          "modern",
          0.0016167068388313055
        ],
        [
          "and",
          0.0014726630179211497
        ],
        [
          "one",
          0.0011094193905591965
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Respond in one word: which city is the capital of Germany?",
      "entropy": 4.562088157083845,
      "topk": [
        [
          "\n",
          0.4531034529209137
        ],
        [
          "Berlin",
          0.14381542801856995
        ],
        [
          "If",
          0.027226965874433517
        ],
        [
          "The",
          0.02302471362054348
        ],
        [
          "You",
          0.014680871739983559
        ],
        [
          "(",
          0.014456672593951225
        ],
        [
          "",
          0.014369183219969273
        ],
        [
          "What",
          0.01104075275361538
        ],
        [
          "Bon",
          0.010858723893761635
        ],
        [
          "I",
          0.009623673744499683
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 1.1158238977246175e-14,
      "topk": [
        [
          "Berlin",
          1.0
        ],
        [
          "The",
          1.5505200150308025e-16
        ],
        [
          "Germany",
          5.0861489598758453e-17
        ],
        [
          "It",
          4.5306373733882e-18
        ],
        [
          "There",
          1.876197171343426e-20
        ],
        [
          "That",
          8.139869927992968e-24
        ],
        [
          "Bon",
          8.571705403715886e-25
        ],
        [
          "\n",
          1.0261839153594805e-25
        ],
        [
          "Frankfurt",
          8.681313805451336e-26
        ],
        [
          "I",
          7.86790515123356e-26
        ],
        [
          "",
          2.8335671092872884e-26
        ],
        [
          "Well",
          1.8485841355974578e-26
        ],
        [
          "B",
          1.8468219867355413e-26
        ],
        [
          "This",
          1.2081944023844224e-26
        ],
        [
          "What",
          8.821822258622842e-27
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.150934759093639,
      "topk": [
        [
          "Berlin",
          0.05867597088217735
        ],
        [
          "The",
          0.009505701251327991
        ],
        [
          "Germany",
          0.008990420028567314
        ],
        [
          "It",
          0.00796651653945446
        ],
        [
          "There",
          0.00605514133349061
        ],
        [
          "That",
          0.004111413843929768
        ],
        [
          "Bon",
          0.0036737853661179543
        ],
        [
          "\n",
          0.0033038596156984568
        ],
        [
          "Frankfurt",
          0.003276345320045948
        ],
        [
          "I",
          0.003260268596932292
        ],
        [
          "",
          0.003097968176007271
        ],
        [
          "Well",
          0.003032510867342353
        ],
        [
          "B",
          0.003032366046682
        ],
        [
          "This",
          0.0029687064234167337
        ],
        [
          "What",
          0.002922391053289175
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 32000,
    "n_ctx": 2048
  }
}