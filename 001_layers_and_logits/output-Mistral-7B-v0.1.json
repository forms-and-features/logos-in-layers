{
  "diagnostics": {
    "type": "diagnostics",
    "model": "mistralai/Mistral-7B-v0.1",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "The capital of Germany is ",
    "target_prediction": "first unseen token (likely 'Berlin')"
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "The capital of Germany is ",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 4.242652396885489,
    "topk": [
      [
        "1",
        0.19275081157684326
      ],
      [
        "2",
        0.1651020050048828
      ],
      [
        "7",
        0.13913077116012573
      ],
      [
        "8",
        0.13886696100234985
      ],
      [
        "3",
        0.062388963997364044
      ],
      [
        "Berlin",
        0.0404016487300396
      ],
      [
        "9",
        0.034385424107313156
      ],
      [
        "5",
        0.03214045614004135
      ],
      [
        "6",
        0.028760310262441635
      ],
      [
        "a",
        0.023624712601304054
      ],
      [
        "4",
        0.02290617860853672
      ],
      [
        "the",
        0.007163118105381727
      ],
      [
        "one",
        0.006742816884070635
      ],
      [
        "home",
        0.003994361963123083
      ],
      [
        "full",
        0.0033314041793346405
      ],
      [
        "an",
        0.003197635291144252
      ],
      [
        "located",
        0.002796487184241414
      ],
      [
        "0",
        0.0025477877352386713
      ],
      [
        "known",
        0.002330903895199299
      ],
      [
        "also",
        0.0022196825593709946
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of ",
      "entropy": 2.620135391942088,
      "topk": [
        [
          "Germany",
          0.6409004926681519
        ],
        [
          "2",
          0.14733880758285522
        ],
        [
          "3",
          0.03208450227975845
        ],
        [
          "1",
          0.027689237147569656
        ],
        [
          "the",
          0.023135114461183548
        ],
        [
          "German",
          0.009329494088888168
        ],
        [
          "Berlin",
          0.007975739426910877
        ],
        [
          "and",
          0.007563833612948656
        ],
        [
          "Europe",
          0.007478372193872929
        ],
        [
          "Deutschland",
          0.005110054276883602
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called ",
      "entropy": 5.871736731334736,
      "topk": [
        [
          "Berlin",
          0.15450121462345123
        ],
        [
          "\"",
          0.09886710345745087
        ],
        [
          "1",
          0.09336121380329132
        ],
        [
          "",
          0.07325147092342377
        ],
        [
          "2",
          0.06887484341859818
        ],
        [
          "‚",
          0.054542507976293564
        ],
        [
          "3",
          0.039003610610961914
        ],
        [
          "´",
          0.024086877703666687
        ],
        [
          "4",
          0.020149094983935356
        ],
        [
          "'",
          0.017305849120020866
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named ",
      "entropy": 4.796855482401234,
      "topk": [
        [
          "Berlin",
          0.2617006003856659
        ],
        [
          "2",
          0.1246146634221077
        ],
        [
          "1",
          0.10829911381006241
        ],
        [
          "after",
          0.05916754901409149
        ],
        [
          "“",
          0.04871536046266556
        ],
        [
          "as",
          0.03968629613518715
        ],
        [
          "3",
          0.03581229969859123
        ],
        [
          "4",
          0.020089110359549522
        ],
        [
          "‘",
          0.01997799053788185
        ],
        [
          "5",
          0.017863977700471878
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at ",
      "entropy": 4.099977653521512,
      "topk": [
        [
          "Berlin",
          0.3208252787590027
        ],
        [
          "1",
          0.170484259724617
        ],
        [
          "2",
          0.09925896674394608
        ],
        [
          "5",
          0.059684932231903076
        ],
        [
          "3",
          0.05658368021249771
        ],
        [
          "6",
          0.04055675491690636
        ],
        [
          "4",
          0.03697904199361801
        ],
        [
          "7",
          0.028715524822473526
        ],
        [
          "8",
          0.026459278538823128
        ],
        [
          "0",
          0.01685807667672634
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany, the capital city is ",
      "entropy": 4.2852504357123955,
      "topk": [
        [
          "1",
          0.2579467296600342
        ],
        [
          "8",
          0.13328300416469574
        ],
        [
          "2",
          0.1283174306154251
        ],
        [
          "7",
          0.07181321084499359
        ],
        [
          "3",
          0.06249101459980011
        ],
        [
          "5",
          0.053079862147569656
        ],
        [
          "Berlin",
          0.050964780151844025
        ],
        [
          "9",
          0.041066017001867294
        ],
        [
          "4",
          0.039325036108493805
        ],
        [
          "6",
          0.038635242730379105
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 1.1156779897028601e-14,
      "topk": [
        [
          "Berlin",
          1.0
        ],
        [
          "The",
          1.5502836398989593e-16
        ],
        [
          "Germany",
          5.0857615084769255e-17
        ],
        [
          "It",
          4.529808124824115e-18
        ],
        [
          "There",
          1.8761115452253296e-20
        ],
        [
          "That",
          8.139622225668728e-24
        ],
        [
          "Bon",
          8.570070489489815e-25
        ],
        [
          "\n",
          1.0258943787553611e-25
        ],
        [
          "Frankfurt",
          8.681711933689439e-26
        ],
        [
          "I",
          7.865865206236465e-26
        ],
        [
          "",
          2.833632128682211e-26
        ],
        [
          "Well",
          1.8485983104418485e-26
        ],
        [
          "B",
          1.8467797703511603e-26
        ],
        [
          "This",
          1.2082221357756216e-26
        ],
        [
          "What",
          8.820813071331983e-27
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.15093888667726,
      "topk": [
        [
          "Berlin",
          0.05867626145482063
        ],
        [
          "The",
          0.009505677036941051
        ],
        [
          "Germany",
          0.008990426547825336
        ],
        [
          "It",
          0.0079664820805192
        ],
        [
          "There",
          0.006055154837667942
        ],
        [
          "That",
          0.004111426882445812
        ],
        [
          "Bon",
          0.003673766739666462
        ],
        [
          "\n",
          0.003303829114884138
        ],
        [
          "Frankfurt",
          0.003276368137449026
        ],
        [
          "I",
          0.003260241588577628
        ],
        [
          "",
          0.003097986802458763
        ],
        [
          "Well",
          0.0030325260013341904
        ],
        [
          "B",
          0.0030323767568916082
        ],
        [
          "This",
          0.002968722954392433
        ],
        [
          "What",
          0.0029223875608295202
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 32000,
    "n_ctx": 2048
  }
}