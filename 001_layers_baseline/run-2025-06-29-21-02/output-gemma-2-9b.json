{
  "diagnostics": {
    "type": "diagnostics",
    "model": "google/gemma-2-9b",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": 0,
    "L_copy_H": 0,
    "L_semantic": 42,
    "delta_layers": 42
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.9367000737669406,
    "topk": [
      [
        " Berlin",
        0.3943387567996979
      ],
      [
        " \"",
        0.2660205662250519
      ],
      [
        " “",
        0.09163139015436172
      ],
      [
        " '",
        0.04478210583329201
      ],
      [
        ",",
        0.03912675753235817
      ],
      [
        ":",
        0.03422780707478523
      ],
      [
        " ",
        0.03074593096971512
      ],
      [
        " ‘",
        0.012965072877705097
      ],
      [
        " as",
        0.011465054005384445
      ],
      [
        " by",
        0.008055418729782104
      ],
      [
        " BERLIN",
        0.005165576469153166
      ],
      [
        " berlin",
        0.0040166680701076984
      ],
      [
        " and",
        0.003859109478071332
      ],
      [
        " the",
        0.003666569944471121
      ],
      [
        ".",
        0.0026918635703623295
      ],
      [
        " „",
        0.0026887436397373676
      ],
      [
        " -",
        0.002261304995045066
      ],
      [
        " (",
        0.00223056529648602
      ],
      [
        "\n\n",
        0.0021014977246522903
      ],
      [
        " Germany",
        0.0020550847984850407
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9620395620927691,
      "topk": [
        [
          " Germany",
          0.8765909671783447
        ],
        [
          " the",
          0.06993549317121506
        ],
        [
          " modern",
          0.007701548282057047
        ],
        [
          " a",
          0.005294736474752426
        ],
        [
          " ",
          0.00339330080896616
        ],
        [
          " Europe",
          0.003080132883042097
        ],
        [
          " German",
          0.002838731510564685
        ],
        [
          " both",
          0.002427628031000495
        ],
        [
          " Berlin",
          0.0018704056274145842
        ],
        [
          " germany",
          0.0015241163782775402
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.4479018183916703,
      "topk": [
        [
          " Berlin",
          0.5512162446975708
        ],
        [
          " \"",
          0.1880049705505371
        ],
        [
          ",",
          0.061215590685606
        ],
        [
          " '",
          0.05240602791309357
        ],
        [
          " ",
          0.03377880901098251
        ],
        [
          " “",
          0.01542938593775034
        ],
        [
          " by",
          0.015068544074892998
        ],
        [
          ":",
          0.015002354979515076
        ],
        [
          " and",
          0.010529917664825916
        ],
        [
          " the",
          0.006633311975747347
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.269438348044234,
      "topk": [
        [
          " Berlin",
          0.4367222785949707
        ],
        [
          " as",
          0.09867377579212189
        ],
        [
          " “",
          0.08626546710729599
        ],
        [
          " after",
          0.06995684653520584
        ],
        [
          ",",
          0.06669537723064423
        ],
        [
          " ‘",
          0.03148892521858215
        ],
        [
          " \"",
          0.028410132974386215
        ],
        [
          ":",
          0.023328566923737526
        ],
        [
          " ",
          0.022950338199734688
        ],
        [
          " for",
          0.0179197546094656
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.622444602995223,
      "topk": [
        [
          " Berlin",
          0.5747594833374023
        ],
        [
          " “",
          0.10203713923692703
        ],
        [
          " \"",
          0.08042188733816147
        ],
        [
          ",",
          0.05430440232157707
        ],
        [
          " ",
          0.030597276985645294
        ],
        [
          " ‘",
          0.02733582630753517
        ],
        [
          " as",
          0.026823317632079124
        ],
        [
          " '",
          0.020002445206046104
        ],
        [
          " Germany",
          0.009822736494243145
        ],
        [
          ":",
          0.009499389678239822
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.8540417721092575,
      "topk": [
        [
          " called",
          0.3952074944972992
        ],
        [
          " known",
          0.2401411086320877
        ],
        [
          " Berlin",
          0.11895694583654404
        ],
        [
          " referred",
          0.10493209213018417
        ],
        [
          " named",
          0.02119293436408043
        ],
        [
          " “",
          0.01813422702252865
        ],
        [
          " the",
          0.01608087494969368
        ],
        [
          " ",
          0.00976461824029684
        ],
        [
          " \"",
          0.00911792367696762
        ],
        [
          " ‘",
          0.0066075753420591354
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 2.6761955447479324,
      "topk": [
        [
          " Berlin",
          0.6645329594612122
        ],
        [
          " the",
          0.04546653479337692
        ],
        [
          " ",
          0.04273165762424469
        ],
        [
          " \"",
          0.034147169440984726
        ],
        [
          "...",
          0.02094309777021408
        ],
        [
          ":",
          0.017930807545781136
        ],
        [
          "\n\n",
          0.015544363297522068
        ],
        [
          " a",
          0.012421208433806896
        ],
        [
          " by",
          0.010814687237143517
        ],
        [
          " ...",
          0.007649347186088562
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.496544531448453,
      "topk": [
        [
          " Berlin",
          0.43033695220947266
        ],
        [
          " after",
          0.3381440341472626
        ],
        [
          " as",
          0.06390619277954102
        ],
        [
          " for",
          0.03723074868321419
        ],
        [
          " ",
          0.017808226868510246
        ],
        [
          " “",
          0.016987187787890434
        ],
        [
          " the",
          0.013166476041078568
        ],
        [
          " in",
          0.013061796315014362
        ],
        [
          " by",
          0.007156467996537685
        ],
        [
          " ‘",
          0.006200120318681002
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.604349445636857,
      "topk": [
        [
          " Berlin",
          0.8049203753471375
        ],
        [
          " the",
          0.06322108209133148
        ],
        [
          " Bonn",
          0.025339528918266296
        ],
        [
          " ",
          0.017819270491600037
        ],
        [
          " Frankfurt",
          0.009331515058875084
        ],
        [
          " a",
          0.007633773144334555
        ],
        [
          " berlin",
          0.005241838749498129
        ],
        [
          "\n\n",
          0.0049260463565588
        ],
        [
          ":",
          0.004345736466348171
        ],
        [
          " Munich",
          0.0037609643768519163
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.993239370238089,
      "topk": [
        [
          " Berlin",
          0.42651134729385376
        ],
        [
          " the",
          0.24033698439598083
        ],
        [
          " “",
          0.07151305675506592
        ],
        [
          " ",
          0.05543254688382149
        ],
        [
          " \"",
          0.03964495658874512
        ],
        [
          " a",
          0.03351404145359993
        ],
        [
          " ‘",
          0.02439745143055916
        ],
        [
          " Hauptstadt",
          0.01525548379868269
        ],
        [
          " '",
          0.01186746172606945
        ],
        [
          " Bonn",
          0.004929706454277039
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 2.2215547636605244,
      "topk": [
        [
          " Germany",
          0.7139976620674133
        ],
        [
          " which",
          0.07763934880495071
        ],
        [
          " the",
          0.044778838753700256
        ],
        [
          " what",
          0.018608899787068367
        ],
        [
          " ",
          0.015495147556066513
        ],
        [
          " germany",
          0.012269739992916584
        ],
        [
          " this",
          0.006326483096927404
        ],
        [
          " .",
          0.00561766792088747
        ],
        [
          " ________",
          0.0054529160261154175
        ],
        [
          "...",
          0.004933774936944246
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 2.4053183980900865,
      "topk": [
        [
          " Berlin",
          0.6572591662406921
        ],
        [
          " \"",
          0.1284118890762329
        ],
        [
          " ",
          0.0327274389564991
        ],
        [
          ":",
          0.021342791616916656
        ],
        [
          " '",
          0.020834513008594513
        ],
        [
          " BERLIN",
          0.00958646647632122
        ],
        [
          ",",
          0.008529877290129662
        ],
        [
          " simply",
          0.008374553173780441
        ],
        [
          "...",
          0.00814103614538908
        ],
        [
          " berlin",
          0.007984061725437641
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.5361827516018467,
      "topk": [
        [
          " Berlin",
          0.36225417256355286
        ],
        [
          " \"",
          0.17540135979652405
        ],
        [
          " as",
          0.07972191274166107
        ],
        [
          " “",
          0.06356276571750641
        ],
        [
          ",",
          0.05878202244639397
        ],
        [
          ":",
          0.04538390785455704
        ],
        [
          " '",
          0.03304613009095192
        ],
        [
          " ",
          0.03045659139752388
        ],
        [
          ".",
          0.01922551728785038
        ],
        [
          " by",
          0.010970385745167732
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 1.4779146800285545,
      "topk": [
        [
          " Berlin",
          0.8347237706184387
        ],
        [
          " the",
          0.04124448075890541
        ],
        [
          " Bonn",
          0.015181999653577805
        ],
        [
          " berlin",
          0.01516746822744608
        ],
        [
          " ",
          0.014117696322500706
        ],
        [
          " a",
          0.009073767811059952
        ],
        [
          ":",
          0.005125666968524456
        ],
        [
          " \"",
          0.004519297741353512
        ],
        [
          " Frankfurt",
          0.0032497309148311615
        ],
        [
          " (",
          0.002648500958457589
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 3.196627772974955,
      "topk": [
        [
          " Berlin",
          0.47418785095214844
        ],
        [
          " \"",
          0.16301514208316803
        ],
        [
          " ",
          0.06008234992623329
        ],
        [
          " the",
          0.05907159671187401
        ],
        [
          " “",
          0.05076473206281662
        ],
        [
          " '",
          0.02965036779642105
        ],
        [
          " Hauptstadt",
          0.016913678497076035
        ],
        [
          " Bonn",
          0.009871911257505417
        ],
        [
          " simply",
          0.009776553139090538
        ],
        [
          " ‘",
          0.008121992461383343
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.1366272529181927,
      "topk": [
        [
          " Berlin",
          0.980853796005249
        ],
        [
          " \"",
          0.019145794212818146
        ],
        [
          " “",
          4.5014675720267405e-07
        ],
        [
          " '",
          3.499154299646534e-10
        ],
        [
          ",",
          9.071022405438001e-11
        ],
        [
          ":",
          2.3807320698177037e-11
        ],
        [
          " ",
          8.143158890250302e-12
        ],
        [
          " ‘",
          1.447668245317061e-15
        ],
        [
          " as",
          4.2333176750508953e-16
        ],
        [
          " by",
          1.2410829313565965e-17
        ],
        [
          " BERLIN",
          1.4591752933710388e-19
        ],
        [
          " berlin",
          1.1791764977911715e-20
        ],
        [
          " and",
          7.902977276385392e-21
        ],
        [
          " the",
          4.7371199847330565e-21
        ],
        [
          ".",
          2.1549968418018075e-22
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 9.00197369763182,
      "topk": [
        [
          " Berlin",
          0.0893525555729866
        ],
        [
          " \"",
          0.07338881492614746
        ],
        [
          " “",
          0.0430719368159771
        ],
        [
          " '",
          0.030110955238342285
        ],
        [
          ",",
          0.02814551070332527
        ],
        [
          ":",
          0.026324599981307983
        ],
        [
          " ",
          0.02494974434375763
        ],
        [
          " ‘",
          0.016201667487621307
        ],
        [
          " as",
          0.015235626138746738
        ],
        [
          " by",
          0.01277074683457613
        ],
        [
          " BERLIN",
          0.010226608254015446
        ],
        [
          " berlin",
          0.00901789590716362
        ],
        [
          " and",
          0.00883925799280405
        ],
        [
          " the",
          0.008615931496024132
        ],
        [
          ".",
          0.007382420357316732
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 42,
    "d_model": 3584,
    "n_heads": 16,
    "d_vocab": 256000,
    "n_ctx": 8192
  }
}