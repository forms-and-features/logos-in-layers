{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 1.413084864616394,
      "topk": [
        [
          " Germany",
          0.83984375
        ],
        [
          " the",
          0.0537109375
        ],
        [
          " which",
          0.02880859375
        ],
        [
          " what",
          0.01202392578125
        ],
        [
          " Europe",
          0.00604248046875
        ],
        [
          ":",
          0.004425048828125
        ],
        [
          " both",
          0.0038909912109375
        ],
        [
          " ",
          0.0030364990234375
        ],
        [
          " germ",
          0.0030364990234375
        ],
        [
          " a",
          0.0022125244140625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 3.5449302196502686,
      "topk": [
        [
          " Berlin",
          0.46875
        ],
        [
          " \"",
          0.1259765625
        ],
        [
          ":",
          0.0595703125
        ],
        [
          " ",
          0.049560546875
        ],
        [
          " '",
          0.04638671875
        ],
        [
          ",",
          0.031982421875
        ],
        [
          ".",
          0.02490234375
        ],
        [
          " “",
          0.01416015625
        ],
        [
          "?",
          0.01251220703125
        ],
        [
          "\n",
          0.01171875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.760241746902466,
      "topk": [
        [
          " Berlin",
          0.4375
        ],
        [
          " as",
          0.091796875
        ],
        [
          " ",
          0.0673828125
        ],
        [
          " \"",
          0.0673828125
        ],
        [
          " “",
          0.040771484375
        ],
        [
          ":",
          0.035888671875
        ],
        [
          " after",
          0.03173828125
        ],
        [
          ",",
          0.0218505859375
        ],
        [
          "\n",
          0.01806640625
        ],
        [
          " enough",
          0.0169677734375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 3.0378713607788086,
      "topk": [
        [
          " Berlin",
          0.546875
        ],
        [
          ",",
          0.0791015625
        ],
        [
          " “",
          0.06982421875
        ],
        [
          " \"",
          0.06982421875
        ],
        [
          " as",
          0.051025390625
        ],
        [
          ":",
          0.02001953125
        ],
        [
          " '",
          0.0166015625
        ],
        [
          " enough",
          0.0120849609375
        ],
        [
          " ‘",
          0.01068115234375
        ],
        [
          " ",
          0.01007080078125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 3.446749687194824,
      "topk": [
        [
          " called",
          0.37890625
        ],
        [
          " known",
          0.158203125
        ],
        [
          " referred",
          0.1396484375
        ],
        [
          " Berlin",
          0.08447265625
        ],
        [
          " \"",
          0.04248046875
        ],
        [
          " named",
          0.0400390625
        ],
        [
          " “",
          0.0242919921875
        ],
        [
          " the",
          0.0242919921875
        ],
        [
          " '",
          0.01300048828125
        ],
        [
          " ‘",
          0.005767822265625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 3.4780051708221436,
      "topk": [
        [
          " Berlin",
          0.515625
        ],
        [
          " ",
          0.0791015625
        ],
        [
          ":",
          0.0791015625
        ],
        [
          ".",
          0.05419921875
        ],
        [
          "?",
          0.044921875
        ],
        [
          "\n",
          0.025634765625
        ],
        [
          " (",
          0.01373291015625
        ],
        [
          " \"",
          0.0113525390625
        ],
        [
          "…",
          0.01068115234375
        ],
        [
          " what",
          0.00946044921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 3.9493088722229004,
      "topk": [
        [
          " after",
          0.333984375
        ],
        [
          " Berlin",
          0.21484375
        ],
        [
          " ",
          0.0791015625
        ],
        [
          ":",
          0.048095703125
        ],
        [
          " for",
          0.045166015625
        ],
        [
          "\n",
          0.02734375
        ],
        [
          " as",
          0.02734375
        ],
        [
          "?",
          0.022705078125
        ],
        [
          " what",
          0.018798828125
        ],
        [
          ".",
          0.0177001953125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 2.6761398315429688,
      "topk": [
        [
          " Berlin",
          0.70703125
        ],
        [
          " Bon",
          0.04248046875
        ],
        [
          "Ber",
          0.033203125
        ],
        [
          " the",
          0.0213623046875
        ],
        [
          ":",
          0.018798828125
        ],
        [
          " ",
          0.0137939453125
        ],
        [
          "\n",
          0.0107421875
        ],
        [
          "?",
          0.00946044921875
        ],
        [
          ".",
          0.00787353515625
        ],
        [
          " Frankfurt",
          0.00738525390625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 4.703057289123535,
      "topk": [
        [
          " Berlin",
          0.314453125
        ],
        [
          " the",
          0.130859375
        ],
        [
          ":",
          0.07470703125
        ],
        [
          " ",
          0.06982421875
        ],
        [
          "\n",
          0.045166015625
        ],
        [
          "?",
          0.037353515625
        ],
        [
          " A",
          0.02734375
        ],
        [
          " \"",
          0.024169921875
        ],
        [
          ".",
          0.024169921875
        ],
        [
          " (",
          0.018798828125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 0.978035569190979,
      "topk": [
        [
          " Germany",
          0.90234375
        ],
        [
          " the",
          0.0240478515625
        ],
        [
          " ",
          0.00885009765625
        ],
        [
          " which",
          0.00732421875
        ],
        [
          ":",
          0.006072998046875
        ],
        [
          " this",
          0.00537109375
        ],
        [
          ".",
          0.005035400390625
        ],
        [
          " germ",
          0.0032501220703125
        ],
        [
          "\n",
          0.00286865234375
        ],
        [
          "G",
          0.0022430419921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 3.622164487838745,
      "topk": [
        [
          " Berlin",
          0.412109375
        ],
        [
          ":",
          0.142578125
        ],
        [
          " ",
          0.1337890625
        ],
        [
          ".",
          0.07177734375
        ],
        [
          "\n",
          0.033935546875
        ],
        [
          " \"",
          0.028076171875
        ],
        [
          "?",
          0.0159912109375
        ],
        [
          " (",
          0.00970458984375
        ],
        [
          " '",
          0.008544921875
        ],
        [
          " :",
          0.008544921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.5205254554748535,
      "topk": [
        [
          " Berlin",
          0.4375
        ],
        [
          " \"",
          0.11083984375
        ],
        [
          ":",
          0.08642578125
        ],
        [
          " as",
          0.0810546875
        ],
        [
          " ",
          0.04345703125
        ],
        [
          " '",
          0.0263671875
        ],
        [
          ".",
          0.0247802734375
        ],
        [
          " after",
          0.0247802734375
        ],
        [
          ",",
          0.023193359375
        ],
        [
          " “",
          0.0159912109375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 1.2176010608673096,
      "topk": [
        [
          " Berlin",
          0.8671875
        ],
        [
          " Bon",
          0.04052734375
        ],
        [
          " the",
          0.0262451171875
        ],
        [
          ":",
          0.004852294921875
        ],
        [
          " Frankfurt",
          0.0042724609375
        ],
        [
          " Ber",
          0.0035400390625
        ],
        [
          " ber",
          0.0035400390625
        ],
        [
          ".",
          0.0031280517578125
        ],
        [
          " Munich",
          0.002593994140625
        ],
        [
          "Ber",
          0.002593994140625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.25101900100708,
      "topk": [
        [
          " Berlin",
          0.431640625
        ],
        [
          " \"",
          0.0751953125
        ],
        [
          ":",
          0.06640625
        ],
        [
          " ",
          0.06640625
        ],
        [
          " the",
          0.058349609375
        ],
        [
          ".",
          0.0294189453125
        ],
        [
          " “",
          0.0201416015625
        ],
        [
          " '",
          0.01385498046875
        ],
        [
          "\n",
          0.01226806640625
        ],
        [
          " what",
          0.011474609375
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 7.137314241845161e-06,
      "topk": [
        [
          " Berlin",
          0.9999996423721313
        ],
        [
          " \"",
          3.0590220490012143e-07
        ],
        [
          ":",
          3.775132983996343e-11
        ],
        [
          " ",
          5.1090871984460495e-12
        ],
        [
          " '",
          2.543664877254631e-13
        ],
        [
          ".",
          1.2664161542087337e-14
        ],
        [
          " “",
          2.3195219049038725e-16
        ],
        [
          "\n",
          8.533044321353304e-17
        ],
        [
          ",",
          4.248352476777435e-18
        ],
        [
          " (",
          1.2828913433616538e-19
        ],
        [
          " as",
          8.644054566792437e-22
        ],
        [
          " _",
          8.644054566792437e-22
        ],
        [
          " -",
          7.095471889794084e-23
        ],
        [
          " ‘",
          7.095471889794084e-23
        ],
        [
          " __",
          2.6102780998204535e-23
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.487959861755371,
      "topk": [
        [
          " Berlin",
          0.048772841691970825
        ],
        [
          " \"",
          0.023769984021782875
        ],
        [
          ":",
          0.015347055159509182
        ],
        [
          " ",
          0.013543728739023209
        ],
        [
          " '",
          0.011584565043449402
        ],
        [
          ".",
          0.00990880373865366
        ],
        [
          " “",
          0.008214686997234821
        ],
        [
          "\n",
          0.007961947470903397
        ],
        [
          ",",
          0.006810214836150408
        ],
        [
          " (",
          0.005645866505801678
        ],
        [
          " as",
          0.004397005308419466
        ],
        [
          " _",
          0.004397005308419466
        ],
        [
          " -",
          0.0038803431671112776
        ],
        [
          " ‘",
          0.0038803431671112776
        ],
        [
          " __",
          0.003760957857593894
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "01-ai/Yi-34B",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": true,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "surface_diagnostics_config": {
      "delta": 0.05,
      "gamma": 0.02,
      "K": 50,
      "tau": 0.33
    },
    "prism_summary": {
      "mode": "auto",
      "artifact_path": "/home/kkonstant/logos-in-layers/001_layers_baseline/prisms/Yi-34B",
      "present": true,
      "compatible": true,
      "k": 512,
      "layers": [
        "embed",
        14,
        29,
        44
      ],
      "error": null,
      "metrics": {
        "rank_milestones": {
          "baseline": {
            "le_10": 43,
            "le_5": 44,
            "le_1": 44
          },
          "prism": {
            "le_10": null,
            "le_5": null,
            "le_1": null
          },
          "delta": {
            "le_10": null,
            "le_5": null,
            "le_1": null
          }
        },
        "kl_bits_at_percentiles": {
          "baseline": {
            "p25": 13.119241111009872,
            "p50": 13.53785513837719,
            "p75": 11.162317944041112
          },
          "prism": {
            "p25": 12.180859740343768,
            "p50": 12.174775682086844,
            "p75": 12.172150538904075
          },
          "delta": {
            "p25": 0.9383813706661037,
            "p50": 1.363079456290345,
            "p75": -1.0098325948629636
          }
        },
        "first_kl_le_1.0": {
          "baseline": 60,
          "prism": null,
          "delta": null
        }
      }
    },
    "copy_soft_config": {
      "threshold": 0.5,
      "window_ks": [
        1,
        2,
        3
      ],
      "extra_thresholds": []
    },
    "tau_norm_per_layer": [
      0.39108169078826904,
      0.19999998807907104,
      0.19999998807907104,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      1.0,
      0.4472135901451111,
      0.4472135901451111,
      0.5114020705223083,
      0.4472135901451111,
      0.4472135901451111,
      0.5848035216331482,
      0.5848035216331482,
      0.6687402725219727,
      0.6687402725219727,
      0.6687402725219727,
      0.6687402725219727,
      0.6687402725219727,
      0.7647244930267334,
      0.6687402725219727,
      0.6687402725219727,
      0.6687402725219727,
      0.5848035216331482,
      0.5848035216331482,
      0.5114020705223083,
      0.7647244930267334,
      1.0,
      1.0
    ],
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 44,
    "delta_layers": null,
    "copy_thresh": 0.95,
    "copy_window_k": 1,
    "copy_match_level": "id_subsequence",
    "first_kl_below_0.5": 60,
    "first_kl_below_1.0": 60,
    "first_rank_le_1": 44,
    "first_rank_le_5": 44,
    "first_rank_le_10": 43,
    "copy_soft_threshold": 0.5,
    "copy_soft_window_ks": [
      1,
      2,
      3
    ],
    "L_copy_soft": {
      "1": null,
      "2": null,
      "3": null
    },
    "delta_layers_soft": {
      "1": null,
      "2": null,
      "3": null
    },
    "copy_detector": {
      "strict": {
        "thresh": 0.95,
        "k": 1,
        "L_copy_strict": null
      },
      "soft": {
        "thresh": 0.5,
        "window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "k1": null,
          "k2": null,
          "k3": null
        }
      },
      "deltas": {
        "Δ_sem_minus_copy_strict": null,
        "Δ_sem_minus_copy_soft": {
          "k1": null,
          "k2": null,
          "k3": null
        }
      }
    },
    "copy_thresholds": {
      "tau_list": [
        0.7,
        0.8,
        0.9,
        0.95
      ],
      "L_copy_strict": {
        "0.7": null,
        "0.8": null,
        "0.9": null,
        "0.95": null
      },
      "L_copy_strict_frac": {
        "0.7": null,
        "0.8": null,
        "0.9": null,
        "0.95": null
      },
      "norm_only_flags": {
        "0.7": null,
        "0.8": null,
        "0.9": null,
        "0.95": null
      },
      "stability": "none"
    },
    "L_surface_to_meaning_norm": 51,
    "answer_mass_at_L_surface_norm": 0.05973146855831146,
    "echo_mass_at_L_surface_norm": 0.006328392370051006,
    "L_geom_norm": 46,
    "cos_to_answer_at_L_geom_norm": 0.12475081533193588,
    "cos_to_prompt_max_at_L_geom_norm": 0.09629051387310028,
    "L_topk_decay_norm": 0,
    "topk_prompt_mass_at_L_norm": 0.0,
    "topk_prompt_tau_norm": 0.33,
    "surface_delta_norm": 0.05,
    "geom_gamma_norm": 0.02,
    "cos_milestones": {
      "norm": {
        "ge_0.2": 1,
        "ge_0.4": 44,
        "ge_0.6": 51
      }
    },
    "depth_fractions": {
      "L_semantic_frac": 0.733,
      "first_rank_le_5_frac": 0.733,
      "L_copy_strict_frac": null,
      "L_copy_soft_k1_frac": null,
      "L_copy_soft_k2_frac": null,
      "L_copy_soft_k3_frac": null
    },
    "raw_lens_window": {
      "radius": 4,
      "center_layers": [
        44,
        60
      ],
      "layers_checked": [
        40,
        41,
        42,
        43,
        44,
        45,
        46,
        47,
        48,
        56,
        57,
        58,
        59,
        60
      ],
      "norm_only_semantics_layers": [
        44,
        45,
        46,
        47,
        48,
        56,
        60
      ],
      "max_kl_norm_vs_raw_bits_window": 90.46568661414425,
      "mode": "window"
    },
    "raw_lens_full": {
      "pct_layers_kl_ge_1.0": 0.6557377049180327,
      "pct_layers_kl_ge_0.5": 0.819672131147541,
      "n_norm_only_semantics_layers": 14,
      "earliest_norm_only_semantic": 44,
      "max_kl_norm_vs_raw_bits": 90.46568661414425,
      "mode": "full",
      "score": {
        "lens_artifact_score": 0.7934426229508196,
        "tier": "high"
      }
    },
    "gold_alignment": "ok",
    "last_layer_consistency": {
      "kl_to_final_bits": 0.0002783696239154555,
      "top1_agree": true,
      "p_top1_lens": 0.5555136799812317,
      "p_top1_model": 0.5626916289329529,
      "p_answer_lens": 0.5555136799812317,
      "answer_rank_lens": 1,
      "temp_est": 1.0,
      "kl_after_temp_bits": 0.0002783696239154555,
      "cfg_transform": {
        "scale": null,
        "softcap": null
      },
      "kl_after_transform_bits": {
        "scale": null,
        "softcap": null,
        "scale_then_softcap": null
      },
      "warn_high_last_layer_kl": false
    },
    "kl_to_final_bits_norm_temp@25%": {
      "layer": 15,
      "value": 12.212763210009422
    },
    "kl_to_final_bits_norm_temp@50%": {
      "layer": 30,
      "value": 12.259275573969967
    },
    "kl_to_final_bits_norm_temp@75%": {
      "layer": 45,
      "value": 6.768091045574798
    },
    "tuned_lens": {
      "status": "loaded",
      "mode": "auto",
      "path": "/home/kkonstant/logos-in-layers/001_layers_baseline/tuned_lenses/Yi-34B",
      "summaries": [
        {
          "L_copy": null,
          "L_copy_H": null,
          "L_semantic": 46,
          "delta_layers": null,
          "copy_thresh": 0.95,
          "copy_window_k": 1,
          "copy_match_level": "id_subsequence",
          "first_kl_below_0.5": 60,
          "first_kl_below_1.0": 60,
          "first_rank_le_1": 46,
          "first_rank_le_5": 44,
          "first_rank_le_10": 44,
          "copy_soft_threshold": 0.5,
          "copy_soft_window_ks": [
            1,
            2,
            3
          ],
          "L_copy_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "delta_layers_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "copy_detector": {
            "strict": {
              "thresh": 0.95,
              "k": 1,
              "L_copy_strict": null
            },
            "soft": {
              "thresh": 0.5,
              "window_ks": [
                1,
                2,
                3
              ],
              "L_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            },
            "deltas": {
              "Δ_sem_minus_copy_strict": null,
              "Δ_sem_minus_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            }
          },
          "copy_thresholds": {
            "tau_list": [
              0.7,
              0.8,
              0.9,
              0.95
            ],
            "L_copy_strict": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "L_copy_strict_frac": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "norm_only_flags": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "stability": "none"
          },
          "L_surface_to_meaning_tuned": 46,
          "answer_mass_at_L_surface_tuned": 0.2812182605266571,
          "echo_mass_at_L_surface_tuned": 0.06530000494876731,
          "L_geom_tuned": null,
          "cos_to_answer_at_L_geom_tuned": null,
          "cos_to_prompt_max_at_L_geom_tuned": null,
          "L_topk_decay_tuned": 1,
          "topk_prompt_mass_at_L_tuned": 0.07752763852477074,
          "topk_prompt_tau_tuned": 0.33,
          "surface_delta_tuned": 0.05,
          "geom_gamma_tuned": 0.02,
          "cos_milestones": {
            "tuned": {
              "ge_0.2": 1,
              "ge_0.4": 1,
              "ge_0.6": 1
            }
          }
        },
        {
          "L_copy": null,
          "L_copy_H": null,
          "L_semantic": 44,
          "delta_layers": null,
          "copy_thresh": 0.95,
          "copy_window_k": 1,
          "copy_match_level": "id_subsequence",
          "first_kl_below_0.5": 60,
          "first_kl_below_1.0": 60,
          "first_rank_le_1": 44,
          "first_rank_le_5": 44,
          "first_rank_le_10": 44,
          "copy_soft_threshold": 0.5,
          "copy_soft_window_ks": [
            1,
            2,
            3
          ],
          "L_copy_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "delta_layers_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "copy_detector": {
            "strict": {
              "thresh": 0.95,
              "k": 1,
              "L_copy_strict": null
            },
            "soft": {
              "thresh": 0.5,
              "window_ks": [
                1,
                2,
                3
              ],
              "L_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            },
            "deltas": {
              "Δ_sem_minus_copy_strict": null,
              "Δ_sem_minus_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            }
          },
          "copy_thresholds": {
            "tau_list": [
              0.7,
              0.8,
              0.9,
              0.95
            ],
            "L_copy_strict": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "L_copy_strict_frac": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "norm_only_flags": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "stability": "none"
          },
          "L_surface_to_meaning_tuned": 46,
          "answer_mass_at_L_surface_tuned": 0.20805323123931885,
          "echo_mass_at_L_surface_tuned": 0.06563039243906132,
          "L_geom_tuned": null,
          "cos_to_answer_at_L_geom_tuned": null,
          "cos_to_prompt_max_at_L_geom_tuned": null,
          "L_topk_decay_tuned": 1,
          "topk_prompt_mass_at_L_tuned": 0.07950336229987442,
          "topk_prompt_tau_tuned": 0.33,
          "surface_delta_tuned": 0.05,
          "geom_gamma_tuned": 0.02,
          "cos_milestones": {
            "tuned": {
              "ge_0.2": 1,
              "ge_0.4": 1,
              "ge_0.6": 1
            }
          }
        },
        {
          "L_copy": null,
          "L_copy_H": 47,
          "L_semantic": 44,
          "delta_layers": null,
          "copy_thresh": 0.95,
          "copy_window_k": 1,
          "copy_match_level": "id_subsequence",
          "first_kl_below_0.5": 60,
          "first_kl_below_1.0": 44,
          "first_rank_le_1": 44,
          "first_rank_le_5": 43,
          "first_rank_le_10": 41,
          "copy_soft_threshold": 0.5,
          "copy_soft_window_ks": [
            1,
            2,
            3
          ],
          "L_copy_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "delta_layers_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "copy_detector": {
            "strict": {
              "thresh": 0.95,
              "k": 1,
              "L_copy_strict": null
            },
            "soft": {
              "thresh": 0.5,
              "window_ks": [
                1,
                2,
                3
              ],
              "L_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            },
            "deltas": {
              "Δ_sem_minus_copy_strict": null,
              "Δ_sem_minus_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            }
          },
          "copy_thresholds": {
            "tau_list": [
              0.7,
              0.8,
              0.9,
              0.95
            ],
            "L_copy_strict": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "L_copy_strict_frac": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "norm_only_flags": {
              "0.7": null,
              "0.8": null,
              "0.9": null,
              "0.95": null
            },
            "stability": "none"
          },
          "L_surface_to_meaning_tuned": 44,
          "answer_mass_at_L_surface_tuned": 0.8170695304870605,
          "echo_mass_at_L_surface_tuned": 0.010626450453401048,
          "L_geom_tuned": 46,
          "cos_to_answer_at_L_geom_tuned": 0.15042676031589508,
          "cos_to_prompt_max_at_L_geom_tuned": 0.12108578532934189,
          "L_topk_decay_tuned": 1,
          "topk_prompt_mass_at_L_tuned": 0.07752016768790781,
          "topk_prompt_tau_tuned": 0.33,
          "surface_delta_tuned": 0.05,
          "geom_gamma_tuned": 0.02,
          "cos_milestones": {
            "tuned": {
              "ge_0.2": 1,
              "ge_0.4": 1,
              "ge_0.6": 1
            }
          }
        }
      ]
    },
    "L_surface_to_meaning_tuned": 46,
    "answer_mass_at_L_surface_tuned": 0.2812182605266571,
    "echo_mass_at_L_surface_tuned": 0.06530000494876731,
    "L_geom_tuned": null,
    "cos_to_answer_at_L_geom_tuned": null,
    "cos_to_prompt_max_at_L_geom_tuned": null,
    "L_topk_decay_tuned": 1,
    "topk_prompt_mass_at_L_tuned": 0.07752763852477074,
    "topk_prompt_tau_tuned": 0.33,
    "surface_delta_tuned": 0.05,
    "geom_gamma_tuned": 0.02,
    "skip_layers_sanity": {
      "m=2": 82.9114729260689,
      "m=4": 7.760722485027111,
      "m=8": 0.7259817053412452
    },
    "tuned_lens_skip_warning": 82.9114729260689,
    "tuned_lens_regression": true,
    "confirmed_semantics": {
      "L_semantic_norm": 44,
      "L_semantic_raw": null,
      "L_semantic_tuned": 46,
      "Δ_window": 2,
      "L_semantic_confirmed": 44,
      "confirmed_source": "tuned"
    },
    "L_semantic_confirmed": 44,
    "config": {
      "lens_artifact_score": {
        "weights": {
          "pct_ge_1.0": 0.6,
          "norm_only": 0.3,
          "max_kl_scaled": 0.1
        },
        "thresholds": {
          "low": 0.2,
          "high": 0.5
        }
      }
    }
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.941373109817505,
    "topk": [
      [
        " Berlin",
        0.5626916289329529
      ],
      [
        " \"",
        0.1336509734392166
      ],
      [
        ":",
        0.055714018642902374
      ],
      [
        " ",
        0.043390121310949326
      ],
      [
        " '",
        0.03174488991498947
      ],
      [
        ".",
        0.023225056007504463
      ],
      [
        " “",
        0.015962332487106323
      ],
      [
        "\n",
        0.014995223842561245
      ],
      [
        ",",
        0.010970739647746086
      ],
      [
        " (",
        0.007540071848779917
      ],
      [
        " _",
        0.004573284648358822
      ],
      [
        " as",
        0.004573284648358822
      ],
      [
        " ‘",
        0.0035616778768599033
      ],
      [
        " -",
        0.0035616778768599033
      ],
      [
        " __",
        0.003345886943861842
      ],
      [
        " and",
        0.003345886943861842
      ],
      [
        "…",
        0.0027738374192267656
      ],
      [
        "Ber",
        0.0026057790964841843
      ],
      [
        " :",
        0.0026057790964841843
      ],
      [
        " [",
        0.0026057790964841843
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 60,
    "d_model": 7168,
    "n_heads": 56,
    "d_vocab": 64000,
    "n_ctx": 4096,
    "architecture": "pre_norm"
  },
  "raw_lens_check": {
    "mode": "sample",
    "samples": [
      {
        "layer": 0,
        "kl_norm_vs_raw_bits": 0.0028908866096782975,
        "top1_agree": false,
        "p_top1_norm": 2.174902692786418e-05,
        "p_top1_raw": 1.6418667655671015e-05,
        "p_answer_norm": 1.54758345161099e-05,
        "p_answer_raw": 1.56228579726303e-05,
        "answer_rank_norm": 34634,
        "answer_rank_raw": 32010,
        "is_answer_norm": false,
        "is_answer_raw": false
      },
      {
        "layer": 16,
        "kl_norm_vs_raw_bits": 0.8329083664929141,
        "top1_agree": false,
        "p_top1_norm": 0.000267283758148551,
        "p_top1_raw": 0.02985403686761856,
        "p_answer_norm": 8.801728654361796e-06,
        "p_answer_raw": 5.698451332136756e-06,
        "answer_rank_norm": 48602,
        "answer_rank_raw": 53464,
        "is_answer_norm": false,
        "is_answer_raw": false
      },
      {
        "layer": 31,
        "kl_norm_vs_raw_bits": 1.7088034526036855,
        "top1_agree": false,
        "p_top1_norm": 0.0008702512714080513,
        "p_top1_raw": 0.23969483375549316,
        "p_answer_norm": 5.600267741101561e-06,
        "p_answer_raw": 7.768888963255449e-07,
        "answer_rank_norm": 55111,
        "answer_rank_raw": 55508,
        "is_answer_norm": false,
        "is_answer_raw": false
      },
      {
        "layer": 46,
        "kl_norm_vs_raw_bits": 80.5715714892879,
        "top1_agree": false,
        "p_top1_norm": 0.03454635292291641,
        "p_top1_raw": 0.9997722506523132,
        "p_answer_norm": 0.03454635292291641,
        "p_answer_raw": 8.275188467055006e-18,
        "answer_rank_norm": 1,
        "answer_rank_raw": 16,
        "is_answer_norm": true,
        "is_answer_raw": false
      }
    ],
    "summary": {
      "first_norm_only_semantic_layer": 46,
      "max_kl_norm_vs_raw_bits": 80.5715714892879,
      "lens_artifact_risk": "high"
    }
  },
  "copy_flag_columns": [
    "copy_strict@0.95",
    "copy_strict@0.7",
    "copy_strict@0.8",
    "copy_strict@0.9",
    "copy_soft_k1@0.5",
    "copy_soft_k2@0.5",
    "copy_soft_k3@0.5"
  ],
  "ablation_summary": {
    "L_copy_orig": null,
    "L_sem_orig": 44,
    "L_copy_nf": null,
    "L_sem_nf": 44,
    "delta_L_copy": null,
    "delta_L_sem": 0
  },
  "control_prompt": {
    "context_prompt": "Give the city name only, plain text. The capital of France is called simply",
    "gold_answer": {
      "string": "Paris",
      "pieces": [
        "▁Paris"
      ],
      "first_id": 11080,
      "answer_ids": [
        11080
      ],
      "variant": "with_space"
    },
    "gold_alignment": "ok"
  },
  "control_summary": {
    "first_control_margin_pos": 1,
    "max_control_margin": 0.5835719932238135
  },
  "tuned_lens": {
    "status": "loaded",
    "path": "/home/kkonstant/logos-in-layers/001_layers_baseline/tuned_lenses/Yi-34B",
    "summaries": [
      {
        "L_copy": null,
        "L_copy_H": null,
        "L_semantic": 46,
        "delta_layers": null,
        "copy_thresh": 0.95,
        "copy_window_k": 1,
        "copy_match_level": "id_subsequence",
        "first_kl_below_0.5": 60,
        "first_kl_below_1.0": 60,
        "first_rank_le_1": 46,
        "first_rank_le_5": 44,
        "first_rank_le_10": 44,
        "copy_soft_threshold": 0.5,
        "copy_soft_window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "delta_layers_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "copy_detector": {
          "strict": {
            "thresh": 0.95,
            "k": 1,
            "L_copy_strict": null
          },
          "soft": {
            "thresh": 0.5,
            "window_ks": [
              1,
              2,
              3
            ],
            "L_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          },
          "deltas": {
            "Δ_sem_minus_copy_strict": null,
            "Δ_sem_minus_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          }
        },
        "copy_thresholds": {
          "tau_list": [
            0.7,
            0.8,
            0.9,
            0.95
          ],
          "L_copy_strict": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "L_copy_strict_frac": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "norm_only_flags": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "stability": "none"
        },
        "L_surface_to_meaning_tuned": 46,
        "answer_mass_at_L_surface_tuned": 0.2812182605266571,
        "echo_mass_at_L_surface_tuned": 0.06530000494876731,
        "L_geom_tuned": null,
        "cos_to_answer_at_L_geom_tuned": null,
        "cos_to_prompt_max_at_L_geom_tuned": null,
        "L_topk_decay_tuned": 1,
        "topk_prompt_mass_at_L_tuned": 0.07752763852477074,
        "topk_prompt_tau_tuned": 0.33,
        "surface_delta_tuned": 0.05,
        "geom_gamma_tuned": 0.02,
        "cos_milestones": {
          "tuned": {
            "ge_0.2": 1,
            "ge_0.4": 1,
            "ge_0.6": 1
          }
        }
      },
      {
        "L_copy": null,
        "L_copy_H": null,
        "L_semantic": 44,
        "delta_layers": null,
        "copy_thresh": 0.95,
        "copy_window_k": 1,
        "copy_match_level": "id_subsequence",
        "first_kl_below_0.5": 60,
        "first_kl_below_1.0": 60,
        "first_rank_le_1": 44,
        "first_rank_le_5": 44,
        "first_rank_le_10": 44,
        "copy_soft_threshold": 0.5,
        "copy_soft_window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "delta_layers_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "copy_detector": {
          "strict": {
            "thresh": 0.95,
            "k": 1,
            "L_copy_strict": null
          },
          "soft": {
            "thresh": 0.5,
            "window_ks": [
              1,
              2,
              3
            ],
            "L_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          },
          "deltas": {
            "Δ_sem_minus_copy_strict": null,
            "Δ_sem_minus_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          }
        },
        "copy_thresholds": {
          "tau_list": [
            0.7,
            0.8,
            0.9,
            0.95
          ],
          "L_copy_strict": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "L_copy_strict_frac": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "norm_only_flags": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "stability": "none"
        },
        "L_surface_to_meaning_tuned": 46,
        "answer_mass_at_L_surface_tuned": 0.20805323123931885,
        "echo_mass_at_L_surface_tuned": 0.06563039243906132,
        "L_geom_tuned": null,
        "cos_to_answer_at_L_geom_tuned": null,
        "cos_to_prompt_max_at_L_geom_tuned": null,
        "L_topk_decay_tuned": 1,
        "topk_prompt_mass_at_L_tuned": 0.07950336229987442,
        "topk_prompt_tau_tuned": 0.33,
        "surface_delta_tuned": 0.05,
        "geom_gamma_tuned": 0.02,
        "cos_milestones": {
          "tuned": {
            "ge_0.2": 1,
            "ge_0.4": 1,
            "ge_0.6": 1
          }
        }
      },
      {
        "L_copy": null,
        "L_copy_H": 47,
        "L_semantic": 44,
        "delta_layers": null,
        "copy_thresh": 0.95,
        "copy_window_k": 1,
        "copy_match_level": "id_subsequence",
        "first_kl_below_0.5": 60,
        "first_kl_below_1.0": 44,
        "first_rank_le_1": 44,
        "first_rank_le_5": 43,
        "first_rank_le_10": 41,
        "copy_soft_threshold": 0.5,
        "copy_soft_window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "delta_layers_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "copy_detector": {
          "strict": {
            "thresh": 0.95,
            "k": 1,
            "L_copy_strict": null
          },
          "soft": {
            "thresh": 0.5,
            "window_ks": [
              1,
              2,
              3
            ],
            "L_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          },
          "deltas": {
            "Δ_sem_minus_copy_strict": null,
            "Δ_sem_minus_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          }
        },
        "copy_thresholds": {
          "tau_list": [
            0.7,
            0.8,
            0.9,
            0.95
          ],
          "L_copy_strict": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "L_copy_strict_frac": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "norm_only_flags": {
            "0.7": null,
            "0.8": null,
            "0.9": null,
            "0.95": null
          },
          "stability": "none"
        },
        "L_surface_to_meaning_tuned": 44,
        "answer_mass_at_L_surface_tuned": 0.8170695304870605,
        "echo_mass_at_L_surface_tuned": 0.010626450453401048,
        "L_geom_tuned": 46,
        "cos_to_answer_at_L_geom_tuned": 0.15042676031589508,
        "cos_to_prompt_max_at_L_geom_tuned": 0.12108578532934189,
        "L_topk_decay_tuned": 1,
        "topk_prompt_mass_at_L_tuned": 0.07752016768790781,
        "topk_prompt_tau_tuned": 0.33,
        "surface_delta_tuned": 0.05,
        "geom_gamma_tuned": 0.02,
        "cos_milestones": {
          "tuned": {
            "ge_0.2": 1,
            "ge_0.4": 1,
            "ge_0.6": 1
          }
        }
      }
    ],
    "provenance": {
      "model_id": "01-ai/Yi-34B",
      "clean_model_name": "Yi-34B",
      "tl_version": "20250928T1110Z",
      "model_commit": null,
      "tokenizer_commit": null,
      "translator": {
        "num_layers": 60,
        "d_model": 7168,
        "rank": 256,
        "final_identity": true,
        "has_preconditioner": false,
        "use_temperature": true,
        "temperature_eps": 0.001,
        "temperatures": [
          0.6501230597496033,
          0.6570250988006592,
          0.7041584849357605,
          0.7084643840789795,
          0.6876068115234375,
          0.6759624481201172,
          0.6630550026893616,
          0.6580832004547119,
          0.6638860106468201,
          0.6777903437614441,
          0.6995242834091187,
          0.6562666296958923,
          0.6656703352928162,
          0.6817306280136108,
          0.6844232678413391,
          0.6900603771209717,
          0.6952967643737793,
          0.6789172291755676,
          0.6983872652053833,
          0.7220845818519592,
          0.7171486616134644,
          0.7096778154373169,
          0.7175903916358948,
          0.7134007811546326,
          0.7077625393867493,
          0.6867601275444031,
          0.7798203825950623,
          0.7189200520515442,
          0.6984835267066956,
          0.6740745902061462,
          0.6635228991508484,
          0.6643418669700623,
          0.6584051251411438,
          0.6341554522514343,
          0.6305476427078247,
          0.5990287661552429,
          0.5691472291946411,
          0.577404260635376,
          0.5764621496200562,
          0.5924845337867737,
          0.6134647727012634,
          0.6220322251319885,
          0.6480885744094849,
          0.6739495992660522,
          0.6717336177825928,
          0.6786097884178162,
          0.6866865754127502,
          0.6939886808395386,
          0.698807954788208,
          0.676760733127594,
          0.7044346332550049,
          0.6835857629776001,
          0.6930487751960754,
          0.6837488412857056,
          0.6782729029655457,
          0.6910231709480286,
          0.6479687094688416,
          0.6387726068496704,
          0.5990902185440063,
          1.0
        ]
      },
      "training": {
        "seed": 316,
        "total_steps": 1954,
        "warmup_steps": 196,
        "micro_batch": 32,
        "grad_accum": 1,
        "effective_batch": 32,
        "tokens_per_step": 16384,
        "layers_sampled_per_step": 17,
        "use_temperature": true,
        "temperature_eps": 0.001,
        "dataset": {
          "repo_id": "HuggingFaceFW/fineweb-edu",
          "name": "CC-MAIN-2025-26",
          "split": "train",
          "revision": "v1.4.0",
          "seq_len": 512,
          "positions_per_seq": 12,
          "position_fraction_range": [
            0.6,
            0.95
          ],
          "content_hash": "ddcf2c90ee768891d9394c214c547ea0d110161c66b13ebe832cefc90a448ce8",
          "samples_streamed": 114091
        },
        "optimizer": {
          "type": "AdamW",
          "lr": 0.001,
          "betas": [
            0.9,
            0.999
          ],
          "weight_decay": 0.0001
        },
        "regularization": {
          "l2": 0.0001,
          "smooth": 0.0001
        },
        "device": "cuda",
        "dtype": "torch.float16",
        "final_loss": 6.29245654463768
      }
    },
    "summary": {
      "metrics": {
        "rank_milestones": {
          "baseline": {
            "le_10": 43,
            "le_5": 44,
            "le_1": 44
          },
          "tuned": {
            "le_10": 44,
            "le_5": 44,
            "le_1": 46
          },
          "delta": {
            "le_10": 1,
            "le_5": 0,
            "le_1": 2
          }
        },
        "kl_bits_at_percentiles": {
          "baseline": {
            "p25": 13.119241111009872,
            "p50": 13.53785513837719,
            "p75": 11.162317944041112
          },
          "tuned": {
            "p25": 7.242486613853563,
            "p50": 7.437522507168626,
            "p75": 2.770426043034221
          },
          "delta": {
            "p25": 5.876754497156309,
            "p50": 6.1003326312085635,
            "p75": 8.39189190100689
          }
        },
        "first_kl_le_1.0": {
          "baseline": 60,
          "tuned": 60,
          "delta": 0
        }
      }
    },
    "attribution": {
      "percentiles": {
        "p25": {
          "ΔKL_tuned": 5.876754497156309,
          "ΔKL_temp": 0.90647790100045,
          "ΔKL_rot": 4.970276596155859
        },
        "p50": {
          "ΔKL_tuned": 6.1003326312085635,
          "ΔKL_temp": 1.278579564407222,
          "ΔKL_rot": 4.8217530668013415
        },
        "p75": {
          "ΔKL_tuned": 8.39189190100689,
          "ΔKL_temp": 4.3942268984663135,
          "ΔKL_rot": 3.997665002540576
        }
      },
      "prefer_tuned": true
    }
  },
  "measurement_guidance": {
    "prefer_ranks": true,
    "suppress_abs_probs": true,
    "reasons": [
      "norm_only_semantics_window",
      "high_lens_artifact_risk",
      "high_lens_artifact_score"
    ],
    "notes": "Family-level head calibration; treat probabilities comparatively only within model.",
    "preferred_lens_for_reporting": "tuned",
    "use_confirmed_semantics": true,
    "notes_append": "Prism is diagnostic-only; treat probabilities comparatively within model."
  },
  "gold_answer": {
    "string": "Berlin",
    "pieces": [
      "▁Berlin"
    ],
    "first_id": 19616,
    "answer_ids": [
      19616
    ],
    "variant": "with_space"
  }
}