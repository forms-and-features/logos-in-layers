{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 1.6006994247436523,
      "topk": [
        [
          " Germany",
          0.8021256327629089
        ],
        [
          " which",
          0.06701981276273727
        ],
        [
          " the",
          0.044764794409275055
        ],
        [
          " _",
          0.012397986836731434
        ],
        [
          " what",
          0.010888390243053436
        ],
        [
          " a",
          0.00494015496224165
        ],
        [
          " Berlin",
          0.004810842219740152
        ],
        [
          " German",
          0.0029212450608611107
        ],
        [
          "\n",
          0.002908518770709634
        ],
        [
          " Europe",
          0.002521959599107504
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.935582160949707,
      "topk": [
        [
          " Berlin",
          0.5113047361373901
        ],
        [
          " \"",
          0.22796587646007538
        ],
        [
          " '",
          0.050398699939250946
        ],
        [
          " _",
          0.0365014374256134
        ],
        [
          ",",
          0.020632106810808182
        ],
        [
          " “",
          0.014124887995421886
        ],
        [
          " by",
          0.013540095649659634
        ],
        [
          ":",
          0.013363983482122421
        ],
        [
          " the",
          0.010564080439507961
        ],
        [
          " that",
          0.005702292080968618
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 4.185177326202393,
      "topk": [
        [
          " Berlin",
          0.3061671257019043
        ],
        [
          " after",
          0.11803445965051651
        ],
        [
          " “",
          0.10863861441612244
        ],
        [
          " as",
          0.08816132694482803
        ],
        [
          " for",
          0.052861470729112625
        ],
        [
          " \"",
          0.04233784228563309
        ],
        [
          " _",
          0.03961029648780823
        ],
        [
          ",",
          0.026262905448675156
        ],
        [
          " ‘",
          0.02374998852610588
        ],
        [
          " because",
          0.019292792305350304
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 3.3034536838531494,
      "topk": [
        [
          " Berlin",
          0.5225129127502441
        ],
        [
          ",",
          0.09168039262294769
        ],
        [
          " “",
          0.08779864013195038
        ],
        [
          " _",
          0.04510977864265442
        ],
        [
          " as",
          0.0376104861497879
        ],
        [
          " \"",
          0.027013763785362244
        ],
        [
          " ‘",
          0.026927907019853592
        ],
        [
          ":",
          0.021130433306097984
        ],
        [
          " '",
          0.0081827063113451
        ],
        [
          " Germany",
          0.0074522229842841625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 3.853647232055664,
      "topk": [
        [
          " called",
          0.38571780920028687
        ],
        [
          " known",
          0.20439478754997253
        ],
        [
          " referred",
          0.11952878534793854
        ],
        [
          " named",
          0.04333849623799324
        ],
        [
          " the",
          0.032132528722286224
        ],
        [
          " Berlin",
          0.025439608842134476
        ],
        [
          " a",
          0.01901349052786827
        ],
        [
          " not",
          0.011408817954361439
        ],
        [
          " “",
          0.009601508267223835
        ],
        [
          " too",
          0.006198307499289513
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 3.2616171836853027,
      "topk": [
        [
          " Berlin",
          0.6203323602676392
        ],
        [
          " _",
          0.04728003591299057
        ],
        [
          " \"",
          0.04549865424633026
        ],
        [
          " the",
          0.02673659287393093
        ],
        [
          " what",
          0.022911280393600464
        ],
        [
          ":\n",
          0.01763756200671196
        ],
        [
          "\n",
          0.017449043691158295
        ],
        [
          " a",
          0.013831806369125843
        ],
        [
          ":\n\n",
          0.012378654442727566
        ],
        [
          "\n\n",
          0.009619529359042645
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 3.1972217559814453,
      "topk": [
        [
          " after",
          0.4417528808116913
        ],
        [
          " Berlin",
          0.23996396362781525
        ],
        [
          " for",
          0.07462482154369354
        ],
        [
          " as",
          0.0402701310813427
        ],
        [
          " _",
          0.030880862846970558
        ],
        [
          " in",
          0.017681052908301353
        ],
        [
          " the",
          0.01330163236707449
        ],
        [
          " “",
          0.011678162962198257
        ],
        [
          " what",
          0.010235966183245182
        ],
        [
          ":\n",
          0.008618701249361038
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 2.4529027938842773,
      "topk": [
        [
          " Berlin",
          0.7161046266555786
        ],
        [
          " _",
          0.04885568097233772
        ],
        [
          " which",
          0.02601703070104122
        ],
        [
          " the",
          0.025490103289484978
        ],
        [
          "\n",
          0.02002657763659954
        ],
        [
          " Bonn",
          0.016914289444684982
        ],
        [
          ":\n",
          0.014072220772504807
        ],
        [
          ":",
          0.00839319173246622
        ],
        [
          " what",
          0.007834827527403831
        ],
        [
          ":\n\n",
          0.00770501559600234
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 4.2655534744262695,
      "topk": [
        [
          " Berlin",
          0.3457546532154083
        ],
        [
          " the",
          0.2618199586868286
        ],
        [
          " “",
          0.03936431556940079
        ],
        [
          " _",
          0.03916536644101143
        ],
        [
          " a",
          0.036001771688461304
        ],
        [
          " \"",
          0.022386863827705383
        ],
        [
          " ‘",
          0.014638797380030155
        ],
        [
          " Bundes",
          0.014028258621692657
        ],
        [
          " Bonn",
          0.013547392562031746
        ],
        [
          " Bund",
          0.008970698341727257
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 3.7205681800842285,
      "topk": [
        [
          " Germany",
          0.4586721956729889
        ],
        [
          " which",
          0.1670248955488205
        ],
        [
          " what",
          0.058780960738658905
        ],
        [
          " _",
          0.05470253527164459
        ],
        [
          " the",
          0.027768146246671677
        ],
        [
          " this",
          0.02560901828110218
        ],
        [
          ":",
          0.011317060329020023
        ],
        [
          " ___",
          0.010979429818689823
        ],
        [
          "\n\n",
          0.009993997402489185
        ],
        [
          "\n",
          0.009206753224134445
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 3.1799511909484863,
      "topk": [
        [
          " Berlin",
          0.6302469372749329
        ],
        [
          " _",
          0.04395410045981407
        ],
        [
          " \"",
          0.04363147169351578
        ],
        [
          ":",
          0.03635828197002411
        ],
        [
          " what",
          0.017218535766005516
        ],
        [
          ":\n\n",
          0.013146351091563702
        ],
        [
          "\n\n",
          0.012942115776240826
        ],
        [
          " '",
          0.010323886759579182
        ],
        [
          "?",
          0.010259050875902176
        ],
        [
          ":\n",
          0.010134202428162098
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.8114449977874756,
      "topk": [
        [
          " Berlin",
          0.3647581934928894
        ],
        [
          " \"",
          0.1918836534023285
        ],
        [
          " “",
          0.08633825927972794
        ],
        [
          " as",
          0.053772855550050735
        ],
        [
          " '",
          0.03490190953016281
        ],
        [
          ":",
          0.02671705186367035
        ],
        [
          ",",
          0.025261059403419495
        ],
        [
          " _",
          0.02057754248380661
        ],
        [
          " ber",
          0.015526789240539074
        ],
        [
          " ‘",
          0.01525755412876606
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 3.7952351570129395,
      "topk": [
        [
          " Berlin",
          0.5712736248970032
        ],
        [
          " _",
          0.04396359249949455
        ],
        [
          " the",
          0.036566514521837234
        ],
        [
          ":",
          0.03490332514047623
        ],
        [
          " which",
          0.03346666321158409
        ],
        [
          " what",
          0.015152531675994396
        ],
        [
          "\n\n",
          0.014937031082808971
        ],
        [
          "\n",
          0.013472585007548332
        ],
        [
          ":\n\n",
          0.010653424076735973
        ],
        [
          " Bonn",
          0.009841330349445343
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.5047926902771,
      "topk": [
        [
          " Berlin",
          0.3634735643863678
        ],
        [
          " the",
          0.23055604100227356
        ],
        [
          " \"",
          0.042757805436849594
        ],
        [
          " _",
          0.030781464651226997
        ],
        [
          " “",
          0.02894550748169422
        ],
        [
          " Bundes",
          0.023803090676665306
        ],
        [
          " a",
          0.018401481211185455
        ],
        [
          " Hauptstadt",
          0.015389389358460903
        ],
        [
          " Bonn",
          0.012492181733250618
        ],
        [
          ":",
          0.01223792601376772
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.0061279647052288055,
      "topk": [
        [
          " Berlin",
          0.999506950378418
        ],
        [
          " \"",
          0.0004930031136609614
        ],
        [
          " “",
          2.5221996935442803e-08
        ],
        [
          " '",
          1.034029719487739e-11
        ],
        [
          ":",
          7.741215654610833e-12
        ],
        [
          " _",
          6.957250801940124e-14
        ],
        [
          " ‘",
          8.837356789522172e-16
        ],
        [
          " `",
          5.40868335667142e-16
        ],
        [
          ",",
          4.615433825194215e-16
        ],
        [
          " ber",
          3.2104610696768955e-16
        ],
        [
          ":\n\n",
          4.808869291792608e-19
        ],
        [
          "\n\n",
          3.423188478859023e-19
        ],
        [
          "\n",
          3.3298377863111753e-19
        ],
        [
          ":\n",
          1.2260260366698717e-19
        ],
        [
          " as",
          2.2430375558439154e-20
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 14.358918190002441,
      "topk": [
        [
          " Berlin",
          0.029947999864816666
        ],
        [
          " \"",
          0.020465439185500145
        ],
        [
          " “",
          0.012487268075346947
        ],
        [
          " '",
          0.008454837836325169
        ],
        [
          ":",
          0.008333340287208557
        ],
        [
          " _",
          0.006584163289517164
        ],
        [
          " ‘",
          0.005292913410812616
        ],
        [
          " `",
          0.005164559464901686
        ],
        [
          ",",
          0.005123765207827091
        ],
        [
          " ber",
          0.005031608510762453
        ],
        [
          ":\n\n",
          0.003634801134467125
        ],
        [
          "\n\n",
          0.0035735515411943197
        ],
        [
          "\n",
          0.0035686164628714323
        ],
        [
          ":\n",
          0.003394716652110219
        ],
        [
          " as",
          0.0031183192040771246
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "mistralai/Mistral-Small-24B-Base-2501",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "surface_diagnostics_config": {
      "delta": 0.05,
      "gamma": 0.02,
      "K": 50,
      "tau": 0.33
    },
    "prism_summary": {
      "mode": "auto",
      "artifact_path": "/home/kkonstant/logos-in-layers/001_layers_baseline/prisms/Mistral-Small-24B-Base-2501",
      "present": true,
      "compatible": true,
      "k": 512,
      "layers": [
        "embed",
        9,
        19,
        29
      ],
      "error": null
    },
    "copy_soft_config": {
      "threshold": 0.5,
      "window_ks": [
        1,
        2,
        3
      ],
      "extra_thresholds": []
    },
    "tau_norm_per_layer": [
      0.19999998807907104,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      5.0,
      1.4953488111495972,
      0.5848035216331482,
      0.7647244930267334,
      5.0,
      1.307660460472107,
      0.7647244930267334,
      0.5848035216331482,
      0.5114020705223083,
      0.7647244930267334,
      0.8744852542877197,
      0.7647244930267334,
      0.6687402725219727,
      0.6687402725219727,
      1.4953488111495972,
      0.5114020705223083,
      0.5848035216331482,
      0.39108169078826904,
      0.39108169078826904,
      0.39108169078826904,
      0.3419951796531677,
      0.39108169078826904,
      0.3419951796531677,
      0.39108169078826904,
      0.29906976222991943,
      0.29906976222991943,
      0.29906976222991943,
      0.39108169078826904,
      0.39108169078826904,
      0.5114020705223083,
      0.4472135901451111,
      0.5114020705223083,
      0.5848035216331482,
      0.6687402725219727,
      1.0
    ],
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 33,
    "delta_layers": null,
    "copy_thresh": 0.95,
    "copy_window_k": 1,
    "copy_match_level": "id_subsequence",
    "first_kl_below_0.5": 40,
    "first_kl_below_1.0": 40,
    "first_rank_le_1": 33,
    "first_rank_le_5": 30,
    "first_rank_le_10": 30,
    "copy_soft_threshold": 0.5,
    "copy_soft_window_ks": [
      1,
      2,
      3
    ],
    "L_copy_soft": {
      "1": null,
      "2": null,
      "3": null
    },
    "delta_layers_soft": {
      "1": null,
      "2": null,
      "3": null
    },
    "copy_detector": {
      "strict": {
        "thresh": 0.95,
        "k": 1,
        "L_copy_strict": null
      },
      "soft": {
        "thresh": 0.5,
        "window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "k1": null,
          "k2": null,
          "k3": null
        }
      },
      "deltas": {
        "Δ_sem_minus_copy_strict": null,
        "Δ_sem_minus_copy_soft": {
          "k1": null,
          "k2": null,
          "k3": null
        }
      }
    },
    "L_surface_to_meaning_norm": 40,
    "answer_mass_at_L_surface_norm": 0.45546209812164307,
    "echo_mass_at_L_surface_norm": 0.004237974450470361,
    "L_geom_norm": 31,
    "cos_to_answer_at_L_geom_norm": 0.09460057318210602,
    "cos_to_prompt_max_at_L_geom_norm": 0.07399612665176392,
    "L_topk_decay_norm": 0,
    "topk_prompt_mass_at_L_norm": 0.0,
    "topk_prompt_tau_norm": 0.33,
    "surface_delta_norm": 0.05,
    "geom_gamma_norm": 0.02,
    "gold_alignment": "ok",
    "last_layer_consistency": {
      "kl_to_final_bits": 0.0,
      "top1_agree": true,
      "p_top1_lens": 0.45546209812164307,
      "p_top1_model": 0.45546209812164307,
      "p_answer_lens": 0.45546209812164307,
      "answer_rank_lens": 1,
      "temp_est": 1.0,
      "kl_after_temp_bits": 0.0,
      "cfg_transform": {
        "scale": null,
        "softcap": null
      },
      "kl_after_transform_bits": {
        "scale": null,
        "softcap": null,
        "scale_then_softcap": null
      },
      "warn_high_last_layer_kl": false
    },
    "kl_to_final_bits_norm_temp@25%": {
      "layer": 10,
      "value": 10.595206528682207
    },
    "kl_to_final_bits_norm_temp@50%": {
      "layer": 20,
      "value": 10.691666094106328
    },
    "kl_to_final_bits_norm_temp@75%": {
      "layer": 30,
      "value": 16.714219227496887
    },
    "tuned_lens": {
      "status": "loaded",
      "mode": "auto",
      "path": "/home/kkonstant/logos-in-layers/001_layers_baseline/tuned_lenses/Mistral-Small-24B-Base-2501",
      "summaries": [
        {
          "L_copy": null,
          "L_copy_H": null,
          "L_semantic": 39,
          "delta_layers": null,
          "copy_thresh": 0.95,
          "copy_window_k": 1,
          "copy_match_level": "id_subsequence",
          "first_kl_below_0.5": 40,
          "first_kl_below_1.0": 40,
          "first_rank_le_1": 39,
          "first_rank_le_5": 35,
          "first_rank_le_10": 34,
          "copy_soft_threshold": 0.5,
          "copy_soft_window_ks": [
            1,
            2,
            3
          ],
          "L_copy_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "delta_layers_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "copy_detector": {
            "strict": {
              "thresh": 0.95,
              "k": 1,
              "L_copy_strict": null
            },
            "soft": {
              "thresh": 0.5,
              "window_ks": [
                1,
                2,
                3
              ],
              "L_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            },
            "deltas": {
              "Δ_sem_minus_copy_strict": null,
              "Δ_sem_minus_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            }
          },
          "L_surface_to_meaning_tuned": 39,
          "answer_mass_at_L_surface_tuned": 0.3330937623977661,
          "echo_mass_at_L_surface_tuned": 0.005606520599258147,
          "L_geom_tuned": 34,
          "cos_to_answer_at_L_geom_tuned": 0.09993547201156616,
          "cos_to_prompt_max_at_L_geom_tuned": 0.07856401801109314,
          "L_topk_decay_tuned": 1,
          "topk_prompt_mass_at_L_tuned": 0.11204447085037827,
          "topk_prompt_tau_tuned": 0.33,
          "surface_delta_tuned": 0.05,
          "geom_gamma_tuned": 0.02
        },
        {
          "L_copy": null,
          "L_copy_H": null,
          "L_semantic": 35,
          "delta_layers": null,
          "copy_thresh": 0.95,
          "copy_window_k": 1,
          "copy_match_level": "id_subsequence",
          "first_kl_below_0.5": 40,
          "first_kl_below_1.0": 40,
          "first_rank_le_1": 35,
          "first_rank_le_5": 33,
          "first_rank_le_10": 31,
          "copy_soft_threshold": 0.5,
          "copy_soft_window_ks": [
            1,
            2,
            3
          ],
          "L_copy_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "delta_layers_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "copy_detector": {
            "strict": {
              "thresh": 0.95,
              "k": 1,
              "L_copy_strict": null
            },
            "soft": {
              "thresh": 0.5,
              "window_ks": [
                1,
                2,
                3
              ],
              "L_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            },
            "deltas": {
              "Δ_sem_minus_copy_strict": null,
              "Δ_sem_minus_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            }
          },
          "L_surface_to_meaning_tuned": 35,
          "answer_mass_at_L_surface_tuned": 0.21816769242286682,
          "echo_mass_at_L_surface_tuned": 0.007699911109284585,
          "L_geom_tuned": 31,
          "cos_to_answer_at_L_geom_tuned": 0.10671862959861755,
          "cos_to_prompt_max_at_L_geom_tuned": 0.08222174644470215,
          "L_topk_decay_tuned": 1,
          "topk_prompt_mass_at_L_tuned": 0.08341136935632676,
          "topk_prompt_tau_tuned": 0.33,
          "surface_delta_tuned": 0.05,
          "geom_gamma_tuned": 0.02
        },
        {
          "L_copy": null,
          "L_copy_H": null,
          "L_semantic": 33,
          "delta_layers": null,
          "copy_thresh": 0.95,
          "copy_window_k": 1,
          "copy_match_level": "id_subsequence",
          "first_kl_below_0.5": 39,
          "first_kl_below_1.0": 38,
          "first_rank_le_1": 33,
          "first_rank_le_5": 31,
          "first_rank_le_10": 30,
          "copy_soft_threshold": 0.5,
          "copy_soft_window_ks": [
            1,
            2,
            3
          ],
          "L_copy_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "delta_layers_soft": {
            "1": null,
            "2": null,
            "3": null
          },
          "copy_detector": {
            "strict": {
              "thresh": 0.95,
              "k": 1,
              "L_copy_strict": null
            },
            "soft": {
              "thresh": 0.5,
              "window_ks": [
                1,
                2,
                3
              ],
              "L_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            },
            "deltas": {
              "Δ_sem_minus_copy_strict": null,
              "Δ_sem_minus_copy_soft": {
                "k1": null,
                "k2": null,
                "k3": null
              }
            }
          },
          "L_surface_to_meaning_tuned": 33,
          "answer_mass_at_L_surface_tuned": 0.20143072307109833,
          "echo_mass_at_L_surface_tuned": 0.010268065668242343,
          "L_geom_tuned": 30,
          "cos_to_answer_at_L_geom_tuned": 0.09721231460571289,
          "cos_to_prompt_max_at_L_geom_tuned": 0.07457584887742996,
          "L_topk_decay_tuned": 1,
          "topk_prompt_mass_at_L_tuned": 0.11159634357318282,
          "topk_prompt_tau_tuned": 0.33,
          "surface_delta_tuned": 0.05,
          "geom_gamma_tuned": 0.02
        }
      ]
    },
    "L_surface_to_meaning_tuned": 39,
    "answer_mass_at_L_surface_tuned": 0.3330937623977661,
    "echo_mass_at_L_surface_tuned": 0.005606520599258147,
    "L_geom_tuned": 34,
    "cos_to_answer_at_L_geom_tuned": 0.09993547201156616,
    "cos_to_prompt_max_at_L_geom_tuned": 0.07856401801109314,
    "L_topk_decay_tuned": 1,
    "topk_prompt_mass_at_L_tuned": 0.11204447085037827,
    "topk_prompt_tau_tuned": 0.33,
    "surface_delta_tuned": 0.05,
    "geom_gamma_tuned": 0.02,
    "skip_layers_sanity": {
      "m=2": 0.10762576073806562,
      "m=4": 8.147868207831712,
      "m=8": 16.254941647149412
    },
    "tuned_lens_regression": false
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 3.180720090866089,
    "topk": [
      [
        " Berlin",
        0.45546209812164307
      ],
      [
        " \"",
        0.21269574761390686
      ],
      [
        " “",
        0.07918655127286911
      ],
      [
        " '",
        0.036301713436841965
      ],
      [
        ":",
        0.03526588901877403
      ],
      [
        " _",
        0.022014953196048737
      ],
      [
        " ‘",
        0.014226765371859074
      ],
      [
        " `",
        0.013545128516852856
      ],
      [
        ",",
        0.013331989757716656
      ],
      [
        " ber",
        0.012856720946729183
      ],
      [
        ":\n\n",
        0.0067093102261424065
      ],
      [
        "\n\n",
        0.00648509943857789
      ],
      [
        "\n",
        0.00646720128133893
      ],
      [
        ":\n",
        0.005852260161191225
      ],
      [
        " as",
        0.004938075784593821
      ],
      [
        " (",
        0.002467821817845106
      ],
      [
        " .",
        0.002239043591544032
      ],
      [
        " and",
        0.0022248015739023685
      ],
      [
        ".",
        0.0019991681911051273
      ],
      [
        " by",
        0.0019857571460306644
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 40,
    "d_model": 5120,
    "n_heads": 32,
    "d_vocab": 131072,
    "n_ctx": 2048,
    "architecture": "pre_norm"
  },
  "raw_lens_check": {
    "mode": "sample",
    "samples": [
      {
        "layer": 0,
        "kl_norm_vs_raw_bits": 0.0014594629140170024,
        "top1_agree": false,
        "p_top1_norm": 9.551221410220023e-06,
        "p_top1_raw": 7.668009857297875e-06,
        "p_answer_norm": 7.963523785292637e-06,
        "p_answer_raw": 7.6278947744867764e-06,
        "answer_rank_norm": 21319,
        "answer_rank_raw": 76731,
        "is_answer_norm": false,
        "is_answer_raw": false
      },
      {
        "layer": 11,
        "kl_norm_vs_raw_bits": 0.13885178401360904,
        "top1_agree": false,
        "p_top1_norm": 8.95772100193426e-05,
        "p_top1_raw": 9.053707799466792e-06,
        "p_answer_norm": 7.086192454153206e-06,
        "p_answer_raw": 7.664844815735705e-06,
        "answer_rank_norm": 61341,
        "answer_rank_raw": 56513,
        "is_answer_norm": false,
        "is_answer_raw": false
      },
      {
        "layer": 21,
        "kl_norm_vs_raw_bits": 0.1792677499620318,
        "top1_agree": true,
        "p_top1_norm": 0.0002302979992236942,
        "p_top1_raw": 1.124704704125179e-05,
        "p_answer_norm": 6.334975751087768e-06,
        "p_answer_raw": 7.5543571256275754e-06,
        "answer_rank_norm": 69133,
        "answer_rank_raw": 72729,
        "is_answer_norm": false,
        "is_answer_raw": false
      },
      {
        "layer": 31,
        "kl_norm_vs_raw_bits": 0.12635255790119,
        "top1_agree": true,
        "p_top1_norm": 0.00040937724406830966,
        "p_top1_raw": 1.845642145781312e-05,
        "p_answer_norm": 0.00026363643701188266,
        "p_answer_raw": 1.6500356650794856e-05,
        "answer_rank_norm": 2,
        "answer_rank_raw": 3,
        "is_answer_norm": false,
        "is_answer_raw": false
      }
    ],
    "summary": {
      "first_norm_only_semantic_layer": null,
      "max_kl_norm_vs_raw_bits": 0.1792677499620318,
      "lens_artifact_risk": "low"
    }
  },
  "copy_flag_columns": [
    "copy_strict@0.95",
    "copy_soft_k1@0.5",
    "copy_soft_k2@0.5",
    "copy_soft_k3@0.5"
  ],
  "ablation_summary": {
    "L_copy_orig": null,
    "L_sem_orig": 33,
    "L_copy_nf": null,
    "L_sem_nf": 31,
    "delta_L_copy": null,
    "delta_L_sem": -2
  },
  "control_prompt": {
    "context_prompt": "Give the city name only, plain text. The capital of France is called simply",
    "gold_answer": {
      "string": "Paris",
      "pieces": [
        "ĠParis"
      ],
      "first_id": 6993,
      "answer_ids": [
        6993
      ],
      "variant": "with_space"
    },
    "gold_alignment": "ok"
  },
  "control_summary": {
    "first_control_margin_pos": 1,
    "max_control_margin": 0.4679627253462968
  },
  "tuned_lens": {
    "status": "loaded",
    "path": "/home/kkonstant/logos-in-layers/001_layers_baseline/tuned_lenses/Mistral-Small-24B-Base-2501",
    "summaries": [
      {
        "L_copy": null,
        "L_copy_H": null,
        "L_semantic": 39,
        "delta_layers": null,
        "copy_thresh": 0.95,
        "copy_window_k": 1,
        "copy_match_level": "id_subsequence",
        "first_kl_below_0.5": 40,
        "first_kl_below_1.0": 40,
        "first_rank_le_1": 39,
        "first_rank_le_5": 35,
        "first_rank_le_10": 34,
        "copy_soft_threshold": 0.5,
        "copy_soft_window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "delta_layers_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "copy_detector": {
          "strict": {
            "thresh": 0.95,
            "k": 1,
            "L_copy_strict": null
          },
          "soft": {
            "thresh": 0.5,
            "window_ks": [
              1,
              2,
              3
            ],
            "L_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          },
          "deltas": {
            "Δ_sem_minus_copy_strict": null,
            "Δ_sem_minus_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          }
        },
        "L_surface_to_meaning_tuned": 39,
        "answer_mass_at_L_surface_tuned": 0.3330937623977661,
        "echo_mass_at_L_surface_tuned": 0.005606520599258147,
        "L_geom_tuned": 34,
        "cos_to_answer_at_L_geom_tuned": 0.09993547201156616,
        "cos_to_prompt_max_at_L_geom_tuned": 0.07856401801109314,
        "L_topk_decay_tuned": 1,
        "topk_prompt_mass_at_L_tuned": 0.11204447085037827,
        "topk_prompt_tau_tuned": 0.33,
        "surface_delta_tuned": 0.05,
        "geom_gamma_tuned": 0.02
      },
      {
        "L_copy": null,
        "L_copy_H": null,
        "L_semantic": 35,
        "delta_layers": null,
        "copy_thresh": 0.95,
        "copy_window_k": 1,
        "copy_match_level": "id_subsequence",
        "first_kl_below_0.5": 40,
        "first_kl_below_1.0": 40,
        "first_rank_le_1": 35,
        "first_rank_le_5": 33,
        "first_rank_le_10": 31,
        "copy_soft_threshold": 0.5,
        "copy_soft_window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "delta_layers_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "copy_detector": {
          "strict": {
            "thresh": 0.95,
            "k": 1,
            "L_copy_strict": null
          },
          "soft": {
            "thresh": 0.5,
            "window_ks": [
              1,
              2,
              3
            ],
            "L_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          },
          "deltas": {
            "Δ_sem_minus_copy_strict": null,
            "Δ_sem_minus_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          }
        },
        "L_surface_to_meaning_tuned": 35,
        "answer_mass_at_L_surface_tuned": 0.21816769242286682,
        "echo_mass_at_L_surface_tuned": 0.007699911109284585,
        "L_geom_tuned": 31,
        "cos_to_answer_at_L_geom_tuned": 0.10671862959861755,
        "cos_to_prompt_max_at_L_geom_tuned": 0.08222174644470215,
        "L_topk_decay_tuned": 1,
        "topk_prompt_mass_at_L_tuned": 0.08341136935632676,
        "topk_prompt_tau_tuned": 0.33,
        "surface_delta_tuned": 0.05,
        "geom_gamma_tuned": 0.02
      },
      {
        "L_copy": null,
        "L_copy_H": null,
        "L_semantic": 33,
        "delta_layers": null,
        "copy_thresh": 0.95,
        "copy_window_k": 1,
        "copy_match_level": "id_subsequence",
        "first_kl_below_0.5": 39,
        "first_kl_below_1.0": 38,
        "first_rank_le_1": 33,
        "first_rank_le_5": 31,
        "first_rank_le_10": 30,
        "copy_soft_threshold": 0.5,
        "copy_soft_window_ks": [
          1,
          2,
          3
        ],
        "L_copy_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "delta_layers_soft": {
          "1": null,
          "2": null,
          "3": null
        },
        "copy_detector": {
          "strict": {
            "thresh": 0.95,
            "k": 1,
            "L_copy_strict": null
          },
          "soft": {
            "thresh": 0.5,
            "window_ks": [
              1,
              2,
              3
            ],
            "L_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          },
          "deltas": {
            "Δ_sem_minus_copy_strict": null,
            "Δ_sem_minus_copy_soft": {
              "k1": null,
              "k2": null,
              "k3": null
            }
          }
        },
        "L_surface_to_meaning_tuned": 33,
        "answer_mass_at_L_surface_tuned": 0.20143072307109833,
        "echo_mass_at_L_surface_tuned": 0.010268065668242343,
        "L_geom_tuned": 30,
        "cos_to_answer_at_L_geom_tuned": 0.09721231460571289,
        "cos_to_prompt_max_at_L_geom_tuned": 0.07457584887742996,
        "L_topk_decay_tuned": 1,
        "topk_prompt_mass_at_L_tuned": 0.11159634357318282,
        "topk_prompt_tau_tuned": 0.33,
        "surface_delta_tuned": 0.05,
        "geom_gamma_tuned": 0.02
      }
    ],
    "provenance": {
      "model_id": "mistralai/Mistral-Small-24B-Base-2501",
      "clean_model_name": "Mistral-Small-24B-Base-2501",
      "tl_version": "20250928T1518Z",
      "model_commit": null,
      "tokenizer_commit": null,
      "translator": {
        "num_layers": 40,
        "d_model": 5120,
        "rank": 256,
        "final_identity": true,
        "has_preconditioner": false,
        "use_temperature": true,
        "temperature_eps": 0.001,
        "temperatures": [
          0.5451574921607971,
          0.538635790348053,
          0.5519798398017883,
          0.5278217792510986,
          0.5169389843940735,
          0.5327208638191223,
          0.5399712920188904,
          0.5424074530601501,
          0.5420973300933838,
          0.5396926403045654,
          0.5502318739891052,
          0.5519662499427795,
          0.5466310977935791,
          0.5600756406784058,
          0.5564045906066895,
          0.5516306161880493,
          0.5710114240646362,
          0.5659334063529968,
          0.5584056377410889,
          0.563214898109436,
          0.5558133721351624,
          0.5630472898483276,
          0.5817683339118958,
          0.5811793804168701,
          0.5899590849876404,
          0.5872891545295715,
          0.5753065347671509,
          0.6137284636497498,
          0.6050739884376526,
          0.631809651851654,
          0.6210309267044067,
          0.6284975409507751,
          0.6352766156196594,
          0.6467778086662292,
          0.6381341218948364,
          0.6512296795845032,
          0.6700820922851562,
          0.6763048768043518,
          0.6571027636528015,
          1.0
        ]
      },
      "training": {
        "seed": 316,
        "total_steps": 1954,
        "warmup_steps": 196,
        "micro_batch": 32,
        "grad_accum": 1,
        "effective_batch": 32,
        "tokens_per_step": 16384,
        "layers_sampled_per_step": 12,
        "use_temperature": true,
        "temperature_eps": 0.001,
        "dataset": {
          "repo_id": "HuggingFaceFW/fineweb-edu",
          "name": "CC-MAIN-2025-26",
          "split": "train",
          "revision": "v1.4.0",
          "seq_len": 512,
          "positions_per_seq": 12,
          "position_fraction_range": [
            0.6,
            0.95
          ],
          "content_hash": "cf83474b914d536b48f05ce13c0662a4018e3292636020a9f37e72aaeaece69e",
          "samples_streamed": 119782
        },
        "optimizer": {
          "type": "AdamW",
          "lr": 0.001,
          "betas": [
            0.9,
            0.999
          ],
          "weight_decay": 0.0001
        },
        "regularization": {
          "l2": 0.0001,
          "smooth": 0.0001
        },
        "device": "cuda",
        "dtype": "torch.float16",
        "final_loss": 6.427894369363785
      }
    }
  },
  "gold_answer": {
    "string": "Berlin",
    "pieces": [
      "ĠBerlin"
    ],
    "first_id": 10874,
    "answer_ids": [
      10874
    ],
    "variant": "with_space"
  }
}