{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.92772429372274,
      "topk": [
        [
          " Germany",
          0.8955409526824951
        ],
        [
          " the",
          0.05247187986969948
        ],
        [
          " and",
          0.007549081929028034
        ],
        [
          " germany",
          0.003360331989824772
        ],
        [
          " modern",
          0.002971325535327196
        ],
        [
          " Berlin",
          0.0028946634847670794
        ],
        [
          " united",
          0.0026280763559043407
        ],
        [
          " German",
          0.0024952488020062447
        ],
        [
          " Europe",
          0.0022098692134022713
        ],
        [
          " a",
          0.00220917584374547
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 3.391849063587648,
      "topk": [
        [
          " Berlin",
          0.3688071668148041
        ],
        [
          " \"",
          0.2485688328742981
        ],
        [
          ",",
          0.08010195195674896
        ],
        [
          " '",
          0.07339178770780563
        ],
        [
          " by",
          0.0388433076441288
        ],
        [
          ":",
          0.03126921504735947
        ],
        [
          " “",
          0.016473915427923203
        ],
        [
          " ",
          0.014559227041900158
        ],
        [
          " Stadt",
          0.011577600613236427
        ],
        [
          " as",
          0.008945819921791553
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.3232616944929565,
      "topk": [
        [
          " Berlin",
          0.3199572265148163
        ],
        [
          " as",
          0.27493274211883545
        ],
        [
          " “",
          0.09448830038309097
        ],
        [
          " after",
          0.056017711758613586
        ],
        [
          ",",
          0.053136035799980164
        ],
        [
          " \"",
          0.037849295884370804
        ],
        [
          " ‘",
          0.025339379906654358
        ],
        [
          ":",
          0.019969884306192398
        ],
        [
          " by",
          0.011119982227683067
        ],
        [
          " '",
          0.010515282861888409
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 3.3391171190413007,
      "topk": [
        [
          " Berlin",
          0.4261939227581024
        ],
        [
          " “",
          0.1589432656764984
        ],
        [
          ",",
          0.11648626625537872
        ],
        [
          " ‘",
          0.05037281662225723
        ],
        [
          " \"",
          0.04027431830763817
        ],
        [
          " as",
          0.03721044585108757
        ],
        [
          " the",
          0.021795222535729408
        ],
        [
          ":",
          0.015211976133286953
        ],
        [
          " Germany",
          0.015033232048153877
        ],
        [
          " '",
          0.01112963818013668
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.5386771852221255,
      "topk": [
        [
          " called",
          0.5538651347160339
        ],
        [
          " known",
          0.17155519127845764
        ],
        [
          " referred",
          0.08904139697551727
        ],
        [
          " Berlin",
          0.07769884914159775
        ],
        [
          " named",
          0.014264867641031742
        ],
        [
          " “",
          0.013461688533425331
        ],
        [
          " \"",
          0.010316730476915836
        ],
        [
          " the",
          0.00537631893530488
        ],
        [
          " just",
          0.005046034697443247
        ],
        [
          " ‘",
          0.004236485809087753
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 2.283288452135682,
      "topk": [
        [
          " Berlin",
          0.752410888671875
        ],
        [
          " what",
          0.036327607929706573
        ],
        [
          "?\n",
          0.026112748309969902
        ],
        [
          "...\n",
          0.015025122091174126
        ],
        [
          "\n",
          0.012723182328045368
        ],
        [
          " \"",
          0.0119707016274333
        ],
        [
          "...",
          0.008585862815380096
        ],
        [
          " by",
          0.00747254304587841
        ],
        [
          "?",
          0.00536637706682086
        ],
        [
          " __",
          0.004927409812808037
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.6052929452073257,
      "topk": [
        [
          " Berlin",
          0.5759590268135071
        ],
        [
          " after",
          0.16986845433712006
        ],
        [
          " as",
          0.0852043479681015
        ],
        [
          " for",
          0.028732851147651672
        ],
        [
          " what",
          0.019237451255321503
        ],
        [
          " “",
          0.013165363110601902
        ],
        [
          " in",
          0.009886492975056171
        ],
        [
          " the",
          0.008589190430939198
        ],
        [
          " \"",
          0.005474115256220102
        ],
        [
          " by",
          0.004681669175624847
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 0.9255558504693363,
      "topk": [
        [
          " Berlin",
          0.9138579368591309
        ],
        [
          " the",
          0.025478219613432884
        ],
        [
          " Bon",
          0.006494991015642881
        ],
        [
          " ",
          0.0063113318756222725
        ],
        [
          " a",
          0.003799277124926448
        ],
        [
          " Ber",
          0.003563186153769493
        ],
        [
          " berlin",
          0.0034468660596758127
        ],
        [
          " Germany",
          0.0025793241802603006
        ],
        [
          " Frankfurt",
          0.0024280264042317867
        ],
        [
          " its",
          0.0013670289190486073
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.3087831602995847,
      "topk": [
        [
          " Berlin",
          0.7065368294715881
        ],
        [
          " the",
          0.0977458581328392
        ],
        [
          " “",
          0.037610284984111786
        ],
        [
          " \"",
          0.02484501339495182
        ],
        [
          " ‘",
          0.015917543321847916
        ],
        [
          " a",
          0.010423828847706318
        ],
        [
          " '",
          0.009432370774447918
        ],
        [
          " Germany",
          0.0060785128735005856
        ],
        [
          " ",
          0.005978416185826063
        ],
        [
          " Bon",
          0.005073240026831627
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 2.105071430179097,
      "topk": [
        [
          " Germany",
          0.7222897410392761
        ],
        [
          " which",
          0.08232142776250839
        ],
        [
          " the",
          0.05978505685925484
        ],
        [
          " what",
          0.03653750941157341
        ],
        [
          " germany",
          0.00822010450065136
        ],
        [
          " united",
          0.004634506069123745
        ],
        [
          " both",
          0.004107417073100805
        ],
        [
          " and",
          0.0036660945042967796
        ],
        [
          ".",
          0.0033863047137856483
        ],
        [
          " a",
          0.003253125585615635
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 1.6061550914882656,
      "topk": [
        [
          " Berlin",
          0.8266947269439697
        ],
        [
          " \"",
          0.06106436997652054
        ],
        [
          " '",
          0.014361615292727947
        ],
        [
          ":",
          0.006859058514237404
        ],
        [
          " Bon",
          0.005661020055413246
        ],
        [
          " BER",
          0.004188633523881435
        ],
        [
          " what",
          0.003629010869190097
        ],
        [
          ".",
          0.0031857818830758333
        ],
        [
          ",",
          0.0031057659070938826
        ],
        [
          " berlin",
          0.002860658336430788
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.362017296934287,
      "topk": [
        [
          " Berlin",
          0.42503681778907776
        ],
        [
          " \"",
          0.13348738849163055
        ],
        [
          " as",
          0.12692758440971375
        ],
        [
          " “",
          0.07215210795402527
        ],
        [
          " '",
          0.03808753937482834
        ],
        [
          ",",
          0.0247726421803236
        ],
        [
          ":",
          0.024615751579403877
        ],
        [
          " ‘",
          0.020541904494166374
        ],
        [
          " after",
          0.01639052852988243
        ],
        [
          " Germany",
          0.011518503539264202
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 0.855404385156373,
      "topk": [
        [
          " Berlin",
          0.9248446226119995
        ],
        [
          " the",
          0.014779354445636272
        ],
        [
          " Bon",
          0.009144970215857029
        ],
        [
          " berlin",
          0.00439890380948782
        ],
        [
          " Ber",
          0.0027575402054935694
        ],
        [
          " Germany",
          0.002545397263020277
        ],
        [
          " Frankfurt",
          0.0020715692080557346
        ],
        [
          " ",
          0.0020446269772946835
        ],
        [
          " ",
          0.001736614853143692
        ],
        [
          " both",
          0.0016789812361821532
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.187523702116716,
      "topk": [
        [
          " the",
          0.3844706416130066
        ],
        [
          " \"",
          0.14995244145393372
        ],
        [
          " Haupt",
          0.06666586548089981
        ],
        [
          " a",
          0.04538246616721153
        ],
        [
          " Berlin",
          0.04297963157296181
        ],
        [
          " Stadt",
          0.037648580968379974
        ],
        [
          " '",
          0.033991873264312744
        ],
        [
          " “",
          0.028079679235816002
        ],
        [
          " H",
          0.009894774295389652
        ],
        [
          " ‘",
          0.009549320675432682
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.000569384633331985,
      "topk": [
        [
          " Berlin",
          0.9999649524688721
        ],
        [
          " \"",
          3.505489439703524e-05
        ],
        [
          " “",
          3.406986359699715e-10
        ],
        [
          " '",
          1.1301798906460103e-11
        ],
        [
          ":",
          4.335757555935793e-13
        ],
        [
          " Germany",
          3.727259217142353e-15
        ],
        [
          ",",
          5.4365697988774e-16
        ],
        [
          " ‘",
          3.3657680016273197e-16
        ],
        [
          " Deutschland",
          9.169881286457927e-19
        ],
        [
          " as",
          8.991559757955277e-19
        ],
        [
          " Bon",
          2.3041201265665255e-19
        ],
        [
          " BER",
          1.5920578844333333e-20
        ],
        [
          " „",
          1.3321437611404638e-20
        ],
        [
          " berlin",
          2.1234206961408553e-22
        ],
        [
          " the",
          6.529449675257352e-23
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 13.873218555837253,
      "topk": [
        [
          " Berlin",
          0.03655650466680527
        ],
        [
          " \"",
          0.02188783697783947
        ],
        [
          " “",
          0.012290908955037594
        ],
        [
          " '",
          0.010366273112595081
        ],
        [
          ":",
          0.008806807920336723
        ],
        [
          " Germany",
          0.00694280443713069
        ],
        [
          ",",
          0.006305678281933069
        ],
        [
          " ‘",
          0.006156297866255045
        ],
        [
          " Deutschland",
          0.004582301247864962
        ],
        [
          " as",
          0.004577802959829569
        ],
        [
          " Bon",
          0.0042765201069414616
        ],
        [
          " BER",
          0.003741651074960828
        ],
        [
          " „",
          0.0037084531504660845
        ],
        [
          " berlin",
          0.003015208523720503
        ],
        [
          " the",
          0.002842557616531849
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "meta-llama/Meta-Llama-3-8B",
    "device": "cpu",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float32",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 25,
    "delta_layers": null
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.961001910264459,
    "topk": [
      [
        " Berlin",
        0.5201817154884338
      ],
      [
        " \"",
        0.18647965788841248
      ],
      [
        " “",
        0.05880223214626312
      ],
      [
        " '",
        0.04182837903499603
      ],
      [
        ":",
        0.03018997609615326
      ],
      [
        " Germany",
        0.01876271329820156
      ],
      [
        ",",
        0.015477091073989868
      ],
      [
        " ‘",
        0.014752479270100594
      ],
      [
        " Deutschland",
        0.008173217065632343
      ],
      [
        " as",
        0.008157175965607166
      ],
      [
        " Bon",
        0.007118799723684788
      ],
      [
        " BER",
        0.0054494459182024
      ],
      [
        " „",
        0.005353174638003111
      ],
      [
        " berlin",
        0.0035388360265642405
      ],
      [
        " the",
        0.003145171795040369
      ],
      [
        " by",
        0.002775720786303282
      ],
      [
        " Stadt",
        0.0026793135330080986
      ],
      [
        " ''",
        0.0022729109041392803
      ],
      [
        " that",
        0.002261410467326641
      ],
      [
        " `",
        0.002243433380499482
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 128256,
    "n_ctx": 8192,
    "architecture": "pre_norm"
  }
}