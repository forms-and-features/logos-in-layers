{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9353063208686778,
      "topk": [
        [
          " Germany",
          0.8828125
        ],
        [
          " the",
          0.06396484375
        ],
        [
          " modern",
          0.00762939453125
        ],
        [
          " a",
          0.0052490234375
        ],
        [
          " ",
          0.0031890869140625
        ],
        [
          " Europe",
          0.0028076171875
        ],
        [
          " German",
          0.0024871826171875
        ],
        [
          " both",
          0.0021820068359375
        ],
        [
          " Berlin",
          0.00170135498046875
        ],
        [
          " culture",
          0.00150299072265625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.4232443217721675,
      "topk": [
        [
          " Berlin",
          0.5625
        ],
        [
          " \"",
          0.1826171875
        ],
        [
          ",",
          0.059326171875
        ],
        [
          " '",
          0.05224609375
        ],
        [
          " ",
          0.03173828125
        ],
        [
          " “",
          0.01495361328125
        ],
        [
          ":",
          0.01495361328125
        ],
        [
          " by",
          0.01495361328125
        ],
        [
          " and",
          0.01031494140625
        ],
        [
          " the",
          0.006256103515625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.297398255525604,
      "topk": [
        [
          " Berlin",
          0.4296875
        ],
        [
          " as",
          0.09619140625
        ],
        [
          " “",
          0.0849609375
        ],
        [
          " after",
          0.07470703125
        ],
        [
          ",",
          0.06591796875
        ],
        [
          " \"",
          0.0311279296875
        ],
        [
          " ‘",
          0.0311279296875
        ],
        [
          ":",
          0.0274658203125
        ],
        [
          " ",
          0.0242919921875
        ],
        [
          " for",
          0.0189208984375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.670200917469458,
      "topk": [
        [
          " Berlin",
          0.5703125
        ],
        [
          " “",
          0.0986328125
        ],
        [
          " \"",
          0.0771484375
        ],
        [
          ",",
          0.059814453125
        ],
        [
          " ",
          0.031982421875
        ],
        [
          " as",
          0.0283203125
        ],
        [
          " ‘",
          0.0283203125
        ],
        [
          " '",
          0.0194091796875
        ],
        [
          " Germany",
          0.01043701171875
        ],
        [
          ":",
          0.01043701171875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.8727804857993164,
      "topk": [
        [
          " called",
          0.390625
        ],
        [
          " known",
          0.2373046875
        ],
        [
          " Berlin",
          0.126953125
        ],
        [
          " referred",
          0.09912109375
        ],
        [
          " named",
          0.0220947265625
        ],
        [
          " “",
          0.01953125
        ],
        [
          " the",
          0.0172119140625
        ],
        [
          " ",
          0.01043701171875
        ],
        [
          " \"",
          0.00921630859375
        ],
        [
          " ‘",
          0.006317138671875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 2.658202031884062,
      "topk": [
        [
          " Berlin",
          0.66796875
        ],
        [
          " ",
          0.042724609375
        ],
        [
          " the",
          0.042724609375
        ],
        [
          " \"",
          0.033203125
        ],
        [
          "...",
          0.0201416015625
        ],
        [
          ":",
          0.017822265625
        ],
        [
          "\n\n",
          0.0157470703125
        ],
        [
          " a",
          0.01226806640625
        ],
        [
          " by",
          0.01080322265625
        ],
        [
          " ...",
          0.0084228515625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.4929065824347516,
      "topk": [
        [
          " Berlin",
          0.455078125
        ],
        [
          " after",
          0.3125
        ],
        [
          " as",
          0.0615234375
        ],
        [
          " for",
          0.037353515625
        ],
        [
          " “",
          0.0177001953125
        ],
        [
          " ",
          0.0177001953125
        ],
        [
          " in",
          0.01373291015625
        ],
        [
          " the",
          0.01373291015625
        ],
        [
          " by",
          0.007354736328125
        ],
        [
          " \"",
          0.0057373046875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.5451499215221627,
      "topk": [
        [
          " Berlin",
          0.8125
        ],
        [
          " the",
          0.05908203125
        ],
        [
          " Bonn",
          0.0245361328125
        ],
        [
          " ",
          0.016845703125
        ],
        [
          " Frankfurt",
          0.009033203125
        ],
        [
          " a",
          0.0062255859375
        ],
        [
          " berlin",
          0.0054931640625
        ],
        [
          "\n\n",
          0.004852294921875
        ],
        [
          ":",
          0.0042724609375
        ],
        [
          " Munich",
          0.0037689208984375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.997639718343065,
      "topk": [
        [
          " Berlin",
          0.419921875
        ],
        [
          " the",
          0.25390625
        ],
        [
          " “",
          0.064453125
        ],
        [
          " ",
          0.050048828125
        ],
        [
          " \"",
          0.0390625
        ],
        [
          " a",
          0.034423828125
        ],
        [
          " ‘",
          0.023681640625
        ],
        [
          " Hauptstadt",
          0.0162353515625
        ],
        [
          " '",
          0.0126953125
        ],
        [
          " Bundes",
          0.005279541015625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 2.192249779866756,
      "topk": [
        [
          " Germany",
          0.71875
        ],
        [
          " which",
          0.07568359375
        ],
        [
          " the",
          0.0458984375
        ],
        [
          " what",
          0.016845703125
        ],
        [
          " ",
          0.014892578125
        ],
        [
          " germany",
          0.01312255859375
        ],
        [
          " .",
          0.006195068359375
        ],
        [
          " this",
          0.006195068359375
        ],
        [
          " ________",
          0.0054931640625
        ],
        [
          "...",
          0.00482177734375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 2.4102412294883835,
      "topk": [
        [
          " Berlin",
          0.6640625
        ],
        [
          " \"",
          0.11572265625
        ],
        [
          " ",
          0.033203125
        ],
        [
          ":",
          0.022705078125
        ],
        [
          " '",
          0.02001953125
        ],
        [
          " BERLIN",
          0.0107421875
        ],
        [
          " berlin",
          0.00836181640625
        ],
        [
          ",",
          0.00836181640625
        ],
        [
          " simply",
          0.00836181640625
        ],
        [
          "...",
          0.00836181640625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.475917966947708,
      "topk": [
        [
          " Berlin",
          0.361328125
        ],
        [
          " \"",
          0.193359375
        ],
        [
          " as",
          0.08056640625
        ],
        [
          " “",
          0.06298828125
        ],
        [
          ",",
          0.055419921875
        ],
        [
          ":",
          0.043212890625
        ],
        [
          " ",
          0.0296630859375
        ],
        [
          " '",
          0.0296630859375
        ],
        [
          ".",
          0.0179443359375
        ],
        [
          " in",
          0.0096435546875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 1.4785690740150876,
      "topk": [
        [
          " Berlin",
          0.8359375
        ],
        [
          " the",
          0.04150390625
        ],
        [
          " Bonn",
          0.0152587890625
        ],
        [
          " berlin",
          0.0152587890625
        ],
        [
          " ",
          0.01348876953125
        ],
        [
          " a",
          0.00927734375
        ],
        [
          ":",
          0.005615234375
        ],
        [
          " \"",
          0.004364013671875
        ],
        [
          " Frankfurt",
          0.0034027099609375
        ],
        [
          " (",
          0.002655029296875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 3.267896007631296,
      "topk": [
        [
          " Berlin",
          0.462890625
        ],
        [
          " \"",
          0.1708984375
        ],
        [
          " the",
          0.055419921875
        ],
        [
          " ",
          0.055419921875
        ],
        [
          " “",
          0.048828125
        ],
        [
          " '",
          0.0296630859375
        ],
        [
          " Hauptstadt",
          0.0179443359375
        ],
        [
          " simply",
          0.01092529296875
        ],
        [
          " Bonn",
          0.01092529296875
        ],
        [
          " ‘",
          0.00848388671875
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.1299969132686356,
      "topk": [
        [
          " Berlin",
          0.982012927532196
        ],
        [
          " \"",
          0.017986195161938667
        ],
        [
          " “",
          8.165719691533013e-07
        ],
        [
          " '",
          2.7392937917980476e-10
        ],
        [
          ",",
          1.0077298717714456e-10
        ],
        [
          ":",
          3.707231049920878e-11
        ],
        [
          " ",
          5.017191523348785e-12
        ],
        [
          " ‘",
          1.683080300699186e-15
        ],
        [
          " as",
          2.277801561784658e-16
        ],
        [
          " by",
          1.1340505577397875e-17
        ],
        [
          " BERLIN",
          2.0770860610375981e-19
        ],
        [
          " berlin",
          1.0341202799604113e-20
        ],
        [
          " and",
          3.80431592043718e-21
        ],
        [
          " the",
          3.80431592043718e-21
        ],
        [
          " „",
          5.148581855934863e-22
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 9.039841525629397,
      "topk": [
        [
          " Berlin",
          0.08689886331558228
        ],
        [
          " \"",
          0.07204169034957886
        ],
        [
          " “",
          0.043695494532585144
        ],
        [
          " '",
          0.030031444504857063
        ],
        [
          ",",
          0.0282119307667017
        ],
        [
          ":",
          0.02650265395641327
        ],
        [
          " ",
          0.02489694207906723
        ],
        [
          " ‘",
          0.01607467420399189
        ],
        [
          " as",
          0.015100756660103798
        ],
        [
          " by",
          0.012518969364464283
        ],
        [
          " BERLIN",
          0.010378589853644371
        ],
        [
          " berlin",
          0.009159072302281857
        ],
        [
          " and",
          0.00860415305942297
        ],
        [
          " the",
          0.00860415305942297
        ],
        [
          " „",
          0.007593137677758932
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "google/gemma-2-9b",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.bfloat16",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": 0,
    "L_copy_H": 0,
    "L_semantic": 42,
    "delta_layers": 42
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.9817323550341603,
    "topk": [
      [
        " Berlin",
        0.384765625
      ],
      [
        " \"",
        0.263671875
      ],
      [
        " “",
        0.09716796875
      ],
      [
        " '",
        0.0458984375
      ],
      [
        ",",
        0.04052734375
      ],
      [
        ":",
        0.03564453125
      ],
      [
        " ",
        0.031494140625
      ],
      [
        " ‘",
        0.01312255859375
      ],
      [
        " as",
        0.0115966796875
      ],
      [
        " by",
        0.00799560546875
      ],
      [
        " BERLIN",
        0.005462646484375
      ],
      [
        " berlin",
        0.0042724609375
      ],
      [
        " and",
        0.0037689208984375
      ],
      [
        " the",
        0.0037689208984375
      ],
      [
        " „",
        0.0029296875
      ],
      [
        ".",
        0.002593994140625
      ],
      [
        " Germany",
        0.002288818359375
      ],
      [
        " -",
        0.002288818359375
      ],
      [
        "\n\n",
        0.002288818359375
      ],
      [
        " (",
        0.002288818359375
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 42,
    "d_model": 3584,
    "n_heads": 16,
    "d_vocab": 256000,
    "n_ctx": 8192
  }
}