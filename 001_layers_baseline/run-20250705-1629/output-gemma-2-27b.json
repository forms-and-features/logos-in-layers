{
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 1.1996004875994482,
      "topk": [
        [
          " Germany",
          0.859375
        ],
        [
          " the",
          0.0703125
        ],
        [
          " and",
          0.007415771484375
        ],
        [
          " a",
          0.006561279296875
        ],
        [
          " Europe",
          0.00579833984375
        ],
        [
          " both",
          0.00396728515625
        ],
        [
          " one",
          0.003509521484375
        ],
        [
          " ",
          0.003509521484375
        ],
        [
          " modern",
          0.0030975341796875
        ],
        [
          " Federal",
          0.0021209716796875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.765924741113189,
      "topk": [
        [
          " Berlin",
          0.5390625
        ],
        [
          " \"",
          0.1552734375
        ],
        [
          ",",
          0.064453125
        ],
        [
          " ",
          0.05029296875
        ],
        [
          " '",
          0.04443359375
        ],
        [
          ":",
          0.02099609375
        ],
        [
          " “",
          0.02099609375
        ],
        [
          " the",
          0.0098876953125
        ],
        [
          " enough",
          0.0098876953125
        ],
        [
          " -",
          0.007720947265625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.420889022116437,
      "topk": [
        [
          " Berlin",
          0.41015625
        ],
        [
          " as",
          0.09130859375
        ],
        [
          " “",
          0.08056640625
        ],
        [
          ",",
          0.08056640625
        ],
        [
          " after",
          0.06298828125
        ],
        [
          " enough",
          0.043212890625
        ],
        [
          " ",
          0.043212890625
        ],
        [
          " \"",
          0.03369140625
        ],
        [
          " ‘",
          0.026123046875
        ],
        [
          " and",
          0.0179443359375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.524406580801482,
      "topk": [
        [
          " Berlin",
          0.625
        ],
        [
          ",",
          0.07470703125
        ],
        [
          " “",
          0.07470703125
        ],
        [
          " ",
          0.045166015625
        ],
        [
          " \"",
          0.045166015625
        ],
        [
          " ‘",
          0.024169921875
        ],
        [
          " '",
          0.01141357421875
        ],
        [
          " the",
          0.01141357421875
        ],
        [
          ":",
          0.01007080078125
        ],
        [
          " as",
          0.0089111328125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.820756937791873,
      "topk": [
        [
          " known",
          0.375
        ],
        [
          " called",
          0.33203125
        ],
        [
          " referred",
          0.107421875
        ],
        [
          " Berlin",
          0.0654296875
        ],
        [
          " the",
          0.0113525390625
        ],
        [
          " “",
          0.010009765625
        ],
        [
          " named",
          0.010009765625
        ],
        [
          " ",
          0.00885009765625
        ],
        [
          " \"",
          0.006866455078125
        ],
        [
          " a",
          0.00537109375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 3.1046597064607666,
      "topk": [
        [
          " Berlin",
          0.609375
        ],
        [
          " the",
          0.07275390625
        ],
        [
          " \"",
          0.0439453125
        ],
        [
          " ",
          0.0439453125
        ],
        [
          " a",
          0.0235595703125
        ],
        [
          "\n\n",
          0.018310546875
        ],
        [
          "...",
          0.0111083984375
        ],
        [
          ":",
          0.0111083984375
        ],
        [
          " Bonn",
          0.00982666015625
        ],
        [
          " '",
          0.0086669921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.422977404698029,
      "topk": [
        [
          " after",
          0.412109375
        ],
        [
          " Berlin",
          0.365234375
        ],
        [
          " as",
          0.08154296875
        ],
        [
          " for",
          0.038330078125
        ],
        [
          " the",
          0.0181884765625
        ],
        [
          " ",
          0.0181884765625
        ],
        [
          " one",
          0.006683349609375
        ],
        [
          " in",
          0.006683349609375
        ],
        [
          " “",
          0.006683349609375
        ],
        [
          ",",
          0.003570556640625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.7694440193499592,
      "topk": [
        [
          " Berlin",
          0.78125
        ],
        [
          " the",
          0.056640625
        ],
        [
          " ",
          0.044189453125
        ],
        [
          " Bonn",
          0.0302734375
        ],
        [
          " Munich",
          0.01263427734375
        ],
        [
          " a",
          0.0086669921875
        ],
        [
          " its",
          0.007659912109375
        ],
        [
          "\n\n",
          0.00408935546875
        ],
        [
          " Frankfurt",
          0.0024871826171875
        ],
        [
          "\n",
          0.001708984375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 3.244041326026021,
      "topk": [
        [
          " Berlin",
          0.51171875
        ],
        [
          " the",
          0.1875
        ],
        [
          " ",
          0.047607421875
        ],
        [
          " a",
          0.02880859375
        ],
        [
          " “",
          0.02880859375
        ],
        [
          " Bonn",
          0.025390625
        ],
        [
          " \"",
          0.0174560546875
        ],
        [
          " ‘",
          0.01202392578125
        ],
        [
          "\n\n",
          0.0106201171875
        ],
        [
          ":",
          0.00933837890625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 4.398661987066763,
      "topk": [
        [
          " Germany",
          0.4375
        ],
        [
          " which",
          0.08642578125
        ],
        [
          " this",
          0.046142578125
        ],
        [
          " what",
          0.035888671875
        ],
        [
          " ",
          0.0279541015625
        ],
        [
          " .",
          0.024658203125
        ],
        [
          " the",
          0.019287109375
        ],
        [
          ".",
          0.0169677734375
        ],
        [
          " a",
          0.0169677734375
        ],
        [
          "\n\n",
          0.0150146484375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 2.7621048344548753,
      "topk": [
        [
          " Berlin",
          0.61328125
        ],
        [
          " \"",
          0.1552734375
        ],
        [
          " '",
          0.03466796875
        ],
        [
          " ",
          0.0269775390625
        ],
        [
          ":",
          0.0185546875
        ],
        [
          " BERLIN",
          0.007720947265625
        ],
        [
          " ...",
          0.006011962890625
        ],
        [
          "\n",
          0.006011962890625
        ],
        [
          "...",
          0.00531005859375
        ],
        [
          " just",
          0.00531005859375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.334132717853995,
      "topk": [
        [
          " Berlin",
          0.33203125
        ],
        [
          " \"",
          0.2578125
        ],
        [
          " “",
          0.083984375
        ],
        [
          " '",
          0.0576171875
        ],
        [
          " ",
          0.051025390625
        ],
        [
          ",",
          0.044921875
        ],
        [
          ":",
          0.039794921875
        ],
        [
          " as",
          0.021240234375
        ],
        [
          " ‘",
          0.01287841796875
        ],
        [
          " Munich",
          0.00885009765625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 2.531884214478346,
      "topk": [
        [
          " Berlin",
          0.71875
        ],
        [
          " Bonn",
          0.04052734375
        ],
        [
          " the",
          0.04052734375
        ],
        [
          " Munich",
          0.0279541015625
        ],
        [
          " ",
          0.021728515625
        ],
        [
          " a",
          0.01165771484375
        ],
        [
          " Hamburg",
          0.00799560546875
        ],
        [
          ":",
          0.00799560546875
        ],
        [
          ".",
          0.0062255859375
        ],
        [
          " Frankfurt",
          0.004852294921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.249440552115043,
      "topk": [
        [
          " Berlin",
          0.314453125
        ],
        [
          " the",
          0.216796875
        ],
        [
          " \"",
          0.07958984375
        ],
        [
          " Bonn",
          0.0546875
        ],
        [
          " “",
          0.04833984375
        ],
        [
          " a",
          0.02587890625
        ],
        [
          " ",
          0.02587890625
        ],
        [
          " Bundes",
          0.0228271484375
        ],
        [
          " '",
          0.017822265625
        ],
        [
          " ‘",
          0.017822265625
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.5270678348452625,
      "topk": [
        [
          " Berlin",
          0.8807969689369202
        ],
        [
          " \"",
          0.11920290440320969
        ],
        [
          " “",
          9.91206405842604e-08
        ],
        [
          " ",
          1.8154576730822214e-09
        ],
        [
          " '",
          2.456954917295917e-10
        ],
        [
          ",",
          4.50007002147923e-12
        ],
        [
          ":",
          6.09018261168992e-13
        ],
        [
          " ‘",
          1.5096054120026636e-15
        ],
        [
          " Munich",
          1.8630009910103055e-19
        ],
        [
          " and",
          6.853597856724722e-20
        ],
        [
          "\n",
          6.853597856724722e-20
        ],
        [
          "\n\n",
          2.5212977211737727e-20
        ],
        [
          " that",
          1.2552802039564436e-21
        ],
        [
          " BERLIN",
          4.61791752312984e-22
        ],
        [
          " Germany",
          1.6988370767246712e-22
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.570776054657513,
      "topk": [
        [
          " Berlin",
          0.049635887145996094
        ],
        [
          " \"",
          0.041149597615003586
        ],
        [
          " “",
          0.020691316574811935
        ],
        [
          " ",
          0.017153704538941383
        ],
        [
          " '",
          0.016114413738250732
        ],
        [
          ",",
          0.01254991814494133
        ],
        [
          ":",
          0.01178955752402544
        ],
        [
          " ‘",
          0.008625423535704613
        ],
        [
          " Munich",
          0.005568991880863905
        ],
        [
          " and",
          0.005231583956629038
        ],
        [
          "\n",
          0.005231583956629038
        ],
        [
          "\n\n",
          0.0049146185629069805
        ],
        [
          " that",
          0.00433713523671031
        ],
        [
          " BERLIN",
          0.004074361640959978
        ],
        [
          " Germany",
          0.003827508771792054
        ]
      ]
    }
  ],
  "diagnostics": {
    "type": "diagnostics",
    "model": "google/gemma-2-27b",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.bfloat16",
    "first_block_ln1_type": "RMSNorm",
    "final_ln_type": "RMSNorm",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": 0,
    "L_copy_H": 0,
    "L_semantic": 36,
    "delta_layers": 36
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.8663350919929313,
    "topk": [
      [
        " Berlin",
        0.412109375
      ],
      [
        " \"",
        0.283203125
      ],
      [
        " “",
        0.07177734375
      ],
      [
        " ",
        0.04931640625
      ],
      [
        " '",
        0.04345703125
      ],
      [
        ",",
        0.0263671875
      ],
      [
        ":",
        0.0233154296875
      ],
      [
        " ‘",
        0.012451171875
      ],
      [
        " Munich",
        0.00518798828125
      ],
      [
        " and",
        0.00457763671875
      ],
      [
        "\n",
        0.00457763671875
      ],
      [
        "\n\n",
        0.004058837890625
      ],
      [
        " that",
        0.0031585693359375
      ],
      [
        " BERLIN",
        0.002777099609375
      ],
      [
        " \\\"",
        0.0024566650390625
      ],
      [
        " Germany",
        0.0024566650390625
      ],
      [
        " berlin",
        0.002166748046875
      ],
      [
        " Hamburg",
        0.002166748046875
      ],
      [
        " the",
        0.002166748046875
      ],
      [
        ".",
        0.00191497802734375
      ]
    ]
  },
  "model_stats": {
    "type": "model_stats",
    "num_layers": 46,
    "d_model": 4608,
    "n_heads": 32,
    "d_vocab": 256000,
    "n_ctx": 8192
  }
}