{
  "diagnostics": {
    "type": "diagnostics",
    "model": "mistralai/Mistral-7B-v0.1",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float16",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": null,
    "L_copy_H": null,
    "L_semantic": 25,
    "delta_layers": null
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 3.613995614054121,
    "topk": [
      [
        "Berlin",
        0.38037109375
      ],
      [
        "\"",
        0.1754150390625
      ],
      [
        "“",
        0.10479736328125
      ],
      [
        "'",
        0.057861328125
      ],
      [
        "Germany",
        0.05145263671875
      ],
      [
        "‘",
        0.040069580078125
      ],
      [
        ",",
        0.0173797607421875
      ],
      [
        ":",
        0.0158233642578125
      ],
      [
        "B",
        0.013214111328125
      ],
      [
        "Deutschland",
        0.01251220703125
      ],
      [
        "Bon",
        0.0122222900390625
      ],
      [
        "as",
        0.009368896484375
      ],
      [
        "the",
        0.006855010986328125
      ],
      [
        "by",
        0.006443023681640625
      ],
      [
        "Frankfurt",
        0.005908966064453125
      ],
      [
        "„",
        0.004222869873046875
      ],
      [
        "German",
        0.004192352294921875
      ],
      [
        "«",
        0.00350189208984375
      ],
      [
        ".",
        0.0031642913818359375
      ],
      [
        "and",
        0.002582550048828125
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9551630937719959,
      "topk": [
        [
          "Germany",
          0.89599609375
        ],
        [
          "the",
          0.054229736328125
        ],
        [
          "both",
          0.00441741943359375
        ],
        [
          "a",
          0.00383758544921875
        ],
        [
          "Europe",
          0.003131866455078125
        ],
        [
          "Berlin",
          0.0028514862060546875
        ],
        [
          "German",
          0.0024585723876953125
        ],
        [
          "modern",
          0.00162506103515625
        ],
        [
          "and",
          0.0014905929565429688
        ],
        [
          "one",
          0.0011167526245117188
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.396880413290804,
      "topk": [
        [
          "Berlin",
          0.54052734375
        ],
        [
          "\"",
          0.2435302734375
        ],
        [
          "'",
          0.057403564453125
        ],
        [
          ",",
          0.046478271484375
        ],
        [
          "by",
          0.018341064453125
        ],
        [
          "“",
          0.01532745361328125
        ],
        [
          "the",
          0.01087188720703125
        ],
        [
          ":",
          0.006855010986328125
        ],
        [
          "and",
          0.006439208984375
        ],
        [
          "‘",
          0.0033931732177734375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.758778176787071,
      "topk": [
        [
          "Berlin",
          0.345947265625
        ],
        [
          "“",
          0.11590576171875
        ],
        [
          ",",
          0.09759521484375
        ],
        [
          "after",
          0.08154296875
        ],
        [
          "as",
          0.0543212890625
        ],
        [
          "‘",
          0.048309326171875
        ],
        [
          "because",
          0.032958984375
        ],
        [
          "\"",
          0.027740478515625
        ],
        [
          "and",
          0.02392578125
        ],
        [
          "for",
          0.0237274169921875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.2521362026889964,
      "topk": [
        [
          "Berlin",
          0.6337890625
        ],
        [
          "“",
          0.12481689453125
        ],
        [
          "‘",
          0.0589599609375
        ],
        [
          ",",
          0.0438232421875
        ],
        [
          "\"",
          0.0438232421875
        ],
        [
          "'",
          0.015380859375
        ],
        [
          "as",
          0.015380859375
        ],
        [
          "the",
          0.006565093994140625
        ],
        [
          ":",
          0.005031585693359375
        ],
        [
          "–",
          0.004955291748046875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 3.050346897387688,
      "topk": [
        [
          "called",
          0.419677734375
        ],
        [
          "known",
          0.1982421875
        ],
        [
          "Berlin",
          0.1544189453125
        ],
        [
          "referred",
          0.07525634765625
        ],
        [
          "“",
          0.0225982666015625
        ],
        [
          "named",
          0.015777587890625
        ],
        [
          "‘",
          0.01181793212890625
        ],
        [
          "not",
          0.0097198486328125
        ],
        [
          "the",
          0.00824737548828125
        ],
        [
          "\"",
          0.007450103759765625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 1.778837711740086,
      "topk": [
        [
          "Berlin",
          0.81103515625
        ],
        [
          "\"",
          0.040374755859375
        ],
        [
          "the",
          0.0254669189453125
        ],
        [
          "by",
          0.00981903076171875
        ],
        [
          "home",
          0.00914764404296875
        ],
        [
          "'",
          0.0088653564453125
        ],
        [
          "a",
          0.00839996337890625
        ],
        [
          "many",
          0.005817413330078125
        ],
        [
          ",",
          0.0034465789794921875
        ],
        [
          "to",
          0.0033397674560546875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.32267144728736,
      "topk": [
        [
          "Berlin",
          0.525390625
        ],
        [
          "after",
          0.28125
        ],
        [
          "as",
          0.0477294921875
        ],
        [
          "for",
          0.0374755859375
        ],
        [
          "in",
          0.0182647705078125
        ],
        [
          "“",
          0.01274871826171875
        ],
        [
          "Bon",
          0.0121612548828125
        ],
        [
          "the",
          0.010009765625
        ],
        [
          "‘",
          0.00616455078125
        ],
        [
          ",",
          0.005069732666015625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.187235106985063,
      "topk": [
        [
          "Berlin",
          0.8779296875
        ],
        [
          "the",
          0.05108642578125
        ],
        [
          "Bon",
          0.01364898681640625
        ],
        [
          "a",
          0.004001617431640625
        ],
        [
          "its",
          0.0029735565185546875
        ],
        [
          "Ber",
          0.0022983551025390625
        ],
        [
          "Frankfurt",
          0.0019664764404296875
        ],
        [
          "",
          0.0015430450439453125
        ],
        [
          "least",
          0.00142669677734375
        ],
        [
          "last",
          0.0013723373413085938
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.69322371899251,
      "topk": [
        [
          "Berlin",
          0.57470703125
        ],
        [
          "the",
          0.1739501953125
        ],
        [
          "“",
          0.07086181640625
        ],
        [
          "‘",
          0.03790283203125
        ],
        [
          "\"",
          0.01861572265625
        ],
        [
          "a",
          0.0172271728515625
        ],
        [
          "'",
          0.008331298828125
        ],
        [
          "Die",
          0.006336212158203125
        ],
        [
          "The",
          0.0058135986328125
        ],
        [
          "Deutschland",
          0.004528045654296875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 1.1133258207507473,
      "topk": [
        [
          "Germany",
          0.88232421875
        ],
        [
          "the",
          0.0546875
        ],
        [
          "germ",
          0.0038394927978515625
        ],
        [
          "Europe",
          0.003414154052734375
        ],
        [
          "and",
          0.0033359527587890625
        ],
        [
          "both",
          0.00299072265625
        ],
        [
          "Berlin",
          0.0027866363525390625
        ],
        [
          "German",
          0.0026187896728515625
        ],
        [
          "a",
          0.0024204254150390625
        ],
        [
          ".",
          0.00194549560546875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 1.7496505360621586,
      "topk": [
        [
          "Berlin",
          0.802734375
        ],
        [
          "\"",
          0.0628662109375
        ],
        [
          "'",
          0.0306549072265625
        ],
        [
          "the",
          0.0076904296875
        ],
        [
          "by",
          0.007511138916015625
        ],
        [
          "simply",
          0.004848480224609375
        ],
        [
          ",",
          0.004520416259765625
        ],
        [
          "Ber",
          0.004245758056640625
        ],
        [
          ":",
          0.003925323486328125
        ],
        [
          "both",
          0.0038967132568359375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.638352484999915,
      "topk": [
        [
          "Berlin",
          0.36376953125
        ],
        [
          "\"",
          0.1575927734375
        ],
        [
          "“",
          0.0933837890625
        ],
        [
          "as",
          0.07562255859375
        ],
        [
          "'",
          0.057098388671875
        ],
        [
          "‘",
          0.041778564453125
        ],
        [
          ",",
          0.03253173828125
        ],
        [
          "B",
          0.021331787109375
        ],
        [
          "Germany",
          0.01898193359375
        ],
        [
          ":",
          0.0186767578125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 0.9952617087339141,
      "topk": [
        [
          "Berlin",
          0.9111328125
        ],
        [
          "Bon",
          0.018768310546875
        ],
        [
          "the",
          0.01201629638671875
        ],
        [
          "Ber",
          0.004528045654296875
        ],
        [
          "ber",
          0.003444671630859375
        ],
        [
          "Germany",
          0.0025386810302734375
        ],
        [
          "B",
          0.0025005340576171875
        ],
        [
          ".",
          0.00247955322265625
        ],
        [
          ",",
          0.0022754669189453125
        ],
        [
          ".",
          0.001552581787109375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 4.1899262997492706,
      "topk": [
        [
          "Berlin",
          0.3935546875
        ],
        [
          "the",
          0.1318359375
        ],
        [
          "\"",
          0.12005615234375
        ],
        [
          "“",
          0.04278564453125
        ],
        [
          "'",
          0.038665771484375
        ],
        [
          "a",
          0.0269927978515625
        ],
        [
          "‘",
          0.01479339599609375
        ],
        [
          ":",
          0.01479339599609375
        ],
        [
          "Haupt",
          0.01346588134765625
        ],
        [
          "Stadt",
          0.00720977783203125
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.005486809872885894,
      "topk": [
        [
          "Berlin",
          0.9995668530464172
        ],
        [
          "\"",
          0.0004305559559725225
        ],
        [
          "“",
          2.560179382271599e-06
        ],
        [
          "'",
          6.3460503518797395e-09
        ],
        [
          "Germany",
          2.0602606287667413e-09
        ],
        [
          "‘",
          1.6911651246065418e-10
        ],
        [
          ",",
          3.8991477825352575e-14
        ],
        [
          ":",
          1.6254065896502932e-14
        ],
        [
          "B",
          2.492641780916377e-15
        ],
        [
          "Deutschland",
          1.511863707719162e-15
        ],
        [
          "Bon",
          1.1774405947039424e-15
        ],
        [
          "as",
          8.529352448843357e-17
        ],
        [
          "the",
          3.747535974907204e-18
        ],
        [
          "by",
          2.005911331079867e-18
        ],
        [
          "Frankfurt",
          8.361881958334239e-19
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 12.219460902364624,
      "topk": [
        [
          "Berlin",
          0.03587499260902405
        ],
        [
          "\"",
          0.024369241669774055
        ],
        [
          "“",
          0.01883109100162983
        ],
        [
          "'",
          0.013994078151881695
        ],
        [
          "Germany",
          0.013197674416005611
        ],
        [
          "‘",
          0.011646904982626438
        ],
        [
          ",",
          0.00766812264919281
        ],
        [
          ":",
          0.007316973060369492
        ],
        [
          "B",
          0.0066882548853755
        ],
        [
          "Deutschland",
          0.006507851183414459
        ],
        [
          "Bon",
          0.006432032212615013
        ],
        [
          "as",
          0.005632075481116772
        ],
        [
          "the",
          0.004817369394004345
        ],
        [
          "by",
          0.004669154528528452
        ],
        [
          "Frankfurt",
          0.004472775850445032
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 32,
    "d_model": 4096,
    "n_heads": 32,
    "d_vocab": 32000,
    "n_ctx": 2048
  }
}