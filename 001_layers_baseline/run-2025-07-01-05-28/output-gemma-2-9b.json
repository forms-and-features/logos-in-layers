{
  "diagnostics": {
    "type": "diagnostics",
    "model": "google/gemma-2-9b",
    "device": "cuda",
    "use_norm_lens": true,
    "use_fp32_unembed": false,
    "unembed_dtype": "torch.float16",
    "first_block_ln1_type": "RMSNormPre",
    "final_ln_type": "RMSNormPre",
    "layernorm_bias_fix": "not_needed_rms_model",
    "norm_alignment_fix": "using_ln2_rmsnorm_for_post_block",
    "layer0_norm_fix": "using_real_ln1_on_embeddings",
    "mixed_precision_fix": "casting_to_fp32_before_unembed",
    "layer0_position_info": "token_only_rotary_model",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "target_prediction": "first unseen token (likely 'Berlin')",
    "L_copy": 0,
    "L_copy_H": 0,
    "L_semantic": 42,
    "delta_layers": 42
  },
  "prompt": {
    "type": "prompt",
    "context_prompt": "Give the city name only, plain text. The capital of Germany is called simply",
    "ground_truth": "Berlin"
  },
  "final_prediction": {
    "type": "final_prediction",
    "entropy": 2.9417522361186865,
    "topk": [
      [
        " Berlin",
        0.392578125
      ],
      [
        " \"",
        0.265625
      ],
      [
        " “",
        0.09326171875
      ],
      [
        " '",
        0.045440673828125
      ],
      [
        ",",
        0.03887939453125
      ],
      [
        ":",
        0.0343017578125
      ],
      [
        " ",
        0.0307464599609375
      ],
      [
        " ‘",
        0.01302337646484375
      ],
      [
        " as",
        0.01131439208984375
      ],
      [
        " by",
        0.00801849365234375
      ],
      [
        " BERLIN",
        0.00518035888671875
      ],
      [
        " berlin",
        0.003971099853515625
      ],
      [
        " and",
        0.003849029541015625
      ],
      [
        " the",
        0.003673553466796875
      ],
      [
        " „",
        0.0027294158935546875
      ],
      [
        ".",
        0.0026874542236328125
      ],
      [
        " -",
        0.002262115478515625
      ],
      [
        " (",
        0.002227783203125
      ],
      [
        "\n\n",
        0.002124786376953125
      ],
      [
        " Germany",
        0.0020599365234375
      ]
    ]
  },
  "test_prompts": [
    {
      "type": "test_prompt",
      "prompt": "Berlin is the capital of",
      "entropy": 0.9552697230155309,
      "topk": [
        [
          " Germany",
          0.8779296875
        ],
        [
          " the",
          0.06878662109375
        ],
        [
          " modern",
          0.007595062255859375
        ],
        [
          " a",
          0.00530242919921875
        ],
        [
          " ",
          0.0034236907958984375
        ],
        [
          " Europe",
          0.0030689239501953125
        ],
        [
          " German",
          0.002838134765625
        ],
        [
          " both",
          0.0024280548095703125
        ],
        [
          " Berlin",
          0.0018329620361328125
        ],
        [
          " germany",
          0.0015192031860351562
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called simply",
      "entropy": 2.4525561848719706,
      "topk": [
        [
          " Berlin",
          0.55029296875
        ],
        [
          " \"",
          0.187255859375
        ],
        [
          ",",
          0.061767578125
        ],
        [
          " '",
          0.052825927734375
        ],
        [
          " ",
          0.03411865234375
        ],
        [
          " “",
          0.01537322998046875
        ],
        [
          " by",
          0.01513671875
        ],
        [
          ":",
          0.01490020751953125
        ],
        [
          " and",
          0.01056671142578125
        ],
        [
          " the",
          0.006717681884765625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named simply",
      "entropy": 3.271060488407172,
      "topk": [
        [
          " Berlin",
          0.436767578125
        ],
        [
          " as",
          0.0989990234375
        ],
        [
          " “",
          0.08599853515625
        ],
        [
          " after",
          0.0701904296875
        ],
        [
          ",",
          0.06591796875
        ],
        [
          " ‘",
          0.0311431884765625
        ],
        [
          " \"",
          0.02880859375
        ],
        [
          ":",
          0.0235137939453125
        ],
        [
          " ",
          0.0231475830078125
        ],
        [
          " for",
          0.0180206298828125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at the city called simply",
      "entropy": 2.6248542519164615,
      "topk": [
        [
          " Berlin",
          0.57421875
        ],
        [
          " “",
          0.1029052734375
        ],
        [
          " \"",
          0.08013916015625
        ],
        [
          ",",
          0.054229736328125
        ],
        [
          " ",
          0.0308990478515625
        ],
        [
          " ‘",
          0.0272674560546875
        ],
        [
          " as",
          0.0268402099609375
        ],
        [
          " '",
          0.0199432373046875
        ],
        [
          " Germany",
          0.00988006591796875
        ],
        [
          ":",
          0.00942230224609375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is simply",
      "entropy": 2.849447255591458,
      "topk": [
        [
          " called",
          0.39599609375
        ],
        [
          " known",
          0.2401123046875
        ],
        [
          " Berlin",
          0.118896484375
        ],
        [
          " referred",
          0.10491943359375
        ],
        [
          " named",
          0.0209808349609375
        ],
        [
          " “",
          0.0179443359375
        ],
        [
          " the",
          0.016082763671875
        ],
        [
          " ",
          0.00975799560546875
        ],
        [
          " \"",
          0.00902557373046875
        ],
        [
          " ‘",
          0.006603240966796875
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany's capital city is called",
      "entropy": 2.66314704904432,
      "topk": [
        [
          " Berlin",
          0.66650390625
        ],
        [
          " the",
          0.04534912109375
        ],
        [
          " ",
          0.0426025390625
        ],
        [
          " \"",
          0.03369140625
        ],
        [
          "...",
          0.0207672119140625
        ],
        [
          ":",
          0.018035888671875
        ],
        [
          "\n\n",
          0.0156707763671875
        ],
        [
          " a",
          0.01239776611328125
        ],
        [
          " by",
          0.0106048583984375
        ],
        [
          " ...",
          0.00763702392578125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "The capital city of Germany is named",
      "entropy": 2.4946169498975825,
      "topk": [
        [
          " Berlin",
          0.43212890625
        ],
        [
          " after",
          0.33642578125
        ],
        [
          " as",
          0.064208984375
        ],
        [
          " for",
          0.03717041015625
        ],
        [
          " ",
          0.0175628662109375
        ],
        [
          " “",
          0.0170135498046875
        ],
        [
          " in",
          0.0130462646484375
        ],
        [
          " the",
          0.0130462646484375
        ],
        [
          " by",
          0.0070953369140625
        ],
        [
          " ‘",
          0.006259918212890625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Germany has its capital at",
      "entropy": 1.6028645474293075,
      "topk": [
        [
          " Berlin",
          0.80517578125
        ],
        [
          " the",
          0.06304931640625
        ],
        [
          " Bonn",
          0.0254669189453125
        ],
        [
          " ",
          0.0177764892578125
        ],
        [
          " Frankfurt",
          0.00922393798828125
        ],
        [
          " a",
          0.007648468017578125
        ],
        [
          " berlin",
          0.00525665283203125
        ],
        [
          "\n\n",
          0.005016326904296875
        ],
        [
          ":",
          0.00435638427734375
        ],
        [
          " Munich",
          0.0037860870361328125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "In Germany the capital city is known as",
      "entropy": 2.9987235530088023,
      "topk": [
        [
          " Berlin",
          0.423828125
        ],
        [
          " the",
          0.241455078125
        ],
        [
          " “",
          0.072509765625
        ],
        [
          " ",
          0.055572509765625
        ],
        [
          " \"",
          0.0400390625
        ],
        [
          " a",
          0.033721923828125
        ],
        [
          " ‘",
          0.0242767333984375
        ],
        [
          " Hauptstadt",
          0.01519775390625
        ],
        [
          " '",
          0.01183319091796875
        ],
        [
          " Bundes",
          0.004932403564453125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the country name only, plain text. Berlin is the capital of",
      "entropy": 2.2339462856378405,
      "topk": [
        [
          " Germany",
          0.7119140625
        ],
        [
          " which",
          0.07861328125
        ],
        [
          " the",
          0.0447998046875
        ],
        [
          " what",
          0.0189666748046875
        ],
        [
          " ",
          0.01548004150390625
        ],
        [
          " germany",
          0.01224517822265625
        ],
        [
          " this",
          0.00635528564453125
        ],
        [
          " .",
          0.00560760498046875
        ],
        [
          " ________",
          0.005519866943359375
        ],
        [
          "...",
          0.004947662353515625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany's capital city is called",
      "entropy": 2.404713363124351,
      "topk": [
        [
          " Berlin",
          0.65673828125
        ],
        [
          " \"",
          0.1292724609375
        ],
        [
          " ",
          0.032684326171875
        ],
        [
          ":",
          0.0214385986328125
        ],
        [
          " '",
          0.020782470703125
        ],
        [
          " BERLIN",
          0.00966644287109375
        ],
        [
          ",",
          0.0085296630859375
        ],
        [
          " simply",
          0.00826263427734375
        ],
        [
          "...",
          0.00814056396484375
        ],
        [
          " berlin",
          0.0080108642578125
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. The capital city of Germany is named simply",
      "entropy": 3.5284142952623734,
      "topk": [
        [
          " Berlin",
          0.36474609375
        ],
        [
          " \"",
          0.1749267578125
        ],
        [
          " as",
          0.078857421875
        ],
        [
          " “",
          0.0633544921875
        ],
        [
          ",",
          0.05859375
        ],
        [
          ":",
          0.045623779296875
        ],
        [
          " '",
          0.032867431640625
        ],
        [
          " ",
          0.0303955078125
        ],
        [
          ".",
          0.0190277099609375
        ],
        [
          " by",
          0.01100921630859375
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. Germany has its capital at",
      "entropy": 1.473349916509354,
      "topk": [
        [
          " Berlin",
          0.83544921875
        ],
        [
          " the",
          0.04095458984375
        ],
        [
          " Bonn",
          0.0150604248046875
        ],
        [
          " berlin",
          0.0150604248046875
        ],
        [
          " ",
          0.01415252685546875
        ],
        [
          " a",
          0.00913238525390625
        ],
        [
          ":",
          0.005123138427734375
        ],
        [
          " \"",
          0.00452423095703125
        ],
        [
          " Frankfurt",
          0.00325775146484375
        ],
        [
          " (",
          0.002658843994140625
        ]
      ]
    },
    {
      "type": "test_prompt",
      "prompt": "Give the city name only, plain text. In Germany, the capital city is known as",
      "entropy": 3.2002727732773417,
      "topk": [
        [
          " Berlin",
          0.4736328125
        ],
        [
          " \"",
          0.1636962890625
        ],
        [
          " ",
          0.060211181640625
        ],
        [
          " the",
          0.058349609375
        ],
        [
          " “",
          0.050689697265625
        ],
        [
          " '",
          0.0293426513671875
        ],
        [
          " Hauptstadt",
          0.0172576904296875
        ],
        [
          " simply",
          0.00982666015625
        ],
        [
          " Bonn",
          0.00982666015625
        ],
        [
          " ‘",
          0.008148193359375
        ]
      ]
    }
  ],
  "temperature_exploration": [
    {
      "type": "temperature_exploration",
      "temperature": 0.1,
      "entropy": 0.15785990852624468,
      "topk": [
        [
          " Berlin",
          0.9770220518112183
        ],
        [
          " \"",
          0.022977357730269432
        ],
        [
          " “",
          6.327148298623797e-07
        ],
        [
          " '",
          4.493378724657049e-10
        ],
        [
          ",",
          1.0026082741809716e-10
        ],
        [
          ":",
          2.872520797614353e-11
        ],
        [
          " ",
          9.325709475482835e-12
        ],
        [
          " ‘",
          1.67452643260222e-15
        ],
        [
          " as",
          4.2338655994886504e-16
        ],
        [
          " by",
          1.4487491056798718e-17
        ],
        [
          " BERLIN",
          1.8237060345049154e-19
        ],
        [
          " berlin",
          1.3210882983832365e-20
        ],
        [
          " and",
          9.079697435498193e-21
        ],
        [
          " the",
          5.5071152750948206e-21
        ],
        [
          " „",
          3.1069015383978154e-22
        ]
      ]
    },
    {
      "type": "temperature_exploration",
      "temperature": 2.0,
      "entropy": 9.002261252624063,
      "topk": [
        [
          " Berlin",
          0.08906755596399307
        ],
        [
          " \"",
          0.0732649713754654
        ],
        [
          " “",
          0.04340805858373642
        ],
        [
          " '",
          0.0303037092089653
        ],
        [
          ",",
          0.02802634797990322
        ],
        [
          ":",
          0.02632831782102585
        ],
        [
          " ",
          0.024927150458097458
        ],
        [
          " ‘",
          0.01622040569782257
        ],
        [
          " as",
          0.015119080431759357
        ],
        [
          " by",
          0.012731542810797691
        ],
        [
          " BERLIN",
          0.010230082087218761
        ],
        [
          " berlin",
          0.008957759477198124
        ],
        [
          " and",
          0.008818882517516613
        ],
        [
          " the",
          0.008614592254161835
        ],
        [
          " „",
          0.0074262432754039764
        ]
      ]
    }
  ],
  "model_stats": {
    "type": "model_stats",
    "num_layers": 42,
    "d_model": 3584,
    "n_heads": 16,
    "d_vocab": 256000,
    "n_ctx": 8192
  }
}